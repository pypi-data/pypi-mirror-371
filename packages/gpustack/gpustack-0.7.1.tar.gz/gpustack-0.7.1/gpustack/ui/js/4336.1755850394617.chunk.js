"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4336],{44336:function(e,n,t){t.d(n,{Z:function(){return y}});var r=t(26068),u=t.n(r),a=t(90228),c=t.n(a),i=t(87999),o=t.n(i),l=t(15558),d=t.n(l),s=t(48305),f=t.n(s),v=t(33330),p=t(66182),h=t(61918),g=t(28967),m=t(58258),E=t(32699),w=t.n(E),k=t(28694),P=t(50959);function y(e){var n=e.fetchAPI,t=e.deleteAPI,r=e.contentForDelete,a=e.API,i=e.polling,l=void 0!==i&&i,s=e.watch,E=e.defaultData,y=void 0===E?[]:E,L=e.events,S=void 0===L?["UPDATE","DELETE"]:L,x=(0,P.useRef)(null),D=(0,P.useRef)(null),R=(0,P.useRef)(null),b=(0,p.Z)(),T=(0,h.Z)({defaultSortOrder:"descend"}),I=T.sortOrder,C=T.setSortOrder,A=(0,P.useState)({firstLoad:!0}),O=f()(A,2),Z=O[0],q=O[1],F=(0,P.useState)({dataList:d()(y),loading:!1,loadend:!1,total:0,totalPage:0}),K=f()(F,2),U=K[0],B=K[1],N=(0,P.useState)({page:1,perPage:10,search:""}),W=f()(N,2),_=W[0],Q=W[1],j=(0,v.ZP)().setChunkRequest,z=(0,g.Z)({events:S,dataList:U.dataList,setDataList:function(e,n){B((function(t){return{total:t.total,totalPage:t.totalPage,loading:!1,loadend:!0,dataList:e,deletedIds:(null==n?void 0:n.deletedIds)||[]}}))}}),G=z.updateChunkedList,H=z.cacheDataListRef,J=w().debounce(q,3e3),M=function(e){w().each(e,(function(e){G(e)}))},V=function(){var e=o()(c()().mark((function e(n){var t,r,u;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&s){e.next=2;break}return e.abrupt("return");case 2:null===(t=D.current)||void 0===t||null===(t=t.current)||void 0===t||null===(r=t.cancel)||void 0===r||r.call(t);try{u=w().omit(n||_,["page","perPage"]),D.current=j({url:"".concat(a,"?").concat(k.Z.stringify(w().pickBy(u,(function(e){return!!e})))),handler:M})}catch(e){}case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),X=function(){var e=o()(c()().mark((function e(t){var r,a,i,o,l,d=arguments;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d.length>1&&void 0!==d[1]&&d[1]||B((function(e){return e.loading=!0,u()({},e)})),r=(t||{}).query,e.prev=3,a=u()({},w().pickBy(r||_,(function(e){return!!e}))),e.next=7,n(a);case 7:if(!(!(i=e.sent).items.length&&a.page>i.pagination.totalPage&&i.pagination.totalPage>0)){e.next=15;break}return o=u()(u()({},a),{},{page:i.pagination.totalPage}),e.next=12,n(o);case 12:return l=e.sent,B({dataList:l.items||[],loading:!1,loadend:!0,total:l.pagination.total,totalPage:l.pagination.totalPage}),e.abrupt("return");case 15:B({dataList:i.items||[],loading:!1,loadend:!0,total:i.pagination.total,totalPage:i.pagination.totalPage}),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(3),B({dataList:[],loading:!1,loadend:!0,total:U.total,totalPage:U.totalPage});case 22:return e.prev=22,J({firstLoad:!1}),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[3,18,22,25]])})));return function(n){return e.apply(this,arguments)}}(),Y=function(){var e=o()(c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l&&!s&&n){e.next=2;break}return e.abrupt("return");case 2:x.current&&clearInterval(x.current),x.current=setInterval(o()(c()().mark((function e(){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:X({query:t},!0);case 1:case"end":return e.stop()}}),e)}))),5e3);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),$=function(e){Q(u()(u()({},_),e)),X({query:u()(u()({},_),e)})},ee=w().debounce((function(e){$({page:1,search:e.target.value}),V(u()(u()({},_),{},{search:e.target.value}))}),350);return(0,P.useEffect)((function(){return U.loadend&&Y(_),function(){x.current&&clearInterval(x.current)}}),[U.loadend,_]),(0,P.useEffect)((function(){var e=function(){var e=o()(c()().mark((function e(){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X();case 2:setTimeout((function(){V()}),200);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e(),function(){var e,n;null===(e=D.current)||void 0===e||null===(n=e.cancel)||void 0===n||n.call(e),H.current=[]}}),[]),{dataSource:U,rowSelection:b,sortOrder:I,queryParams:_,modalRef:R,extraStatus:Z,setQueryParams:Q,handleDelete:function(e,n){var a;null===(a=R.current)||void 0===a||a.show(u()(u()({content:r,operation:"common.delete.single.confirm",name:e.name},n),{},{onOk:function(){return o()(c()().mark((function n(){var r;return c()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=3,null==t?void 0:t(e.id,u()({},null===(r=R.current)||void 0===r?void 0:r.configuration));case 3:X();case 4:case"end":return n.stop()}}),n)})))()}}))},handleDeleteBatch:function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null===(e=R.current)||void 0===e||e.show(u()(u()({content:r,operation:"common.delete.confirm",selection:!0},n),{},{onOk:function(){return o()(c()().mark((function e(){var n,r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n=[],e.next=5,(0,m.D6)(b.selectedRowKeys,function(){var e=o()(c()().mark((function e(r){var a;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(r,u()({},null===(a=R.current)||void 0===a?void 0:a.configuration));case 2:n.push(r);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 5:return r=e.sent,b.removeSelectedKeys(n),X(),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))()}}))},fetchData:X,handlePageChange:function(e,n){$({page:e,perPage:n||10})},handleTableChange:function(e,n,t){C(t.order)},handleSearch:function(){X()},handleQueryChange:$,handleNameChange:ee}}},66182:function(e,n,t){t.d(n,{Z:function(){return c}});var r=t(48305),u=t.n(r),a=t(50959);function c(){var e=(0,a.useState)([]),n=u()(e,2),t=n[0],r=n[1],c=(0,a.useState)([]),i=u()(c,2),o=i[0],l=i[1],d={selectedRowKeys:t,selectedRows:o,enableSelection:!0,clearSelections:function(){r([]),l([])},onChange:function(e,n){r(e),l(n)},removeSelectedKeys:function(e){var n=t.filter((function(n){return!e.includes(n)}));return r(n),l((function(n){return n.filter((function(n){return!e.includes(n.id)}))})),n},removeSelectedKey:function(e){if(Array.isArray(e)){var n=t.filter((function(n){return!e.includes(n)}));return r(n),l((function(n){return n.filter((function(n){return!e.includes(n.id)}))})),n}var u=t.filter((function(n){return n!==e}));return r(u),l((function(n){return n.filter((function(n){return n.id!==e}))})),u}};return d}},61918:function(e,n,t){t.d(n,{Z:function(){return c}});var r=t(48305),u=t.n(r),a=t(50959);function c(e){var n=e.defaultSortOrder,t=void 0===n?"descend":n,r=(0,a.useState)(t),c=u()(r,2),i=c[0],o=c[1];return{sortOrder:i,setSortOrder:function(e){e?o(e):"descend"===t?o("ascend"):"ascend"===t&&o("descend")}}}},28967:function(e,n,t){var r=t(26068),u=t.n(r),a=t(15558),c=t.n(a),i=t(20369),o=t(50959);n.Z=function(e){var n=e.events,t=void 0===n?["CREATE","DELETE","UPDATE","INSERT"]:n,r=(0,o.useRef)(new Set),a=(0,o.useRef)(e.dataList||[]),l=(0,o.useRef)(null),d=e.limit||10;return(0,o.useEffect)((function(){a.current=c()(e.dataList||[])}),[e.dataList]),{updateChunkedList:function(n){var o,s,f,v=(null==n?void 0:n.collection)||[];null!=e&&e.computedID&&(v=null===(o=v)||void 0===o?void 0:o.map((function(n){var t;return n.id=null==e||null===(t=e.computedID)||void 0===t?void 0:t.call(e,n),n})));null!=e&&e.filterFun&&(v=null==n||null===(s=n.collection)||void 0===s?void 0:s.filter(null==e?void 0:e.filterFun));null!=e&&e.mapFun&&(v=null==n||null===(f=n.collection)||void 0===f?void 0:f.map(null==e?void 0:e.mapFun));var p,h,g,m=(null==n?void 0:n.ids)||[];if((null==n?void 0:n.type)===i._W.CREATE&&t.includes("CREATE")){var E=v.reduce((function(e,n){var t,r=null===(t=a.current)||void 0===t?void 0:t.findIndex((function(e){return e.id===n.id})),c=u()({},n);return-1===r?e.push(c):a.current[r]=c,e}),[]);a.current=[].concat(c()(E),c()(a.current)).slice(0,d)}(null==n?void 0:n.type)===i._W.DELETE&&t.includes("DELETE")&&(a.current=null===(p=a.current)||void 0===p?void 0:p.filter((function(e){return!(null!=m&&m.includes(e.id))})),function(e){r.current=new Set([].concat(c()(r.current),c()(e)))}(m),null===(h=e.setDataList)||void 0===h||h.call(e,c()(a.current),{deletedIds:c()(r.current)}));(null==n?void 0:n.type)===i._W.UPDATE&&t.includes("UPDATE")&&(null===(g=v)||void 0===g||g.forEach((function(e){var n,r=null===(n=a.current)||void 0===n?void 0:n.findIndex((function(n){return n.id===e.id})),i=u()({},e);r>-1?a.current[r]=i:-1===r&&t.includes("INSERT")&&(a.current=[i].concat(c()(a.current.slice(0,d-1))))})));clearTimeout(l.current),l.current=setTimeout((function(){var n;null===(n=e.setDataList)||void 0===n||n.call(e,c()(a.current))}),200),null!=e&&e.callback&&(null==e||e.callback(a.current))},cacheDataListRef:a,deletedIdsRef:r}}}}]);