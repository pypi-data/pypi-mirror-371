(self.webpackChunk=self.webpackChunk||[]).push([[4931],{47661:function(e,t,n){"use strict";n.d(t,{rM:function(){return c},xx:function(){return u}});var r=n(26068),a=n.n(r),o=n(40227),i=n(9389),l=n(74901),s={theme:"light",mode:"auto",isDarkTheme:!1,colorPrimary:o.b,collapsed:!1},u=function(){if("undefined"==typeof window)return s;try{var e=JSON.parse(localStorage.getItem("userSettings")||"{}");return a()(a()({},s),e)}catch(e){return s}},d=(0,l.O4)("userSettings",a()({},u())),c=(0,i.cn)((function(e){return e(d)}),(function(e,t,n){var r=e(d),i=a()(a()({},r),n||{});t(d,a()(a()({},i),{},{colorPrimary:i.colorPrimary||o.b,isDarkTheme:"realDark"===i.theme}))}))},34649:function(e,t,n){"use strict";var r=n(26068),a=n.n(r),o=n(67825),i=n.n(o),l=n(38551),s=n(94899),u=n(32699),d=n.n(u),c=n(50959),m=n(11527),h=["menu","trigger","placement","children"];t.Z=function(e){var t=e.menu,n=e.trigger,r=void 0===n?["hover"]:n,o=e.placement,u=void 0===o?"bottomRight":o,p=e.children,f=i()(e,h),g=(0,l.useIntl)(),v=(0,c.useMemo)((function(){var e;return null==t||null===(e=t.items)||void 0===e?void 0:e.map((function(e){return a()(a()({},d().omit(e,"locale")),{},{label:e.locale?g.formatMessage({id:e.label}):e.label})}))}),[null==t?void 0:t.items,g]);return(0,m.jsx)(s.Z,a()(a()({menu:{items:v,onClick:null==t?void 0:t.onClick},trigger:r,placement:u},f),{},{children:p}))}},62722:function(e,t,n){"use strict";n.d(t,{f:function(){return g},Z:function(){return v}});var r=n(34649),a=n(16407),o=n(19019),i=n(69070),l=n(56838),s=n(38551),u=n(90468),d=n(85885),c=n(8267),m=n(84682),h=n(50959),p=n(11527),f=function(e){var t=e.left,n=e.right,r=e.marginBottom,a=void 0===r?0:r,o=e.marginTop,i=void 0===o?30:o,l=e.style,s=(0,h.useMemo)((function(){var e={};return e.marginBottom="".concat(a,"px"),e.marginTop="".concat(i,"px"),l&&Object.assign(e,l),e}),[a,i,l]);return(0,p.jsxs)("div",{className:"page-tools",style:s,children:[(0,p.jsx)("div",{className:"left",children:t}),(0,p.jsx)("div",{className:"right",children:n})]})},g=function(e){var t=e.handleInputChange,n=e.handleSelectChange,g=e.handleSearch,v=e.handleDeleteByBatch,x=e.handleClickPrimary,b=e.rowSelection,y=e.actionItems,k=e.selectOptions,w=e.showSelect,j=e.buttonText,S=e.buttonIcon,C=e.actionType,D=void 0===C?"button":C,_=e.marginBottom,Z=void 0===_?10:_,M=e.marginTop,A=void 0===M?10:M,P=e.inputHolder,T=void 0===P?"common.filter.name":P,L=e.selectHolder,B=e.showPrimaryButton,E=void 0===B||B,I=e.showDeleteButton,z=void 0===I||I,R=e.width,F=(0,s.useIntl)(),q=(0,h.useMemo)((function(){var e,t;return E||z?(0,p.jsxs)(u.Z,{size:20,children:["dropdown"===D?(0,p.jsx)(r.Z,{menu:{items:y,onClick:x},children:(0,p.jsx)(d.ZP,{icon:(0,p.jsx)(a.Z,{}),type:"primary",iconPosition:"end",children:j})}):(0,p.jsx)(d.ZP,{icon:null!=S?S:(0,p.jsx)(o.Z,{}),type:"primary",onClick:x,children:j}),(0,p.jsx)(d.ZP,{icon:(0,p.jsx)(i.Z,{}),danger:!0,onClick:v,disabled:!b.selectedRowKeys.length,children:(0,p.jsxs)("span",{children:[null==F||null===(e=F.formatMessage)||void 0===e?void 0:e.call(F,{id:"common.button.delete"}),b.selectedRowKeys.length>0&&(0,p.jsxs)("span",{children:["(",null===(t=b.selectedRowKeys)||void 0===t?void 0:t.length,")"]})]})})]}):null}),[y,D,null==b?void 0:b.selectedRowKeys,x,F]);return(0,p.jsx)(f,{marginBottom:Z,marginTop:A,left:(0,p.jsxs)(u.Z,{children:[(0,p.jsx)(c.Z,{placeholder:F.formatMessage({id:T}),style:{width:(null==R?void 0:R.input)||230},allowClear:!0,onChange:t}),w&&(0,p.jsx)(m.default,{allowClear:!0,showSearch:!1,placeholder:F.formatMessage({id:L}),style:{width:(null==R?void 0:R.select)||230},size:"large",onChange:n,options:k}),(0,p.jsx)(d.ZP,{type:"text",style:{color:"var(--ant-color-text-tertiary)"},onClick:g,icon:(0,p.jsx)(l.Z,{})})]}),right:q})},v=f},98817:function(e,t,n){"use strict";var r=n(26068),a=n.n(r),o=n(32246),i=n(1956),l=n(50959),s=n(11527);t.Z=function(e){var t=(0,o.Z)(),n=t.saveScrollHeight,r=t.restoreScrollHeight;return l.useEffect((function(){e.open?n():r()}),[e.open]),(0,s.jsx)(i.Z,a()({},e))}},37963:function(e,t){"use strict";t.Z={xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1600}},20369:function(e,t,n){"use strict";n.d(t,{Kd:function(){return r},_W:function(){return i},iE:function(){return o},tb:function(){return l},zK:function(){return a}});var r={CREATE:"create",UPDATE:"update",VIEW:"view"},a={error:{text:"var(--ant-red-6)",bg:"var(--ant-red-1)"},warning:{text:"var(--ant-orange-6)",bg:"var(--ant-orange-1)"},transitioning:{text:"var(--ant-blue-6)",bg:"var(--ant-blue-1)"},success:{text:"var(--ant-color-success)",bg:"var(--ant-color-success-bg)"},inactive:{text:"var(--ant-color-text-tertiary)",border:"rgba(200,200,200,1)",bg:"var(--ant-color-fill)"}},o={error:"error",warning:"warning",transitioning:"transitioning",success:"success",inactive:"inactive"},i={CREATE:1,UPDATE:2,DELETE:3},l=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*_+])[a-zA-Z\d!@#$%^&*_+]{6,12}$/},40227:function(e,t,n){"use strict";n.d(t,{b:function(){return r},Z:function(){return a}});var r="#007BFF",a={light:{"root-entry-name":"variable",cssVar:!0,hashed:!1,components:{Input:{inputFontSize:14,inputFontSizeLG:14},Table:{headerBorderRadius:4,cellPaddingInline:16,cellPaddingBlock:6,cellFontSize:14,rowSelectedHoverBg:"rgb(249 249 249)",rowHoverBg:"rgb(249 249 249)",rowSelectedBg:"transparent"},Button:{contentFontSizeLG:14,primaryShadow:"none",defaultShadow:"none",dangerShadow:"none"},Tabs:{titleFontSizeLG:14},DatePicker:{fontSizeLG:14},Menu:{iconSize:16,iconMarginInlineEnd:12,itemBorderRadius:4,itemSelectedColor:"#007BFF",itemHeight:32,groupTitleColor:"rgba(0,0,0,1)",itemHoverColor:"rgba(0,0,0,1)",itemColor:"rgba(0,0,0,1)",itemHoverBg:"rgba(0,0,0,0.04)",itemActiveBg:"rgba(0,0,0,0.04)"},Progress:{lineBorderRadius:2},Select:{optionSelectedBg:"rgba(230, 230, 230, 88%)",fontSizeLG:14},Message:{contentPadding:"12px 16px"},Tooltip:{colorBgSpotlight:"#3e3e3e"},Cascader:{dropdownHeight:240},Slider:{handleSize:8,handleSizeHover:8,trackBg:"rgba(0,0,0,0.15)",handleColor:"rgba(0,0,0,0.2)",trackHoverBg:"rgba(0,0,0,0.25)",handleActiveColor:"rgba(0,0,0,0.3)",dotActiveBorderColor:"rgba(0,0,0,0.25)",handleActiveOutlineColor:"rgba(0,0,0,0.25)",dotBorderColor:"rgba(0,0,0,0.25)"}},token:{darkMode:!1,fontFamily:"Helvetica Neue, -apple-system, BlinkMacSystemFont, Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",colorText:"rgba(0,0,0,1)",colorPrimary:"#007BFF",colorSuccess:"#54cc98",borderRadius:4,borderRadiusSM:2,colorBgContainer:"#fff",fontSize:14,motion:!0}},dark:{"root-entry-name":"variable",cssVar:!0,hashed:!1,components:{Input:{inputFontSize:14,inputFontSizeLG:14},Table:{headerBorderRadius:4,cellPaddingInline:16,cellPaddingBlock:6,cellFontSize:14,rowSelectedHoverBg:"#1d1d1d",rowHoverBg:"#1d1d1d",rowSelectedBg:"transparent"},Button:{contentFontSizeLG:14,primaryShadow:"none",defaultShadow:"none",dangerShadow:"none"},Tabs:{titleFontSizeLG:14},DatePicker:{fontSizeLG:14},Menu:{iconSize:16,iconMarginInlineEnd:12,itemBorderRadius:4,itemHeight:32,itemSelectedColor:"#007BFF",darkItemSelectedBg:"#141414",darkItemHoverBg:"rgba(255, 255, 255, 0.03)",groupTitleColor:"rgba(0,0,0,1)",itemHoverColor:"rgba(0,0,0,1)",itemColor:"rgba(0,0,0,1)",itemHoverBg:"rgb(24 25 27)",itemActiveBg:"rgb(24 25 27)"},Progress:{lineBorderRadius:2},Select:{optionSelectedBg:"#333",fontSizeLG:14},Message:{contentPadding:"12px 16px"},Tooltip:{},Cascader:{dropdownHeight:240},Slider:{handleSize:8,handleSizeHover:8,trackBg:"rgba(255,255,255,.15)",handleColor:"rgba(255,255,255,0.2)",trackHoverBg:"rgba(255,255,255,0.25)",handleActiveColor:"rgba(255,255,255,0.3)",dotActiveBorderColor:"rgba(255,255,255,0.25)",handleActiveOutlineColor:"rgba(255,255,255,0.25)",dotBorderColor:"rgba(255,255,255,0.25)"}},token:{darkMode:!0,fontFamily:"Helvetica Neue, -apple-system, BlinkMacSystemFont, Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",colorText:"#ccc",colorPrimary:"#007BFF",colorSuccess:"#48A77E",borderRadius:4,borderRadiusSM:2,fontSize:14,motion:!0,colorFill:"#000",colorBgBase:"#000"}},colorPrimary:r}},38780:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(26068),a=n.n(r),o=n(48305),i=n.n(o),l=n(32699),s=n(92605),u=n(50959),d=n(73341);function c(e){var t,n=(0,d.Z)().userSettings,r=e||{},o=r.options,c=r.events,m=r.defer,h=void 0===m||m,p=o||{},f=p.scrollbars,g=p.overflow,v=(p.oppositeTheme,u.useRef(null)),x=u.useRef(null),b=u.useRef(!1),y=u.useRef(null),k=u.useRef(!1),w=u.useRef(null),j=(0,s.A)({options:{update:{debounce:0},overflow:a()({x:"hidden"},g),scrollbars:a()(a()({autoHide:"scroll",autoHideDelay:600,clickScroll:"instant"},f),{},{theme:(null==f?void 0:f.theme)||("light"===n.theme?"os-theme-dark":"os-theme-light")})},events:a()({},c),defer:h}),S=i()(j,2),C=S[0],D=S[1];x.current=null==D?void 0:D(),v.current=null===(t=x.current)||void 0===t||null===(t=t.elements())||void 0===t?void 0:t.scrollEventElement;var _=u.useCallback((0,l.throttle)((function(){var e,t,n,r,a;null===(e=v.current)||void 0===e||null===(t=e.scrollTo)||void 0===t||t.call(e,{top:null===(n=v.current)||void 0===n?void 0:n.scrollHeight,behavior:"smooth"}),null===(r=x.current)||void 0===r||null===(a=r.update)||void 0===a||a.call(r)}),100),[(v.current,x.current)]),Z=u.useCallback((function(){var e,t,n,r;null===(e=v.current)||void 0===e||null===(t=e.scrollTo)||void 0===t||t.call(e,{top:v.current.scrollHeight,behavior:"auto"}),null===(n=x.current)||void 0===n||null===(r=n.update)||void 0===r||r.call(n)}),[v.current,x.current]),M=u.useCallback((function(e){k.current||(0===e?Z():_())}),[_,Z]),A=u.useCallback((function(){var e,t,n,r;null===(e=v.current)||void 0===e||null===(t=e.scrollTo)||void 0===t||t.call(e,{top:0,behavior:"auto"}),null===(n=x.current)||void 0===n||null===(r=n.update)||void 0===r||r.call(n)}),[v.current,x.current]),P=u.useCallback((function(e){var t,n,r,a,o,i;a=null===(t=v.current)||void 0===t?void 0:t.scrollTop,o=null===(n=v.current)||void 0===n?void 0:n.scrollHeight,i=a+(null===(r=v.current)||void 0===r?void 0:r.clientHeight)+20>=o,k.current=!i,w.current&&clearTimeout(w.current),w.current=setTimeout((function(){k.current=!1}),5e3)}),[]),T=u.useCallback((function(e){if(x.current)return x.current;var t,n,r;e&&(C(e),y.current=e,b.current=!0,x.current=null==D?void 0:D(),v.current=null===(t=x.current)||void 0===t||null===(t=t.elements())||void 0===t?void 0:t.scrollEventElement,null===(n=y.current)||void 0===n||null===(r=n.addEventListener)||void 0===r||r.call(n,"wheel",P));return x.current}),[C,D]);return(0,u.useEffect)((function(){return function(){var e,t,n,r;null===(e=x.current)||void 0===e||null===(t=e.destroy)||void 0===t||t.call(e),null===(n=y.current)||void 0===n||null===(r=n.removeEventListener)||void 0===r||r.call(n,"wheel",P)}}),[D]),{initialize:T,instance:x.current,scrollEventElement:v.current,initialized:b.current,generateInstance:function(){var e;x.current=null==D?void 0:D(),v.current=null===(e=x.current)||void 0===e||null===(e=e.elements())||void 0===e?void 0:e.scrollEventElement},updateScrollerPosition:M,updateScrollerPositionToTop:A}}},73341:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(26068),a=n.n(r),o=n(48305),i=n.n(o),l=n(47661),s=n(40227),u=n(79416),d=n(50959);function c(){var e=s.Z.light,t=s.Z.dark,n=s.Z.colorPrimary,r=(0,u.KO)(l.rM),o=i()(r,2),c=o[0],m=o[1],h=(0,d.useMemo)((function(){var r="realDark"===c.theme?t:e;return a()(a()({},r),{},{token:a()(a()({},r.token),{},{colorPrimary:c.colorPrimary||n})})}),[c.theme,c.colorPrimary]),p=function(e){var t,n,r=function(e){return"auto"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"realDark":"light":e}(e);t=r,(n=document.querySelector("html"))&&n.setAttribute("data-theme",t),m({theme:r,mode:e,isDarkTheme:"realDark"===r})};return(0,d.useEffect)((function(){var e;e=window.matchMedia("(prefers-color-scheme: dark)").matches?"realDark":"light","auto"===c.mode&&e!==c.theme&&p("auto")}),[c.theme,c.mode]),(0,d.useEffect)((function(){var e=window.matchMedia("(prefers-color-scheme: dark)"),t=function(){"auto"===c.mode&&p("auto")};return e.addEventListener("change",t),function(){e.removeEventListener("change",t)}}),[c.mode,c.theme]),{userSettings:c,setUserSettings:m,setTheme:p,isDarkTheme:c.isDarkTheme,themeData:h,componentSize:"large"}}},69997:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(48305),a=n.n(r),o=n(37963),i=n(32699),l=n.n(i),s=n(50959);function u(){var e=(0,s.useState)({width:window.innerWidth,height:window.innerHeight}),t=a()(e,2),n=t[0],r=t[1],i=(0,s.useState)(!1),u=a()(i,2),d=u[0],c=u[1],m=(0,s.useState)(!1),h=a()(m,2),p=h[0],f=h[1],g=(0,s.useState)(!1),v=a()(g,2),x=v[0],b=v[1],y=(0,s.useState)(""),k=a()(y,2),w=k[0],j=k[1],S=(0,s.useCallback)((function(e){return e<o.Z.sm?(c(!0),f(!1),b(!1),void j("sm")):e<o.Z.md?(c(!1),f(!0),b(!1),void j("md")):e<o.Z.lg?(c(!1),f(!1),b(!0),void j("lg")):(c(!1),f(!1),b(!0),void j("xl"))}),[]),C=(0,s.useCallback)(l().throttle((function(){r({width:window.innerWidth,height:window.innerHeight})}),200),[]);return(0,s.useEffect)((function(){return window.addEventListener("resize",C),function(){window.removeEventListener("resize",C)}}),[C]),(0,s.useEffect)((function(){S(n.width)}),[n.width,S]),{size:n,isMobile:d,isTablet:p,isDesktop:x,currentPoint:w}}},89975:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _t}});var r=n(48305),a=n.n(r),o=n(67581),i=n(54876),l=n(50959),s=n(26068),u=n.n(s),d=n(90228),c=n.n(d),m=n(87999),h=n.n(m),p=n(38551),f=n(28694),g="/dashboard",v="".concat(g,"/usage"),x="".concat(g,"/usage/stats");function b(){return y.apply(this,arguments)}function y(){return(y=h()(c()().mark((function e(){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,p.request)(g));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){return w.apply(this,arguments)}function w(){return(w=h()(c()().mark((function e(t,n){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,p.request)("".concat(n.url,"?").concat(f.Z.stringify(t)),{method:"GET",cancelToken:null==n?void 0:n.token}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j=(0,l.createContext)({}),S=j,C=n(8445),D=n(62722),_=n(57989),Z=n(58258),M=n(81745),A=n(7922),P=n(29687),T=n(11527),L=[_.Us.llm,_.Us.embedding,_.Us.reranker],B=function(){var e=(0,p.useIntl)(),t=(0,l.useContext)(j).active_models||[],n=[{title:e.formatMessage({id:"common.table.name"}),dataIndex:"name",key:"name",ellipsis:!0,render:function(e,t){return(0,T.jsx)(C.Z,{ghost:!0,children:(0,T.jsx)("span",{children:e})})}},{title:e.formatMessage({id:"dashboard.allocatevram"}),dataIndex:"resource_claim.memory",key:"vram",ellipsis:!0,render:function(e,t){var n,r;return(0,T.jsxs)(C.Z,{ghost:!0,children:[(0,Z.hy)((null===(n=t.resource_claim)||void 0===n?void 0:n.vram)||0)," /"," ",(0,Z.hy)((null===(r=t.resource_claim)||void 0===r?void 0:r.ram)||0)]})}},{title:e.formatMessage({id:"models.form.replicas"}),dataIndex:"instance_count",key:"instance_count"},{title:e.formatMessage({id:"dashboard.tokens"}),dataIndex:"token_count",key:"token_count",ellipsis:!0,render:function(e,t){var n,r=e;e||(r=L.includes(null===(n=t.categories)||void 0===n?void 0:n[0])?0:"N/A");return(0,T.jsx)(C.Z,{ghost:!0,children:(0,T.jsx)("span",{children:r})})}}];return(0,T.jsx)(M.Z,{gutter:[20,0],children:(0,T.jsxs)(A.Z,{xs:24,sm:24,md:24,lg:24,xl:24,children:[(0,T.jsx)(D.Z,{style:{margin:"26px 0px"},left:(0,T.jsx)("span",{style:{fontWeight:"var(--font-weight-bold)"},children:e.formatMessage({id:"dashboard.activeModels"})}),right:!1}),(0,T.jsx)("div",{children:(0,T.jsx)(P.Z,{columns:n,dataSource:t,pagination:!1,rowKey:"id"})})]})})},E=(0,l.memo)(B),I=n(20009),z=n(90468),R=n(32699),F=n.n(R),q=[{key:"worker_count",label:"dashboard.workers",backgroundColor:"var(--color-white-1)"},{key:"gpu_count",label:"dashboard.totalgpus",backgroundColor:"var(--color-white-1)"},{key:"model_count",label:"dashboard.models",backgroundColor:"var(--color-white-1)"},{key:"model_instance_count",label:"models.form.replicas",backgroundColor:"var(--color-white-1)"}],N="rgba(0,85,255,0.8)",Y="rgb(102, 214, 224)",H="rgba(85,167,255,0.8)",U="card-body___by6gK",G="row___aaW9s",O="content___L6aNm",W=function(e){var t=e.label,n=e.value;e.bgColor;return(0,T.jsx)(I.Z,{bordered:!1,style:{background:"var(--color-white-1)"},className:U,children:(0,T.jsxs)("div",{className:O,children:[(0,T.jsx)("div",{className:"label font-500",children:t}),(0,T.jsx)("div",{className:"value font-500",children:n})]})})},K=function(){var e=(0,p.useIntl)(),t=(0,l.useContext)(j).resource_counts||{};return(0,T.jsx)("div",{children:(0,T.jsx)(M.Z,{gutter:[20,20],className:G,children:q.map((function(n,r){return(0,T.jsx)(A.Z,{xs:{flex:"100%"},sm:{flex:"50%"},md:{flex:"50%"},lg:{flex:"25%"},xl:{flex:"25%"},children:W({label:e.formatMessage({id:n.label}),value:(a=F().get(t,n.key,0),"number"==typeof a?a:(0,T.jsxs)(z.Z,{className:"value-box",size:20,children:[(0,T.jsx)("span",{className:"value-healthy",children:a.healthy}),(0,T.jsx)("span",{className:"value-warning",children:a.warning}),(0,T.jsx)("span",{className:"value-error",children:a.error})]})),bgColor:n.backgroundColor})},n.key);var a}))})})},V=l.memo(K),Q="cardWrapper___Q41EU",$=function(e){var t=e.children,n=e.style;return(0,T.jsx)("div",{className:Q,style:u()({},n),children:t})},X=n(13636),J=n(29220),ee=n(30396),te=function(e){var t=(0,J.Z)(),n=t.gaugeItemConfig,r=t.title,a=t.chartColorMap,o=e.value,i=e.height,l=e.width,s=e.labelFormatter,d=e.title,c=e.color;if(!o&&0!==o)return(0,T.jsx)(ee.Z,{height:i,title:d});var m={title:u()(u()({},r),{},{text:d,top:"0",left:"center"}),series:[u()(u()({},n),{},{axisLine:u()(u()({},n.axisLine),{},{lineStyle:u()(u()({},n.axisLine.lineStyle),{},{color:[[o/100,c],[1,a.gaugeBgColor]]})}),itemStyle:{color:"transparent"},detail:u()(u()({},n.detail),{},{formatter:s||n.detail.formatter}),data:[{value:o}]})]};return(0,T.jsx)(X.Z,{height:i,options:m,width:l||"100%"})},ne=(0,l.memo)(te),re=n(37963),ae=n(69997),oe=function(e){var t=e.seriesData,n=e.xAxisData,r=e.yAxisName,a=e.height,o=e.width,i=e.labelFormatter,s=e.tooltipValueFormatter,d=void 0===s?null:s,c=e.legendData,m=void 0===c?[]:c,h=e.smooth,p=e.title,f=(0,J.Z)(),g=f.grid,v=f.legend,x=f.lineItemConfig,b=f.title,y=f.tooltip,k=f.xAxis,w=f.yAxis,j={title:{text:""},grid:g,tooltip:u()(u()({},y),{},{formatter:function(e){return d?y.formatter(e,d):y.formatter(e)}}),xAxis:u()(u()({},k),{},{axisLabel:u()(u()({},k.axisLabel),{},{formatter:function(e,t){return i?i(e,t):t===n.length-1?"":e}})}),yAxis:w,legend:u()(u()({},v),{},{data:m.map((function(e){return{name:e,icon:"circle"}}))}),series:[]},S=(0,l.useMemo)((function(){var e=F().map(t,(function(e){return u()(u()(u()({},e),x),{},{smooth:h,itemStyle:u()(u()({},x.itemStyle),{},{color:e.color}),lineStyle:u()(u()({},x.lineStyle),{},{color:e.color})})}));return u()(u()({},j),{},{animation:!1,title:u()(u()({},b),{},{text:p}),yAxis:u()(u()({},j.yAxis),{},{name:r,nameTextStyle:{fontSize:12,align:"right"}}),xAxis:u()(u()({},j.xAxis),{},{data:n}),series:e})}),[t,n,r,p,h,m,j]);return(0,T.jsx)(T.Fragment,{children:t.length?(0,T.jsx)(X.Z,{height:a,options:S,width:o||"100%"}):(0,T.jsx)(ee.Z,{height:a,title:p})})},ie=(0,l.memo)(oe),le=n(7672),se=n.n(le),ue={cpu:{label:"CPU",type:"CPU",intl:!1,color:"rgba(250, 173, 20,.8)"},ram:{label:"dashboard.memory",type:"Memory",intl:!0,color:"rgba(114, 46, 209,.8)"},gpu:{label:"GPU",type:"GPU",intl:!1,color:"rgba(84, 204, 152,.8)"},vram:{label:"dashboard.vram",type:"VRAM",intl:!0,color:"rgba(255, 107, 179, 80%)"}},de=function(){var e,t=(0,p.useIntl)(),n=(null===(e=(0,l.useContext)(j))||void 0===e||null===(e=e.system_load)||void 0===e?void 0:e.history)||{},r=["gpu","cpu","ram","vram"],a=(0,l.useMemo)((function(){var e=[],a=[];return{seriesData:F().map(r,(function(r){var o=F().get(ue,r,{}),i=o.intl?t.formatMessage({id:o.label}):o.label;e.push(i);var l=F().get(n,r,[]);return{name:i,color:o.color,data:F().map(l,(function(e){return a.push(se()(1e3*e.timestamp).format("HH:mm:ss")),{time:se()(1e3*e.timestamp).format("HH:mm:ss"),value:F().round(F().get(e,"value",0),1)}}))}})),legendData:e,xAxisData:F().uniq(a)}}),[n,t]);return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(ie,{height:390,seriesData:a.seriesData,legendData:a.legendData,xAxisData:a.xAxisData,tooltipValueFormatter:function(e){return e?"".concat(e,"%"):e},smooth:!0,width:"100%",yAxisName:"(%)"})})},ce=(0,l.memo)(de),me=function(e){return e<=50||void 0===e?"rgb(84, 204, 152, 80%)":e<=80?"rgba(250, 173, 20, 80%)":"rgba(255, 77, 79, 80%)"},he=function(){var e,t=(0,p.useIntl)(),n=(null===(e=(0,l.useContext)(j))||void 0===e||null===(e=e.system_load)||void 0===e?void 0:e.current)||{},r=(0,ae.Z)().size,o=(0,l.useState)("20px"),i=a()(o,2),s=i[0],u=i[1],d=(0,l.useState)(190),c=a()(d,2),m=c[0],h=(c[1],(0,l.useState)(400)),f=a()(h,2),g=f[0],v=(f[1],(0,l.useMemo)((function(){return{gpu:{data:F().round(n.gpu||0,1),color:me(n.gpu)},vram:{data:F().round(n.vram||0,1),color:me(n.vram)},cpu:{data:F().round(n.cpu||0,1),color:me(n.cpu)},ram:{data:F().round(n.ram||0,1),color:me(n.ram)}}}),[n]));return(0,l.useEffect)((function(){r.width<re.Z.xl?u("0"):u("20px")}),[r.width]),(0,T.jsx)("div",{children:(0,T.jsxs)("div",{className:"system-load",children:[(0,T.jsx)(D.Z,{style:{margin:"26px 0px"},left:(0,T.jsx)("span",{className:"font-700",children:t.formatMessage({id:"dashboard.systemload"})})}),(0,T.jsxs)(M.Z,{style:{width:"100%"},gutter:[0,20],children:[(0,T.jsx)(A.Z,{xs:24,sm:24,md:24,lg:24,xl:16,style:{paddingRight:s},children:(0,T.jsx)($,{style:{height:400,width:"100%"},children:(0,T.jsx)(ce,{})})}),(0,T.jsx)(A.Z,{xs:24,sm:24,md:24,lg:24,xl:8,children:(0,T.jsx)($,{style:{height:g,width:"100%"},children:(0,T.jsxs)(M.Z,{style:{height:g,width:"100%"},children:[(0,T.jsx)(A.Z,{span:12,style:{height:m},children:(0,T.jsx)(ne,{height:m,value:v.gpu.data,color:v.gpu.color,title:t.formatMessage({id:"dashboard.gpuutilization"})})}),(0,T.jsx)(A.Z,{span:12,style:{height:m},children:(0,T.jsx)(ne,{title:t.formatMessage({id:"dashboard.vramutilization"}),height:m,color:v.vram.color,value:v.vram.data})}),(0,T.jsx)(A.Z,{span:12,style:{height:m},children:(0,T.jsx)(ne,{title:t.formatMessage({id:"dashboard.cpuutilization"}),height:m,color:v.cpu.color,value:v.cpu.data})}),(0,T.jsx)(A.Z,{span:12,style:{height:m},children:(0,T.jsx)(ne,{title:t.formatMessage({id:"dashboard.memoryutilization"}),height:m,color:v.ram.color,value:v.ram.data})})]})})})]})]})})},pe=(0,l.memo)(he),fe=n(15558),ge=n.n(fe),ve=n(53649),xe=n.n(ve),be=n(97884),ye=n(67768),ke=n(98817),we=n(335),je=n.n(we),Se=n(11227),Ce=n(28667);var De,_e,Ze,Me,Ae,Pe=n(67825),Te=n.n(Pe),Le=n(76808),Be=n(83603),Ee=n(84682),Ie=["options"],ze=be.ZP.div(De||(De=xe()(["\n  display: flex;\n  align-items: center;\n  gap: 8px;\n"]))),Re=be.ZP.div(_e||(_e=xe()(["\n  .ant-select-item {\n    padding-inline-start: 8px;\n    &:hover {\n      background-color: var(--ant-select-option-active-bg);\n    }\n  }\n  .ant-select-item-option-selected:not(.ant-select-item-option-disabled) {\n    background-color: unset;\n    font-weight: unset;\n    &:hover {\n      background-color: var(--ant-select-option-active-bg);\n    }\n  }\n"]))),Fe=be.ZP.div(Ze||(Ze=xe()(["\n  margin-bottom: 10px;\n  padding: 5px 8px;\n  font-size: 12px;\n  border-bottom: 1px solid var(--ant-color-split);\n  .ant-checkbox-wrapper {\n    color: var(--ant-color-text-tertiary);\n  }\n"]))),qe=(0,be.ZP)(Le.Z)(Me||(Me=xe()(["\n  border-radius: 12px;\n"]))),Ne=function(e){var t=(0,p.useIntl)(),n=e.options,r=void 0===n?[]:n,o=Te()(e,Ie),i=l.useState({checked:!1,indeterminate:!1}),s=a()(i,2),d=s[0],c=s[1],m=l.useState(r||[]),h=a()(m,2),f=h[0],g=h[1],v=l.useRef(null);(0,l.useEffect)((function(){g(r||[])}),[r]);var x=function(e){var t,n=e.target.checked,r=(null==f?void 0:f.map((function(e){return e.value})))||[];c({checked:n,indeterminate:!1});var a=ge()(o.value||[]);a=n?Array.from(new Set([].concat(ge()(a),ge()(r)))):a.filter((function(e){return!r.includes(e)})),null===(t=o.onChange)||void 0===t||t.call(o,a,f||[])},b=function(e){if(o.value&&Array.isArray(o.value)&&0!==e.length){var t=new Set(o.value),n=(null==e?void 0:e.map((function(e){return e.value})))||[],r=n.every((function(e){return t.has(e)})),a=n.some((function(e){return t.has(e)}));c({checked:r,indeterminate:a&&!r})}else c({checked:!1,indeterminate:!1})};return(0,l.useEffect)((function(){var e,t,n=null===(e=v.current)||void 0===e||null===(t=e.querySelector)||void 0===t?void 0:t.call(e,"input");if(n){var r=function(e){"Backspace"===e.key&&""===n.value&&(e.stopPropagation(),e.preventDefault())};return n.addEventListener("keydown",r),function(){n.removeEventListener("keydown",r)}}}),[v.current]),(0,T.jsx)("div",{ref:v,children:(0,T.jsx)(Ee.default,u()(u()({},o),{},{options:f,maxTagCount:0,defaultActiveFirstOption:!1,dropdownRender:function(e){return(0,T.jsxs)(Re,{children:["multiple"===o.mode&&(0,T.jsx)(Fe,{children:(0,T.jsx)(Be.Z,{checked:d.checked,indeterminate:d.indeterminate,onChange:x,children:t.formatMessage({id:"common.checbox.all"})})}),e]})},optionRender:function(e,t){var n,r=e.value,a=e.label;return(0,T.jsxs)(ze,{children:[null!==(n=o.value)&&void 0!==n&&n.includes(r)?(0,T.jsx)(Be.Z,{checked:!0}):(0,T.jsx)(Be.Z,{}),(0,T.jsx)(C.Z,{ghost:!0,children:a})]})},menuItemSelectedIcon:!1,onChange:function(e,t){var n,r=Array.isArray(e)?e:[e],a=(null==f?void 0:f.map((function(e){return e.value})))||[],i=r.length===(null==a?void 0:a.length);c({checked:i,indeterminate:!i&&r.length>0}),null===(n=o.onChange)||void 0===n||n.call(o,r,t)},tagRender:function(e){var n=e.label,r=e.isMaxTag?n.slice(0,-3).slice(1):n;return(0,T.jsx)(qe,{bordered:!1,style:{height:24,backgroundColor:"var(--ant-color-fill-tertiary)",fontSize:"var(--ant-font-size)"},className:"flex-center",children:t.formatMessage({id:"common.select.count"},{count:r})})},onBlur:function(e){var t;null===(t=o.onBlur)||void 0===t||t.call(o,e)},onFocus:function(e){var t;null===(t=o.onFocus)||void 0===t||t.call(o,e)},onSearch:function(e){if(o.onSearch)o.onSearch(e);else{var t=null==r?void 0:r.filter((function(t){return t.label.toLowerCase().includes(e.toLowerCase())}));g(t||[]),b(t||[])}},filterOption:function(e,t){return!(!t||!t.label)&&t.label.toLowerCase().includes(e.toLowerCase())},onDropdownVisibleChange:function(e){e||(b(r),g(r||[]))}}))})},Ye=n(17098),He=n(14344),Ue=n(23333),Ge=n(85885);var Oe=60,We=29,Ke=be.ZP.div(Ae||(Ae=xe()(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0px;\n  .selection {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n  }\n  .ant-select-selection-overflow-item > span {\n    height: 24px;\n  }\n"]))),Ve=function(e){var t=e.query,n=e.userList,r=e.modelList,a=e.handleDateChange,o=e.handleUsersChange,i=e.handleModelsChange,l=e.handleExport,s=e.url,u=e.disabledDate,d=function(e){var t=e||{},n=t.range,r=void 0===n?60:n,a=t.disabledDate,o=(0,p.useIntl)(),i=function(e){return 12*e.year()+e.month()};return{disabledRangeDaysDate:function(e,t){var n=t.from,o=t.type;if(!a)return!1;if(n){var l=n.add(1-r,"days"),s=n.add(r-1,"days");switch(o){case"year":return e.year()<l.year()||e.year()>s.year();case"month":return i(e)<i(l)||i(e)>i(s);default:return e.isBefore(l)||e.isAfter(s)}}return!1},rangePresets:[{label:o.formatMessage({id:"dashboard.usage.datePicker.last7days"}),value:[se()().add(-6,"d"),se()()]},{label:o.formatMessage({id:"dashboard.usage.datePicker.last30days"}),value:[se()().add(-29,"d"),se()()]},{label:o.formatMessage({id:"dashboard.usage.datePicker.last60days"}),value:[se()().add(-59,"d"),se()()]}],range:r}}({range:Oe,disabledDate:u}),c=d.disabledRangeDaysDate,m=d.rangePresets,h=(0,p.useIntl)();return(0,T.jsx)(Ke,{children:(0,T.jsxs)("div",{className:"selection",children:[(0,T.jsx)(He.Z.RangePicker,{maxDate:se()(),defaultValue:[se()().add(-We,"d"),se()()],disabledDate:c,presets:m,allowClear:!1,style:{width:220},value:[se()(t.start_date),se()(t.end_date)],onChange:a}),(0,T.jsx)(Ne,{allowClear:!0,showSearch:!0,mode:"multiple",options:n,maxTagCount:0,placeholder:h.formatMessage({id:"dashboard.usage.selectuser"}),style:{maxWidth:200,minWidth:160},value:t.user_ids,onChange:o}),(0,T.jsx)(Ne,{allowClear:!0,showSearch:!0,mode:"multiple",options:r,maxTagCount:0,placeholder:h.formatMessage({id:"dashboard.usage.selectmodel"}),value:t.model_ids,style:{maxWidth:200,minWidth:160},onChange:i}),s===x&&(0,T.jsx)(Ue.Z,{title:h.formatMessage({id:"common.button.export"}),children:(0,T.jsx)(Ge.ZP,{icon:(0,T.jsx)(Ye.Z,{}),onClick:l})})]})})},Qe=n(54713),$e=n(41650),Xe=29,Je=function(e){return new Map(e.map((function(e){return[se()(1e3*e.timestamp).format("YYYY-MM-DD"),e.value]})))},et=function(e,t){return e.map((function(e,n){return{time:e,value:t.get(e)||0}}))};function tt(e){var t=e||{},n=t.url,r=t.defaultData,o=(0,l.useState)(!1),i=a()(o,2),s=i[0],d=i[1],m=(0,l.useState)({start_date:se()().subtract(Xe,"days").format("YYYY-MM-DD"),end_date:se()().format("YYYY-MM-DD"),data:r}),p=a()(m,2),f=p[0],g=p[1],x=(0,l.useState)({start_date:se()().subtract(Xe,"days").format("YYYY-MM-DD"),end_date:se()().format("YYYY-MM-DD"),model_ids:[],user_ids:[]}),b=a()(x,2),y=b[0],w=b[1],j=(0,l.useState)([]),S=a()(j,2),C=S[0],D=S[1],_=(0,l.useState)([]),Z=a()(_,2),M=Z[0],A=Z[1],P=(0,l.useState)(!1),T=a()(P,2),L=T[0],B=T[1],E=(0,l.useMemo)((function(){if(n===v)return{requestTokenData:{requestData:[],tokenData:[],xAxisData:[]}};var e=f,t=e.start_date,r=e.end_date,a=e.data,o=t&&r?function(e,t){for(var n=se()(e),r=se()(t),a=[],o=n;o.isBefore(r)||o.isSame(r,"day");o=o.add(1,"day"))a.push(o.format("YYYY-MM-DD"));return a}(t,r):function(){for(var e=[],t=29;t>=0;t--){var n=se()().subtract(t,"day").format("YYYY-MM-DD");e.push(n)}return e}(),i=(null==a?void 0:a.completion_token_history)||[],l=(null==a?void 0:a.prompt_token_history)||[],s=(null==a?void 0:a.api_request_history)||[];if(!i.length)return{requestTokenData:{requestData:[],tokenData:[],xAxisData:[]}};var d={name:"API requests",areaStyle:{color:"rgba(13,171,219,0.15)"},color:Y,data:et(o,Je(s))},c=et(o,Je(i)),m=et(o,Je(l));return{requestTokenData:{requestData:[d],tokenData:[{name:"Completion tokens",color:N,data:c.map((function(e,t){return u()(u()({},e),{},{itemStyle:{borderRadius:m[t].value?[0,0,0,0]:[2,2,0,0]}})}))},{name:"Prompt tokens",color:H,data:m.map((function(e,t){return u()(u()({},e),{},{itemStyle:{borderRadius:[2,2,0,0]}})}))}],xAxisData:o}}}),[f,n]),I=function(){var e=h()(c()().mark((function e(){var t,n,r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={page:1,page_size:100},e.next=4,(0,Qe.nb)(t);case 4:n=e.sent,r=F().map(n.items||[],(function(e){return{label:e.name,value:e.id}})),D(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),D([]);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=h()(c()().mark((function e(){var t,n,r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={page:1,page_size:100},e.next=4,(0,$e.YX)(t);case 4:n=e.sent,r=F().map(n.items||[],(function(e){return{label:e.username,value:e.id}})),A(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),A([]);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=h()(c()().mark((function e(t){var r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,B(!0),e.next=4,k(t,{url:n});case 4:r=e.sent,g({start_date:t.start_date,end_date:t.end_date,data:r}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),g({start_date:t.start_date,end_date:t.end_date,data:{}});case 11:return e.prev=11,B(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}();return{usageData:E,result:f,open:s,loading:L,userList:M,modelList:C,query:y,setQuery:w,init:function(){R(y),I(),z()},setResult:g,handleOnCancel:function(){d(!1)},handleExport:function(){d(!0)},handleDateChange:function(e,t){w((function(e){return u()(u()({},e),{},{start_date:t[0],end_date:t[1]})})),R(u()(u()({},y),{},{start_date:t[0],end_date:t[1]}))},handleUsersChange:function(e){w((function(t){return u()(u()({},t),{},{user_ids:e})})),R(u()(u()({},y),{},{user_ids:e}))},handleModelsChange:function(e){w((function(t){return u()(u()({},t),{},{model_ids:e})})),R(u()(u()({},y),{},{model_ids:e}))}}}var nt,rt,at,ot,it,lt=function(e){var t,n=e||{},r=n.open,a=n.onCancel,o=(0,p.useIntl)(),i=tt({url:v,disabledDate:!1}),s=i.init,u=i.setResult,d=i.loading,c=i.result,m=i.userList,h=i.modelList,f=i.query,g=i.setQuery,x=(i.handleExport,i.handleDateChange),b=i.handleUsersChange,y=i.handleModelsChange,k=[{title:o.formatMessage({id:"resources.table.index"}),width:80,render:function(e,t,n){return n+1}},{title:o.formatMessage({id:"dashboard.usage.export.date"}),dataIndex:"date"},{title:o.formatMessage({id:"dashboard.usage.export.user"}),dataIndex:"user_id",render:function(e){var t;return(0,T.jsx)(C.Z,{ghost:!0,children:null===(t=m.find((function(t){return t.value===e})))||void 0===t?void 0:t.label})}},{title:o.formatMessage({id:"dashboard.usage.export.model"}),dataIndex:"model_id",render:function(e){var t;return(0,T.jsx)(C.Z,{ghost:!0,children:(null===(t=h.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||e})}},{title:"Completion Tokens",dataIndex:"completion_token_count",width:170,align:"right"},{title:"Prompt Tokens",dataIndex:"prompt_token_count",align:"right",width:150},{title:"API Requests",dataIndex:"request_count",align:"right",width:150}];return(0,l.useEffect)((function(){r?s():(g({start_date:se()().subtract(29,"days").format("YYYY-MM-DD"),end_date:se()().format("YYYY-MM-DD"),model_ids:[],user_ids:[]}),u({start_date:"",end_date:"",data:{items:[]}}))}),[r]),(0,T.jsxs)(ke.Z,{title:o.formatMessage({id:"dashboard.usage.export"}),open:r,centered:!1,onCancel:a,destroyOnClose:!0,closeIcon:!0,maskClosable:!1,keyboard:!1,width:1e3,style:{top:"10%"},styles:{content:{padding:"0px"},header:{padding:"var(--ant-modal-content-padding)",paddingBottom:"0"},body:{padding:"0 var(--ant-modal-content-padding)"},footer:{padding:"0 var(--ant-modal-content-padding)"}},footer:(0,T.jsx)(ye.Z,{onOk:function(){var e,t="usage-data_".concat(f.start_date||"","_").concat(f.end_date||"",".xlsx");!function(e){var t=e.jsonData,n=e.fields,r=e.fieldLabels,a=e.formatMap,o=e.fileName,i=void 0===o?"data.xlsx":o,l=t.map((function(e){var t,r={},o=je()(n);try{for(o.s();!(t=o.n()).done;){var i=t.value,l=e[i],s=null==a?void 0:a[i];r[i]=s?s(l,e):l}}catch(e){o.e(e)}finally{o.f()}return r})),s=Ce.ZP.utils.json_to_sheet(l,{header:n});if(r){var u=n.map((function(e){return r[e]||e}));Ce.ZP.utils.sheet_add_aoa(s,[u],{origin:"A1"})}var d=Ce.ZP.utils.book_new();Ce.ZP.utils.book_append_sheet(d,s,"Sheet1");var c=Ce.ZP.write(d,{bookType:"xlsx",type:"array"}),m=new Blob([c],{type:"application/octet-stream"});(0,Se.saveAs)(m,i)}({jsonData:(null===(e=c.data)||void 0===e?void 0:e.items)||[],fileName:t,fields:k.map((function(e){return e.dataIndex})).filter(Boolean),fieldLabels:{user_id:"User",model_id:"Model",date:"Date",prompt_token_count:"Prompt Tokens",completion_token_count:"Completion Tokens",request_count:"API Requests"},formatMap:{user_id:function(e){var t;return(null===(t=m.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||e},model_id:function(e){var t;return(null===(t=h.find((function(t){return t.value===e})))||void 0===t?void 0:t.label)||e}}})},onCancel:a,okText:o.formatMessage({id:"common.button.export"})}),children:[(0,T.jsx)(Ve,{disabledDate:!1,url:v,query:f,userList:m,modelList:h,handleDateChange:x,handleUsersChange:b,handleModelsChange:y}),(0,T.jsx)(P.Z,{columns:k,tableLayout:"auto",style:{width:"100%",marginTop:"16px"},dataSource:(null===(t=c.data)||void 0===t?void 0:t.items)||[],loading:d,rowKey:"id",virtual:!0,scroll:{y:400},pagination:!1})]})},st=n(91663),ut=be.ZP.div(nt||(nt=xe()(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  gap: 16px;\n"]))),dt=(0,st.kc)((function(e){var t=e.css,n=e.token;return{wrapper:t(rt||(rt=xe()(["\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    background: ",";\n    border-radius: ","px;\n    padding: ","px;\n    justify-content: center;\n    align-items: center;\n    gap: ","px;\n    &.bordered {\n      border: 1px solid ",";\n    }\n    .title {\n      font-size: ","px;\n      font-weight: var(--font-weight-medium);\n    }\n    .content {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      font-size: ","px;\n      color: ",";\n      gap: 8px;\n      .icon {\n        display: inline-block;\n        width: 10px;\n        height: 10px;\n        gap: 10px;\n        &.roundRect {\n          border-radius: 2px;\n        }\n        &.circle {\n          border-radius: 50%;\n        }\n      }\n    }\n  "])),n.colorBgContainer,n.borderRadius,n.padding,n.padding,n.colorBorder,n.fontSize,n.fontSize,n.colorTextSecondary)}})),ct=function(e){var t=dt(),n=t.styles,r=t.cx,a=e.title,o=e.content,i=e.style,l=e.bordered,s=e.iconType,u=e.color;return(0,T.jsxs)("div",{className:r({bordered:l},n.wrapper),style:i,children:[(0,T.jsx)("div",{className:"title",children:a}),(0,T.jsxs)("div",{className:"content",children:[(0,T.jsx)("span",{className:r([s],"icon"),style:{backgroundColor:u||"transparent"}}),(0,T.jsx)("span",{children:o})]})]})},mt=function(e){var t=e.dataList,n=e.bordered;return(0,T.jsx)(ut,{style:{height:e.height||"100%"},children:t.map((function(e,t){return(0,T.jsx)(ct,{title:e.label,content:e.value,bordered:n,color:e.color,iconType:e.iconType},t)}))})},ht=function(e){var t=e.seriesData,n=e.xAxisData,r=e.yAxisName,a=e.height,o=e.width,i=e.labelFormatter,s=e.tooltipValueFormatter,d=void 0===s?null:s,c=e.legendData,m=void 0===c?[]:c,h=e.smooth,p=e.title,f=e.chartData,g=(0,J.Z)(),v=g.grid,x=g.legend,b=g.lineItemConfig,y=g.barItemConfig,k=g.title,w=g.tooltip,j=g.xAxis,S=g.yAxis,C=f.line,D=f.bar,_={title:{text:""},grid:u()(u()({},v),{},{right:0,top:20,bottom:10}),tooltip:u()(u()({},w),{},{formatter:function(e){return d?w.formatter(e,d):w.formatter(e)}}),xAxis:u()(u()({},j),{},{axisLabel:u()(u()({},j.axisLabel),{},{formatter:i})}),yAxis:S,legend:u()(u()({},x),{},{data:m,itemGap:20,bottom:5,show:!1}),series:[]},Z=(0,l.useMemo)((function(){var e=F().map(C,(function(e){return u()(u()(u()({},e),b),{},{smooth:h,itemStyle:u()(u()({},b.itemStyle),{},{color:e.color}),yAxisIndex:1,lineStyle:u()(u()({},b.lineStyle),{},{color:e.color})})})),t=F().map(D,(function(e){return u()(u()(u()({},e),y),{},{stack:"total",yAxisIndex:0,itemStyle:u()(u()({},e.itemStyle),{},{color:e.color})})}));return u()(u()({},_),{},{animation:!1,title:u()(u()({},k),{},{text:p}),yAxis:[u()({},_.yAxis),u()(u()({},_.yAxis),{},{nameTextStyle:{fontSize:12,align:"right"}})],xAxis:u()(u()({},_.xAxis),{},{data:n}),series:[].concat(ge()(t),ge()(e))})}),[t,n,r,p,h,m,_]);return(0,T.jsx)(T.Fragment,{children:C.length||D.length?(0,T.jsx)(X.Z,{height:a,options:Z,width:o||"100%"}):(0,T.jsx)(ee.Z,{height:a,title:p})})},pt=((0,be.ZP)(Ge.ZP).attrs({className:"download-button"})(at||(at=xe()(["\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  z-index: 10;\n  display: none;\n"]))),be.ZP.div(ot||(ot=xe()(["\n  &:hover {\n    .download-button {\n      display: flex;\n    }\n  }\n"])))),ft=function(e){return se()(e).format("MM-DD")},gt=[{label:"0",value:"Completion Tokens",key:"completionCount",iconType:"roundRect",color:N},{label:"0",value:"Prompt Tokens",key:"promptCount",iconType:"roundRect",color:H},{label:"0",value:"API Requests",key:"requestCount",iconType:"circle",color:Y}],vt=[{name:"Completion tokens",icon:"roundRect"},{name:"Prompt tokens",icon:"roundRect"},{name:"API requests",icon:"circle"}],xt=function(e){var t=e.requestData,n=e.tokenData,r=e.xAxisData,a=(0,l.useMemo)((function(){var e,r,a,o={requestCount:(null===(e=t[0])||void 0===e?void 0:e.data.reduce((function(e,t){return e+t.value}),0))||0,completionCount:(null===(r=n[0])||void 0===r?void 0:r.data.reduce((function(e,t){return e+t.value}),0))||0,promptCount:(null===(a=n[1])||void 0===a?void 0:a.data.reduce((function(e,t){return e+t.value}),0))||0};return gt.map((function(e){return u()(u()({},e),{},{label:(0,Z.HN)(o[e.key]||0)})}))}),[t,n]);return(0,T.jsx)(pt,{children:(0,T.jsxs)($,{style:{width:"100%",position:"relative"},children:[(0,T.jsx)(mt,{dataList:a,height:80}),(0,T.jsx)(ht,{chartData:{line:t,bar:n},seriesData:[],xAxisData:r,height:360,smooth:!1,legendData:vt,labelFormatter:ft})]})})},bt=function(e){var t=e.seriesData,n=e.xAxisData,r=e.height,a=e.width,o=e.labelFormatter,i=(e.legendData,e.maxItems),s=e.title,d=(0,J.Z)(),c=d.grid,m=d.legend,h=d.title,p=d.tooltip,f=d.xAxis,g=d.yAxis,v=(0,l.useMemo)((function(){var e={title:u()(u()({},h),{},{left:"start"}),grid:u()(u()({},c),{},{top:0,bottom:i?"".concat(1/i*(i-n.length)*100,"%"):0}),tooltip:u()({},p),xAxis:u()(u()({},f),{},{axisLabel:u()(u()({},f.axisLabel),{},{formatter:o})}),yAxis:u()(u()({},g),{},{axisLabel:u()(u()({},g.axisLabel),{},{overflow:"truncate",width:75,ellipsis:"..."})}),legend:u()(u()({},m),{},{data:[]}),series:[]},r=F().map(t,(function(e){return u()(u()({},e),{},{type:"bar",barWidth:20,stack:"Ad",barGap:"30%",label:{show:!1},itemStyle:{color:e.color}})}));return u()(u()({},e),{},{animation:!1,title:u()(u()({},e.title),{},{text:s}),yAxis:u()(u()({},e.yAxis),{},{inverse:!0,type:"category",splitLine:{show:!1},data:n,axisLine:{show:!1},axisTick:{show:!1}}),xAxis:u()(u()({},e.xAxis),{},{type:"value",splitLine:{show:!1},axisLabel:{show:!1},axisTick:{show:!1}}),series:r})}),[t,n,s,o,p,c,f,g,m]),x=(0,l.useMemo)((function(){var e;return null==t||null===(e=t.every)||void 0===e?void 0:e.call(t,(function(e){var t;return!(null!=e&&null!==(t=e.data)&&void 0!==t&&t.length)}))}),[t]);return(0,T.jsx)(T.Fragment,{children:x?(0,T.jsx)(ee.Z,{height:r,title:s}):(0,T.jsx)(X.Z,{height:r,options:v,width:a||"100%"})})},yt=(0,l.memo)(bt),kt=function(e){var t=e.userData,n=e.topUserList;return(0,T.jsx)($,{children:(0,T.jsx)(yt,{seriesData:t,xAxisData:n,height:440,maxItems:10})})},wt=be.ZP.div(it||(it=xe()(["\n  margin: 0;\n  font-weight: 700;\n"]))),jt=function(e){var t=e.maxWidth,n=(0,p.useIntl)(),r=(0,l.useContext)(j).model_usage,a=tt({url:x,disabledDate:!0,defaultData:{api_request_history:[],completion_token_history:[],prompt_token_history:[]}}),o=a.usageData,i=a.query,s=a.userList,u=a.modelList,d=a.handleOnCancel,c=a.init,m=a.handleExport,h=a.handleDateChange,f=a.handleUsersChange,g=a.handleModelsChange,v=a.open,b=(0,l.useMemo)((function(){var e,t=(null==r||null===(e=r.top_users)||void 0===e?void 0:e.slice(0,10))||[],n={name:"Prompt tokens",color:H,data:[]},a={name:"Completion tokens",color:N,data:[]},o=t.map((function(e){return n.data.push({name:e.username,value:e.prompt_token_count,itemStyle:{borderRadius:e.completion_token_count?[0,2,2,0]:[2,2,2,2]}}),a.data.push({name:e.username,value:e.completion_token_count,itemStyle:{borderRadius:e.prompt_token_count?[2,0,0,2]:[2,2,2,2]}}),e.username}));return{userData:[a,n],topUserList:ge()(new Set(o))}}),[null==r?void 0:r.top_users]);return(0,l.useEffect)((function(){c()}),[]),(0,T.jsxs)("div",{children:[(0,T.jsxs)(M.Z,{style:{width:"100%"},gutter:t<re.Z.xl?[0,0]:[0,20],children:[(0,T.jsxs)(A.Z,{xs:24,sm:24,md:24,lg:24,xl:16,style:{paddingRight:t<re.Z.xl?0:20},children:[(0,T.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"20px 0 "},children:[(0,T.jsx)(wt,{children:n.formatMessage({id:"dashboard.usage"})}),(0,T.jsx)(Ve,{url:x,query:i,userList:s,modelList:u,disabledDate:!0,handleDateChange:h,handleUsersChange:f,handleModelsChange:g,handleExport:m})]}),(0,T.jsx)(xt,{requestData:null==o?void 0:o.requestTokenData.requestData,xAxisData:null==o?void 0:o.requestTokenData.xAxisData,tokenData:null==o?void 0:o.requestTokenData.tokenData})]}),(0,T.jsxs)(A.Z,{xs:24,sm:24,md:24,lg:24,xl:8,style:{margin:0},children:[(0,T.jsx)("div",{style:{margin:t<re.Z.xl?"26px 0":"32px 0"},children:(0,T.jsx)(wt,{children:n.formatMessage({id:"dashboard.topusers"})})}),(0,T.jsx)(kt,{userData:b.userData,topUserList:b.topUserList})]})]}),(0,T.jsx)(lt,{open:v,onCancel:d})]})},St=function(){var e=(0,ae.Z)().size.width,t=(0,l.useState)(re.Z.xl),n=a()(t,2),r=n[0],o=n[1];return(0,l.useEffect)((function(){o(e)}),[e]),(0,T.jsx)(jt,{maxWidth:r})},Ct=function(e){var t=e.setLoading,n=(0,l.useState)({}),r=a()(n,2),o=r[0],i=r[1],s=(0,l.useCallback)(h()(c()().mark((function e(){var n;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(!0),e.next=4,b();case 4:n=e.sent,i(n),t(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),t(!1),i({});case 13:case"end":return e.stop()}}),e,null,[[0,9]])}))),[]);return(0,l.useEffect)((function(){s()}),[]),(0,T.jsxs)(S.Provider,{value:u()(u()({},o),{},{fetchData:s}),children:[(0,T.jsx)(V,{}),(0,T.jsx)(pe,{}),(0,T.jsx)(St,{}),(0,T.jsx)(E,{})]})},Dt=(0,l.memo)(Ct),_t=function(){var e=(0,l.useState)(!1),t=a()(e,2),n=t[0],r=t[1];return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(o._z,{ghost:!0,extra:[],header:{style:{paddingInline:"var(--layout-content-header-inlinepadding)"}},children:(0,T.jsx)(i.Z,{spinning:n,children:(0,T.jsx)(Dt,{setLoading:r})})})})}},41650:function(e,t,n){"use strict";n.d(t,{Nq:function(){return h},YX:function(){return u},h8:function(){return f},r4:function(){return c}});var r=n(90228),a=n.n(r),o=n(87999),i=n.n(o),l=n(38551),s="/users";function u(e){return d.apply(this,arguments)}function d(){return(d=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s),{methos:"GET",params:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return m.apply(this,arguments)}function m(){return(m=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s),{method:"POST",data:t.data}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s,"/").concat(t.data.id),{method:"PUT",data:t.data}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return g.apply(this,arguments)}function g(){return(g=i()(a()().mark((function e(t){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.request)("".concat(s,"/").concat(t),{method:"DELETE"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},99168:function(){}}]);