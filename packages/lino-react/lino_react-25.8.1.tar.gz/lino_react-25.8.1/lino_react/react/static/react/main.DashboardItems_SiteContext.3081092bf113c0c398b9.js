"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[4580],{5272:(t,e,s)=>{s.r(e),s.d(e,{DashboardItems:()=>p,name:()=>n});s(5247);var a=s(7881),r=s.n(a),i=s(6606),o=s(3748);const n="DashboardItems";let l;l={lm:Promise.resolve().then(s.bind(s,8546)),prButton:Promise.all([s.e(1927),s.e(5573),s.e(7236),s.e(4600),s.e(7801)]).then(s.bind(s,6286)),queryString:Promise.all([s.e(4166),s.e(2298)]).then(s.bind(s,9320))};(0,i.RegisterImportPool)(l);class d extends i.Component{async prepare(){super.prepare(),this.ex.queryString=this.ex.queryString.default}constructor(t){super(t),h.call(this),this.state={...this.state,data:null,mask:!0,actorID:null},this.reload=this.reloadData}onReady(){this.reloadData()}componentWillUnmount(){delete this.props.APP.URLContext.globals.panels[this.state.actorID]}render(){if(!this.state.ready)return null;const{data:t}=this.state;return this.props.APP.URLContext.filled(t)?(0,o.jsxs)(this.ex.lm.LoadingMask,{mask:this.state.mask,children:[!this.props.dashboardMain&&(0,o.jsx)(this.ex.prButton.Button,{icon:"pi pi-refresh",style:{float:"right"},onClick:t=>{this.reloadData(!0)}}),(0,o.jsx)("div",{dangerouslySetInnerHTML:{__html:t}})]}):null}}d.requiredModules=["lm","queryString","prButton"],d.iPool=l,d.propTypes={itemIndex:(t,...e)=>{if(!t.dashboardMain)return r().number.isRequired(t,...e)},dashboardMain:r().bool.isRequired,APP:r().object.isRequired},d.defaultProps={dashboardMain:!1};var h=function(){this.liveUpdate=t=>this.reload(),this.reloadData=t=>{this.setState({mask:!0});const e={fmt:"json"},{APP:s}=this.props,{actionHandler:a}=s.URLContext;a.commonParams(e);const r=this.props.dashboardMain?"api/main_html":`dashboard/${this.props.itemIndex}`;a.silentFetch({path:`${r}?${this.ex.queryString.stringify(e)}`,signal:a.abortController.signal}).then((e=>{!e.version_mismatch||0!==this.props.itemIndex&&!t?this.setState({data:e.html,mask:!1,actorID:e.actorID}):s.reload()}))}};class p extends i.Component{constructor(t){super(t),this.state={...this.state,items:Array((t.APP.state.user_settings.dashboard_items||0)+1)},this.reloadData=this.reload}reload(){this.props.APP.URLContext.actionHandler.clearRequestPool(),this.state.items.forEach(((t,e)=>{t.reload()}))}render(){return this.state.ready?(0,o.jsx)("div",{children:[...this.state.items.keys()].map((t=>(0,o.jsx)(d,{dashboardMain:0===t,itemIndex:t-1,APP:this.props.APP,ref:e=>this.state.items[t]=e},t)))}):null}}p.propTypes={APP:r().object.isRequired}}}]);
//# sourceMappingURL=main.DashboardItems_SiteContext.3081092bf113c0c398b9.js.map