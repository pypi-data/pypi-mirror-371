[tox]
min_version = 4
env_list =
    py3{10,11,12,13,14}-{tests,mypy},
    coverage-report


[testenv]
package = wheel
wheel_build_env = .pkg
dependency_groups =
    tests: testing
    mypy: type-checking
commands =
    tests: pytest {posargs}
    mypy: mypy tests/typing


[testenv:py3{10,13}-tests]
dependency_groups = testing
commands = coverage run -m pytest {posargs}


[testenv:coverage-report]
dependency_groups = testing
skip_install = true
parallel_show_output = true
depends = py3{10,13}-tests
commands =
    coverage combine
    coverage report


[testenv:mypy-pkg]
dependency_groups = type-checking
commands = mypy src


[testenv:pyright]
deps = pyright
dependency_groups = type-checking
commands = pyright tests/typing
