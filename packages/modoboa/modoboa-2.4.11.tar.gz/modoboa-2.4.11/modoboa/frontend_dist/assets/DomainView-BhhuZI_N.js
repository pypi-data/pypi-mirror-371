import{_ as _e}from"./DomainAdminList-BjC4KsqI.js";import{c as G}from"./colors-DoZdCu1D.js";import{b as F,m as h,o,e as r,a as t,l as s,t as l,J as re,w as e,F as T,G as E,f as n,g as k,K as Z,h as j,d as pe,L as ae,r as ue,c as m,n as $,k as ie,p as ye,j as ge,M as ke}from"./index-I1VDlN4g.js";import{f as q,V,d as be,e as he}from"./VAvatar-Lpb-Dion.js";import{V as xe}from"./VTable-CNz2SGk4.js";import{d as U}from"./domains-Bgn4ixHL.js";import{V as de,a as me}from"./VToolbar-BiCiBxBJ.js";import{V as W}from"./VSpacer-C7xukQmu.js";import{V as B,a as P,c as O,b as oe}from"./VCard-er_isjE_.js";import{V as x,a as c}from"./VRow-BF35mT1S.js";import{V as we}from"./VSheet-Btq_Mu4s.js";import{V as Ve,a as $e,b as De}from"./VExpansionPanels-CwGtXDhr.js";import{V as L}from"./VAlert-DIQTrRif.js";import{V as Ce,a as Se}from"./forwardRefs-Dvjn_Xq4.js";import{_ as Me}from"./ConfirmDialog-BBcgdAnO.js";import{V as M}from"./VChip-B4iSpj8_.js";import{V as Ne}from"./VDataTableVirtual-BlnO18u_.js";import{V as ee}from"./VDialog-Bk6EWNhz.js";import{t as Ie}from"./transports-Dz7c6kIy.js";import{L as Te}from"./LoadingData-CYwX3Jpn.js";import{_ as Ae}from"./ResourcesForm-CuUvrOdY.js";import{T as se}from"./TimeSerieChart-BMN8BeFZ.js";import{V as Ke,a as Le,b as te,c as le}from"./VTabs-B1fyVn4M.js";import"./VAutocomplete-C4IpXyl8.js";import"./VSelect-Cs4ARbAS.js";import"./VTextField-BdyvgvkG.js";import"./tag-BnSYRTcD.js";import"./VProgressCircular-w75-3ogi.js";import"./VMenu-BPFJwj2f.js";import"./VCheckboxBtn-Dt810gWf.js";import"./VSelectionControl-Dg-XyRRS.js";import"./filter-CnffiQAW.js";/* empty css              */import"./ssrBoot-AzTdjPjk.js";import"./VDataTable-4JRjbtgF.js";import"./VContainer-DvTbsotR.js";import"./VForm-DAkW4nfy.js";import"./VPicker-CfT82M8N.js";import"./VWindowItem-ChWm_kz3.js";const Be={class:"text-h6"},Pe={width:"40%"},Re={class:"text-white"},je={class:"text-white"},ze={class:"text-white"},Fe={class:"text-white"},X={__name:"DmarcSourceTable",props:{title:{type:String,default:""},color:{type:String,default:""},total:{type:Number,default:null},sources:{type:Object,default:null}},setup(u){const{$gettext:a}=F();return(y,d)=>(o(),h("div",null,[r("div",Be,[s(l(u.title)+" ",1),r("span",{class:re(`text-${u.color}-lighten-2`)},l(u.total),3)]),t(xe,null,{default:e(()=>[r("tbody",null,[(o(!0),h(T,null,E(u.sources,(i,f)=>(o(),h(T,{key:f},[r("tr",null,[r("th",Pe,l(f),1),r("th",null,l(n(a)("Total")),1),d[0]||(d[0]=r("th",null,"SPF",-1)),d[1]||(d[1]=r("th",null,"DKIM",-1))]),(o(!0),h(T,null,E(i,(v,w)=>(o(),h("tr",{key:w},[r("td",null,l(w),1),r("td",null,l(v.total),1),r("td",null,[t(q,{color:"green lighten-2",size:"24"},{default:e(()=>[r("span",Re,l(v.spf.success),1)]),_:2},1024),t(q,{color:"red lighten-2 ml-1",size:"24"},{default:e(()=>[r("span",je,l(v.spf.failure),1)]),_:2},1024)]),r("td",null,[t(q,{color:"green lighten-2",size:"24"},{default:e(()=>[r("span",ze,l(v.dkim.success),1)]),_:2},1024),t(q,{color:"red lighten-2 ml-1",size:"24"},{default:e(()=>[r("span",Fe,l(v.dkim.failure),1)]),_:2},1024)])]))),128))],64))),128))])]),_:1})]))}},Oe={key:0},Ue={class:"mx-2"},Ee={class:"text-subtitle-1"},Ge={key:1},qe={__name:"DmarcAligmentChart",props:{domain:{type:Object,default:()=>null}},setup(u){const{$gettext:a}=F(),y=["aligned","trusted","forwarded","failed"],d=u,i=k({colors:[G.green.lighten2,G.orange.lighten2,G.blue.lighten2,G.red.lighten2],labels:[a("Fully aligned"),a("Partially aligned"),a("Forwarded"),a("Failed")],legend:{position:"bottom"}}),f=k(null),v=k([{key:"total",label:a("Total"),color:"primary lighten-2"},{key:"aligned",label:a("Fully aligned"),color:"green lighten-2"},{key:"trusted",label:a("Partially aligned"),color:"orange lighten-2"},{key:"forwarded",label:a("Forwarded"),color:"blue lighten-2"},{key:"failed",label:a("Failed"),color:"red lighten-2"}]),w=Z.now(),_=k(w.year),b=k(w.weekNumber),D=k(!1),N=k(!1),R=k(null),z=k([]),I=k({}),Y=j(()=>Z.fromObject({weekYear:_.value,weekNumber:b.value}).startOf("week")),H=j(()=>Z.fromObject({weekYear:_.value,weekNumber:b.value}).endOf("week"));function J(K){let p="";for(const A of K.split(" "))p!==""&&(p+=" "),p+="text-"+A;return p}function Q(){b.value===52?(_.value+=1,b.value=1):b.value+=1}function C(){b.value===1?(_.value-=1,b.value=52):b.value-=1}function g(){if(N.value)return;const K=`${_.value}-${b.value}`;N.value=!0,U.getDomainDmarcAlignment(d.domain.pk,K).then(p=>{if(N.value=!1,p.status===204){D.value=!0;return}I.value={total:0},f.value=p.data,z.value=[];for(const A of y){let S=0;for(const ne in p.data[A])for(const ve in p.data[A][ne])S+=p.data[A][ne][ve].total;I.value.total+=S,I.value[A]=S,z.value.push(S)}})}return pe(()=>g()),ae(b,()=>{g()}),ae(_,()=>{g()}),(K,p)=>{const A=ue("apexchart");return f.value?(o(),h("div",Oe,[t(P,null,{default:e(()=>[t(de,{dense:"",elevation:"0",class:"mr-2"},{default:e(()=>[t(me,null,{default:e(()=>[s(l(n(a)("Alignment")),1)]),_:1}),t(W),t(V,{icon:"mdi-arrow-left",size:"x-small",onClick:C}),r("span",Ue,l(Y.value.toLocaleString())+" - "+l(H.value.toLocaleString()),1),t(V,{icon:"mdi-arrow-right",size:"x-small",onClick:Q})]),_:1}),t(B,null,{default:e(()=>[t(x,null,{default:e(()=>[t(c,{cols:"5"},{default:e(()=>[z.value?(o(),m(A,{key:0,type:"pie",height:"350",options:i.value,series:z.value},null,8,["options","series"])):$("",!0)]),_:1}),t(c,{cols:"7"},{default:e(()=>[t(x,null,{default:e(()=>[(o(!0),h(T,null,E(v.value,S=>(o(),m(c,{key:S.key,cols:"6"},{default:e(()=>[t(we,{outlined:"",color:S.color,rounded:""},{default:e(()=>[t(P,{outlined:"",class:"pa-10 text-center"},{default:e(()=>[r("span",{class:re("text-h4 "+J(S.color))},l(I.value[S.key]),3),p[1]||(p[1]=r("br",null,null,-1)),r("span",Ee,l(S.label),1)]),_:2,__:[1]},1024)]),_:2},1032,["color"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(De,{modelValue:R.value,"onUpdate:modelValue":p[0]||(p[0]=S=>R.value=S),class:"mt-2"},{default:e(()=>[t(Ve,{title:n(a)("Detail")},{default:e(()=>[t($e,null,{default:e(()=>[t(X,{title:n(a)("Trusted sources"),color:"green",total:I.value.aligned,sources:f.value.aligned},null,8,["title","total","sources"]),t(X,{title:n(a)("Partially trusted sources / Forwarders"),color:"orange",total:I.value.trusted,sources:f.value.trusted,class:"mt-4"},null,8,["title","total","sources"]),t(X,{title:n(a)("Forwarders with ARC"),color:"blue",total:I.value.forwarded,sources:f.value.forwarded,class:"mt-4"},null,8,["title","total","sources"]),t(X,{title:n(a)("Unknown sources / Threats"),color:"red",total:I.value.failed,sources:f.value.failed,class:"mt-4"},null,8,["title","total","sources"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])])):(o(),h("div",Ge,[D.value?(o(),m(L,{key:0,type:"info",variant:"outlined",prominent:"",border:"start",class:"mt-6"},{default:e(()=>[r("div",null,l(n(a)("DMARC support does not seem to be enabled for this domain.")),1),r("div",null,l(n(a)("If you configured it recently, please wait for the first report to be received and processed.")),1)]),_:1})):$("",!0)]))}}},Xe={id:"dkimdns",class:"dkim"},ce={__name:"DKIMKeyViewer",props:{domain:{type:Object,default:null}},setup(u){const a=u,y=j(()=>{let i=`v=DKIM1;k=rsa;p=${a.domain.dkim_public_key}`;const f=[];for(;i.length>0;)if(i.length>74)f.push(`  "${i.substring(0,74)}"`),i=i.substring(74);else{f.push(`  "${i}"`);break}return f.join(`
`)});function d(){navigator.clipboard.writeText(document.getElementById("dkimdns").textContent)}return(i,f)=>(o(),h("button",{class:"dkimbutton",onClick:f[0]||(f[0]=v=>d())},[r("pre",Xe,l(u.domain.dkim_key_selector)+"._domainkey."+l(u.domain.name)+". IN TXT ("+l(y.value)+`)
      }})`,1)]))}},We={class:"headline"},Ye={id:"dkimpub",class:"dkim"},He={__name:"DomainDKIMKey",props:{domain:{type:Object,default:null}},emits:["close"],setup(u,{emit:a}){const{$gettext:y}=F(),d=a;function i(){navigator.clipboard.writeText(document.getElementById("dkimpub").textContent)}return(f,v)=>(o(),m(P,null,{default:e(()=>[t(O,null,{default:e(()=>[r("span",We,l(n(y)("DKIM public key for"))+" "+l(u.domain.name),1)]),_:1}),t(B,null,{default:e(()=>[r("p",null,l(n(y)("Raw format. Click to copy")),1),t(L,{border:"start","colored-border":"","border-color":"primary lighten-3",elevation:"2",dense:""},{default:e(()=>[r("button",{class:"dkimbutton",onClick:v[0]||(v[0]=w=>i())},[r("pre",Ye,l(u.domain.dkim_public_key),1)])]),_:1})]),_:1}),t(B,null,{default:e(()=>[r("p",null,l(n(y)("Bind/named format. Click to copy")),1),t(L,{border:"start","colored-border":"","border-color":"primary lighten-3",elevation:"2",dense:""},{default:e(()=>[t(ce,{domain:u.domain},null,8,["domain"])]),_:1})]),_:1}),t(oe,null,{default:e(()=>[t(W),t(V,{onClick:v[1]||(v[1]=w=>d("close"))},{default:e(()=>[s(l(n(y)("Close")),1)]),_:1})]),_:1})]),_:1}))}},Je={class:"text-subtitle-1 text-grey-darken-2 mb-4"},Qe={class:"text-h6"},Ze={__name:"DomainDNSConfig",props:{domain:{type:Object,default:null}},emits:["close"],setup(u,{emit:a}){const y=a;return(d,i)=>(o(),m(P,null,{default:e(()=>[t(O,{class:"text-h5"},{default:e(()=>[r("span",null,l(d.$gettext("DNS configuration for "))+" "+l(u.domain.name),1)]),_:1}),t(B,null,{default:e(()=>[r("p",Je,l(d.$gettext("Here is an example of DNS configuration (bind format). Replace values between [ ] by the appropriate ones.")),1),t(L,{class:"mb-4",border:"start","border-color":"primary lighten-3",elevation:"2",color:"white"},{default:e(()=>[i[1]||(i[1]=r("div",{class:"text-h6"},"MX",-1)),r("pre",null,[s("mail."+l(u.domain.name)+". IN A ",1),r("strong",null,"["+l(d.$gettext("IP address of your Modoboa server"))+"]",1),s(`
@ IN MX 10 mail.`+l(u.domain.name)+".",1)])]),_:1,__:[1]}),t(L,{class:"mb-4",border:"start","border-color":"primary lighten-3",elevation:"2",dense:"",color:"white"},{default:e(()=>i[2]||(i[2]=[r("div",{class:"text-h6"},"SPF",-1),r("pre",null,'@ IN TXT "v=spf1 mx ~all"',-1)])),_:1,__:[2]}),u.domain.enable_dkim&&u.domain.dkim_public_key?(o(),m(L,{key:0,class:"mb-4",border:"start","border-color":"primary lighten-3",elevation:"2",dense:"",color:"white"},{default:e(()=>[i[3]||(i[3]=r("div",{class:"text-h6"},"DKIM",-1)),t(ce,{domain:u.domain},null,8,["domain"])]),_:1,__:[3]})):$("",!0),t(L,{class:"mb-4",border:"start","border-color":"primary lighten-3",elevation:"2",dense:"",color:"white"},{default:e(()=>[i[4]||(i[4]=r("div",{class:"text-h6"},"DMARC",-1)),r("pre",null,"_dmarc."+l(u.domain.name)+'. IN TXT "v=DMARC1; p=quarantine; pct=100;"',1)]),_:1,__:[4]}),t(L,{class:"mb-4",border:"start","border-color":"primary lighten-3",elevation:"2",dense:"",color:"white"},{default:e(()=>[r("div",Qe,l(d.$gettext("Auto configuration")),1),r("pre",null,[s("autoconfig."+l(u.domain.name)+". IN CNAME ",1),r("strong",null,"["+l(d.$gettext("hostname of your automx server"))+"]",1),s(`
autodiscover.`+l(u.domain.name)+". IN CNAME ",1),r("strong",null,"["+l(d.$gettext("hostname of your automx server"))+"]",1)])]),_:1})]),_:1}),t(oe,null,{default:e(()=>[t(W),t(V,{onClick:i[0]||(i[0]=f=>y("close"))},{default:e(()=>[s(l(d.$gettext("Close")),1)]),_:1})]),_:1})]),_:1}))}},et=ie(Ze,[["__scopeId","data-v-506783e1"]]),tt={__name:"DNSBLSummary",props:{mxrecord:{type:Object,default:null}},emits:["close"],setup(u,{emit:a}){const y=u,d=a;return(i,f)=>(o(),m(P,null,{default:e(()=>[t(O,{class:"text-h5"},{default:e(()=>[r("span",null,l(i.$gettext("DNSBL summary for "))+" "+l(y.mxrecord.name),1)]),_:1}),t(B,null,{default:e(()=>[s(l(i.$gettext("IP address %{ address } is currently listed by the following DNSBL providers:",{address:u.mxrecord.address}))+" ",1),t(Ce,null,{default:e(()=>[(o(!0),h(T,null,E(y.mxrecord.dnsbl_results,v=>(o(),m(Se,{key:v.provider},{default:e(()=>[s(l(v.provider)+" ("+l(v.status)+") ",1)]),_:2},1024))),128))]),_:1})]),_:1}),t(oe,null,{default:e(()=>[t(W),t(V,{onClick:f[0]||(f[0]=v=>d("close"))},{default:e(()=>[s(l(i.$gettext("Close")),1)]),_:1})]),_:1})]),_:1}))}},lt={class:"mt-4 overline"},at={class:"mt-4 overline"},ot={key:4,class:"d-flex align-center flex-nowrap mt-4"},nt={class:"text-subtitle-2"},st={class:"ml-6"},rt={key:0},ut={key:1},it={__name:"DNSDetail",props:{modelValue:{type:Object,default:null}},setup(u){const{$gettext:a}=F(),y=ye(),d=u,i=j(()=>d.modelValue),f=k(),v=k({}),w=k([{title:a("Name"),value:"name"},{title:a("Address"),value:"address"},{title:a("Updated"),value:"updated"},{title:"",value:"issues"}]),_=k(!1),b=k(null),D=k(!1),N=k(!1),R=k(!1);function z(){navigator.clipboard.writeText(i.value.dkim_public_key),y.displayNotification({msg:a("DKIM key copied to clipboard"),type:"success"})}function I(){const C={dkim_private_key_path:""};U.patchDomain(i.value.pk,C).then(()=>{y.displayNotification({msg:a("A new key will be generated soon. Refresh the page in a moment to see it."),type:"success"}),i.value.dkim_private_key_path="",_.value=!1}).catch(()=>{_.value=!1})}function Y(){_.value=!1}async function H(){_.value=!0,U.getDomainDNSDetail(i.value.pk).then(async C=>{v.value=C.data,await f.value.open(a("warning"),a("DKIM key does not seem to be generated yet or has failed. Do you want to requeue the job?"),{color:"warning",cancelLabel:a("No"),agreeLabel:a("Yes")})?I():Y()})}function J(){f.value.open(a("Warning"),a("DKIM keys already exist for this domain. Do you want to overwrite them?"),{color:"error",cancelLabel:a("No"),agreeLabel:a("Yes")})}function Q(C){b.value=C,R.value=!0}return ae(i,C=>{C&&U.getDomainDNSDetail(C.pk).then(g=>{v.value=g.data})},{immediate:!0}),(C,g)=>{const K=ue("translate");return i.value?(o(),m(P,{key:0},{default:e(()=>[t(O,null,{default:e(()=>[g[8]||(g[8]=r("span",null," DNS ",-1)),t(V,{class:"ml-2",icon:"mdi-information-outline",title:n(a)("DNS configuration help"),variant:"text",density:"compact",onClick:g[0]||(g[0]=p=>D.value=!0)},null,8,["title"])]),_:1,__:[8]}),t(B,null,{default:e(()=>[t(K,{class:"overline"},{default:e(()=>g[9]||(g[9]=[s("MX records")])),_:1,__:[9]}),i.value.dns_global_status=="pending"?(o(),m(x,{key:0},{default:e(()=>[t(c,null,{default:e(()=>[t(M,{color:"info",size:"small"},{default:e(()=>[s(l(n(a)("Pending")),1)]),_:1})]),_:1})]),_:1})):(o(),m(Ne,{key:1,headers:w.value,items:v.value.mx_records},{"item.updated":e(({item:p})=>[s(l(C.$date(p.updated)),1)]),"item.issues":e(({item:p})=>[p.dnsbl_results.length?(o(),m(V,{key:0,icon:"mdi-bell",color:"error",variant:"flat",size:"x-small",onClick:A=>Q(p)},null,8,["onClick"])):$("",!0)]),_:2},1032,["headers","items"])),r("div",lt,l(n(a)("Auto configuration")),1),i.value.dns_global_status=="pending"?(o(),m(x,{key:2},{default:e(()=>[t(c,null,{default:e(()=>[t(M,{color:"info",size:"small"},{default:e(()=>[s(l(n(a)("Pending")),1)]),_:1})]),_:1})]),_:1})):(o(),h(T,{key:3},[t(x,null,{default:e(()=>[t(c,null,{default:e(()=>[v.value.autoconfig_record?(o(),m(M,{key:0,color:"success"},{default:e(()=>[s(l(n(a)("autoconfig record (Mozilla): %{ value }",{value:v.value.autoconfig_record.value})),1)]),_:1})):(o(),m(M,{key:1,color:"warning"},{default:e(()=>[s(l(n(a)("autoconfig record (Mozilla) not found")),1)]),_:1}))]),_:1}),t(c,null,{default:e(()=>[v.value.autodiscover_record?(o(),m(M,{key:0,color:"success"},{default:e(()=>[s(l(n(a)("autodiscover record (Microsoft): %{ value }",{value:v.value.autodiscover_record.value})),1)]),_:1})):(o(),m(M,{key:1,color:"warning"},{default:e(()=>[s(l(n(a)("autodiscover record (Microsoft) not found")),1)]),_:1}))]),_:1})]),_:1}),r("div",at,l(n(a)("Authentication")),1),t(x,null,{default:e(()=>[t(c,null,{default:e(()=>[v.value.spf_record?(o(),m(M,{key:0,color:"success"},{default:e(()=>[s(l(n(a)("SPF record found")),1)]),_:1})):(o(),m(M,{key:1,color:"error"},{default:e(()=>[s(l(n(a)("SPF record not found")),1)]),_:1}))]),_:1}),t(c,null,{default:e(()=>[v.value.dkim_record?(o(),m(M,{key:0,color:"success"},{default:e(()=>[s(l(n(a)("DKIM record found")),1)]),_:1})):(o(),m(M,{key:1,color:"error"},{default:e(()=>[s(l(n(a)("DKIM record not found")),1)]),_:1}))]),_:1}),t(c,null,{default:e(()=>[v.value.dmarc_record?(o(),m(M,{key:0,color:"success"},{default:e(()=>[s(l(n(a)("DMARC record found")),1)]),_:1})):(o(),m(M,{key:1,color:"error"},{default:e(()=>[s(l(n(a)("DMARC record not found")),1)]),_:1}))]),_:1})]),_:1})],64)),i.value.enable_dkim?(o(),h("div",ot,[r("div",nt,l(n(a)("DKIM key")),1),r("div",st,[i.value.dkim_private_key_path&&i.value.dkim_public_key?(o(),h("div",rt,[t(V,{color:"primary",size:"small",onClick:g[1]||(g[1]=p=>N.value=!0)},{default:e(()=>[s(l(n(a)("Show key")),1)]),_:1}),t(V,{icon:"mdi-content-copy",variant:"text",class:"ml-2",title:n(a)("Copy key to clipboard"),onClick:z},null,8,["title"]),t(V,{icon:"mdi-refresh",title:n(a)("Generate a new DKIM key"),variant:"text",loading:_.value,onClick:J},null,8,["title","loading"])])):(o(),h("div",ut,[s(l(n(a)("Not generated"))+" ",1),t(V,{icon:"mdi-reload",color:"primary",variant:"text",loading:_.value,onClick:H},null,8,["loading"])]))])])):$("",!0)]),_:1}),t(ee,{modelValue:D.value,"onUpdate:modelValue":g[3]||(g[3]=p=>D.value=p),"max-width":"800px",persistent:""},{default:e(()=>[t(et,{domain:i.value,onClose:g[2]||(g[2]=p=>D.value=!1)},null,8,["domain"])]),_:1},8,["modelValue"]),t(ee,{modelValue:N.value,"onUpdate:modelValue":g[5]||(g[5]=p=>N.value=p),"max-width":"800px",persistent:""},{default:e(()=>[t(He,{domain:i.value,onClose:g[4]||(g[4]=p=>N.value=!1)},null,8,["domain"])]),_:1},8,["modelValue"]),t(ee,{modelValue:R.value,"onUpdate:modelValue":g[7]||(g[7]=p=>R.value=p),"max-width":"800px",persistent:""},{default:e(()=>[t(tt,{mxrecord:b.value,onClose:g[6]||(g[6]=p=>R.value=!1)},null,8,["mxrecord"])]),_:1},8,["modelValue"]),t(Me,{ref_key:"dialog",ref:f},null,512)]),_:1})):$("",!0)}}},fe={__name:"BooleanIcon",props:{value:{type:Boolean}},setup(u){const a=u,y=j(()=>a.value?"mdi-check-circle":"mdi-close-circle"),d=j(()=>a.value?"success":"error");return(i,f)=>(o(),m(be,{icon:y.value,color:d.value},null,8,["icon","color"]))}},dt={class:"headline"},mt={__name:"DomainSummary",props:{domain:{type:Object,default:null}},setup(u){const{$gettext:a}=F();return(y,d)=>u.domain?(o(),m(P,{key:0},{default:e(()=>[t(O,null,{default:e(()=>[r("div",dt,l(n(a)("General information")),1)]),_:1}),t(B,null,{default:e(()=>[t(x,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[s(l(n(a)("Creation date")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[s(l(y.$date(u.domain.creation)),1)]),_:1})]),_:1}),t(x,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[s(l(n(a)("Last modification date")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[s(l(y.$date(u.domain.last_modification)),1)]),_:1})]),_:1}),t(x,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[s(l(n(a)("Quota")),1)]),_:1}),u.domain.quota==="0"?(o(),m(c,{key:0,cols:"6"},{default:e(()=>[s(l(n(a)("Unlimited")),1)]),_:1})):(o(),m(c,{key:1,cols:"6"},{default:e(()=>[s(l(u.domain.quota)+" "+l(n(a)("MB")),1)]),_:1}))]),_:1}),t(x,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[s(l(n(a)("Default mailbox quota")),1)]),_:1}),u.domain.default_mailbox_quota==="0"?(o(),m(c,{key:0,cols:"6"},{default:e(()=>[s(l(n(a)("Unlimited")),1)]),_:1})):(o(),m(c,{key:1,cols:"6"},{default:e(()=>[s(l(u.domain.default_mailbox_quota)+" MB",1)]),_:1}))]),_:1}),t(x,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[s(l(n(a)("Daily sending limit")),1)]),_:1}),u.domain.message_limit!==void 0&&u.domain.message_limit!==null?(o(),m(c,{key:0,cols:"6"},{default:e(()=>[u.domain.message_limit===0?(o(),h(T,{key:0},[s(l(n(a)("Sending forbidden")),1)],64)):(o(),m(he,{key:1,color:u.domain.sent_messages_in_percent<80?"primary":"warning","model-value":u.domain.sent_messages_in_percent,height:"25",class:"white--text"},{default:e(({value:i})=>[s(l(Math.ceil(i))+"% ("+l(u.domain.message_limit)+" "+l(n(a)("messages"))+") ",1)]),_:1},8,["color","model-value"]))]),_:1})):(o(),m(c,{key:1,cols:"6"},{default:e(()=>[s(l(n(a)("Unlimited")),1)]),_:1}))]),_:1}),t(x,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[s(l(n(a)("Mailboxes")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[s(l(u.domain.mailbox_count),1)]),_:1})]),_:1}),t(x,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[s(l(n(a)("Aliases")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[s(l(u.domain.mbalias_count),1)]),_:1})]),_:1}),t(x,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[s(l(n(a)("Enabled")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[t(n(fe),{value:u.domain.enabled,variant:"flat"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})):$("",!0)}},ct={class:"headline"},ft={__name:"RelayDomainSummary",props:{domain:{type:Object,default:null}},async setup(u){let a,y;const d=u,i=k([]),f=j(()=>i.value.find(_=>_.name===d.domain.transport.service)),v=_=>d.domain.transport.settings[`${f.value.name}_${_}`],w=([a,y]=ge(()=>Ie.getAll()),a=await a,y(),a);return i.value=w.data,(_,b)=>d.domain?(o(),m(P,{key:0},{default:e(()=>[t(O,null,{default:e(()=>[r("div",ct,l(_.$gettext("Transport")),1)]),_:1}),t(B,null,{default:e(()=>[t(x,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[s(l(_.$gettext("Service")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[s(l(d.domain.transport.service),1)]),_:1})]),_:1}),f.value?(o(!0),h(T,{key:0},E(f.value.settings,(D,N)=>(o(),m(x,{key:N},{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[s(l(D.label),1)]),_:2},1024),t(c,{cols:"6"},{default:e(()=>[D.type!=="boolean"?(o(),h(T,{key:0},[s(l(v(D.name)),1)],64)):(o(),m(n(fe),{key:1,value:v(D.name),variant:"flat"},null,8,["value"]))]),_:2},1024)]),_:2},1024))),128)):$("",!0)]),_:1})]),_:1})):$("",!0)}},vt={key:1},_t={__name:"DomainView",setup(u){const{$gettext:a}=F(),y=ke(),d=k(null),i=k({}),f=k(null);function v(){U.getDomain(y.params.id).then(w=>{d.value=w.data})}return v(),(w,_)=>d.value?(o(),h("div",vt,[t(de,{flat:""},{default:e(()=>[t(me,null,{default:e(()=>[s(l(n(a)("Domain"))+" "+l(d.value.name)+" ",1),t(V,{color:"primary",icon:"mdi-circle-edit-outline",to:{name:"DomainEdit",params:{id:d.value.pk}}},null,8,["to"]),t(V,{color:"primary",icon:"mdi-reload",onClick:_[0]||(_[0]=b=>v())})]),_:1})]),_:1}),t(Ke,{modelValue:f.value,"onUpdate:modelValue":_[1]||(_[1]=b=>f.value=b),class:"mb-4",color:"primary"},{default:e(()=>[t(te,null,{default:e(()=>[s(l(n(a)("General")),1)]),_:1}),t(te,null,{default:e(()=>[s(l(n(a)("Statistics")),1)]),_:1}),t(te,null,{default:e(()=>[s(l(n(a)("DMARC")),1)]),_:1})]),_:1},8,["modelValue"]),t(Le,{modelValue:f.value,"onUpdate:modelValue":_[3]||(_[3]=b=>f.value=b)},{default:e(()=>[t(le,null,{default:e(()=>[t(x,null,{default:e(()=>[t(c,{cols:"12",md:"6"},{default:e(()=>[t(mt,{domain:d.value},null,8,["domain"]),_[5]||(_[5]=r("div",{class:"mt-4"},null,-1)),d.value.type==="relaydomain"?(o(),h(T,{key:0},[t(ft,{domain:d.value},null,8,["domain"]),_[4]||(_[4]=r("div",{class:"mt-4"},null,-1))],64)):$("",!0),t(_e,{domain:d.value},null,8,["domain"])]),_:1,__:[5]}),t(c,{cols:"12",md:"6"},{default:e(()=>[t(it,{modelValue:d.value,"onUpdate:modelValue":_[2]||(_[2]=b=>d.value=b)},null,8,["modelValue"]),_[6]||(_[6]=r("div",{class:"mt-4"},null,-1)),i.value.params&&i.value.params.enable_domain_limits&&d.value.resources&&d.value.resources.length?(o(),m(Ae,{key:0,resources:d.value.resources},null,8,["resources"])):$("",!0)]),_:1,__:[6]})]),_:1})]),_:1}),t(le,null,{default:e(()=>[t(x,null,{default:e(()=>[t(c,{cols:"12"},{default:e(()=>[d.value.name?(o(),m(se,{key:0,domain:d.value,"graphic-set":"mailtraffic","graphic-name":"averagetraffic"},null,8,["domain"])):$("",!0)]),_:1}),t(c,{cols:"12"},{default:e(()=>[d.value.name?(o(),m(se,{key:0,domain:d.value,"graphic-set":"mailtraffic","graphic-name":"averagetrafficsize"},null,8,["domain"])):$("",!0)]),_:1})]),_:1})]),_:1}),t(le,null,{default:e(()=>[t(qe,{domain:d.value},null,8,["domain"])]),_:1})]),_:1},8,["modelValue"])])):(o(),m(Te,{key:0}))}},tl=ie(_t,[["__scopeId","data-v-628417a7"]]);export{tl as default};
