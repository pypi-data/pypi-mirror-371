import{p as L,b as U,g as u,d as j,c as m,o as i,w as e,a as o,e as O,m as x,t as s,f as c,n as g,l as f,i as D,N as $}from"./index-I1VDlN4g.js";import{d as N}from"./domains-Bgn4ixHL.js";import{c as G,V as H,b as q,a as F}from"./VCard-er_isjE_.js";import{V as J}from"./VDataTableVirtual-BlnO18u_.js";import{V as h,d as b}from"./VAvatar-Lpb-Dion.js";import{V as K}from"./VAutocomplete-C4IpXyl8.js";import{V as P,a as M}from"./VRow-BF35mT1S.js";const Q={class:"headline"},W={key:0,class:"headline"},X={key:1,class:"headline"},Y={key:0},ie={__name:"DomainAdminList",props:{domain:{type:Object,default:()=>{}},dialogMode:{type:Boolean,default:!1}},emits:["close"],setup(v,{emit:R}){const B=L(),{$gettext:t}=U(),p=v,S=R,k=u([]),V=u([]),_=u(""),w=u([{title:t("Username"),value:"username"},{title:t("Name"),value:"name"},{title:"",value:"actions",align:"end",sortable:!1}]),A=u(!1),d=u(null);function E(){V.value.push({}),A.value=!0}function T(){A.value=!1,S("close")}function y(n){N.getDomainAdministrators(n.pk).then(a=>{V.value=a.data})}function C(){const n={role:[D.RESELLER,D.DOMAIN_ADMIN],page_size:50};_.value&&(n.search=_.value),$.getAll(n).then(a=>{k.value=a.data.results.filter(l=>V.value.find(r=>r.id===l.pk)===void 0)})}function z(){N.addDomainAdministrator(p.domain.pk,d.value.pk).then(()=>{y(p.domain),k.value=k.value.filter(n=>n.pk!==d.value.pk),d.value=null,A.value=!1,B.displayNotification({msg:t("Administrator added")})})}function I(n){N.removeDomainAdministrator(p.domain.pk,n.id).then(()=>{y(p.domain),C(),B.displayNotification({msg:t("Administrator removed")})})}return j(()=>{y(p.domain),C()}),(n,a)=>(i(),m(F,null,{default:e(()=>[o(G,null,{default:e(()=>[O("span",Q,[v.dialogMode?(i(),x("div",W,s(c(t)("Administrators of"))+" "+s(v.domain.name),1)):(i(),x("div",X,s(c(t)("Administrators")),1))])]),_:1}),o(H,null,{default:e(()=>[o(J,{headers:w.value,items:V.value},{"item.username":e(({item:l})=>[l.id?(i(),x("span",Y,s(l.username),1)):(i(),m(K,{key:1,modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=r=>d.value=r),search:_.value,"onUpdate:search":[a[1]||(a[1]=r=>_.value=r),C],label:c(t)("Select an account"),items:k.value,variant:"outlined","item-title":"username",class:"mt-5","return-object":""},{append:e(()=>[d.value?(i(),m(h,{key:0,variant:"text",color:"primary",size:"x-large",onClick:z},{default:e(()=>[o(b,null,{default:e(()=>a[2]||(a[2]=[f("mdi-content-save")])),_:1,__:[2]})]),_:1})):g("",!0)]),_:1},8,["modelValue","search","label","items"]))]),"item.name":e(({item:l})=>[f(s(l.first_name)+" "+s(l.last_name),1)]),"item.actions":e(({item:l})=>[l.id?(i(),m(h,{key:0,variant:"text",color:"red",title:c(t)("Remove this administrator"),size:"x-large",onClick:r=>I(l)},{default:e(()=>[o(b,null,{default:e(()=>a[3]||(a[3]=[f("mdi-delete-outline")])),_:1,__:[3]})]),_:2},1032,["title","onClick"])):g("",!0)]),_:2},1032,["headers","items"])]),_:1}),o(q,null,{default:e(()=>[o(P,null,{default:e(()=>[o(M,{align:v.dialogMode?"left":"right"},{default:e(()=>[A.value?g("",!0):(i(),m(h,{key:0,color:"primary",variant:"outlined",onClick:E},{default:e(()=>[o(b,{small:""},{default:e(()=>a[4]||(a[4]=[f("mdi-plus")])),_:1,__:[4]}),f(" "+s(c(t)("Add administrator")),1)]),_:1}))]),_:1},8,["align"]),v.dialogMode?(i(),m(M,{key:0,align:"right"},{default:e(()=>[o(h,{color:"grey darken-1",variant:"text",onClick:T},{default:e(()=>[f(s(c(t)("Close")),1)]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})]),_:1}))}};export{ie as _};
