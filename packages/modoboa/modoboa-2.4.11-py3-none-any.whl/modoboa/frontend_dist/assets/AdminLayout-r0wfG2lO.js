import{_ as D,b as g,u as x,g as m,h as l,i as t,j as p,c as b,o as N}from"./index-I1VDlN4g.js";import{p as _}from"./parameters-A6iBEYQq.js";import{_ as h}from"./ConnectedLayout-1oRW-Rql.js";import{u as L}from"./parameters.store-BiXS4_6w.js";import"./VContainer-DvTbsotR.js";/* empty css              */import"./tag-BnSYRTcD.js";import"./VApp-CpkYA7js.js";import"./layout-D8ZJPiJ_.js";import"./ssrBoot-AzTdjPjk.js";import"./logos-q8SEyAa4.js";import"./global.store-BaiD63EN.js";import"./admin-o-HRGnmT.js";import"./layout.store-DkjrAoXt.js";import"./VAvatar-Lpb-Dion.js";import"./VProgressCircular-w75-3ogi.js";import"./forwardRefs-Dvjn_Xq4.js";import"./VMenu-BPFJwj2f.js";import"./VCard-er_isjE_.js";import"./VRow-BF35mT1S.js";import"./VSheet-Btq_Mu4s.js";const f={getCapabilities(){return D.get("/capabilities/")}},X={__name:"AdminLayout",async setup(P){var u;let a,s;const{$gettext:i}=g(),A=x(),r=L(),n=m(!1),c=m("/rspamd"),d=m([]),M=l(()=>A.authUser),R=l(()=>r.imapMigrationEnabled),I=()=>{window.location=c.value},S=l(()=>{const e=[{text:i("Dashboard"),to:{name:"Dashboard"},exact:!0,icon:"mdi-view-dashboard-outline"},{text:i("Domains"),to:{name:"DomainList"},icon:"mdi-domain",roles:[t.DOMAIN_ADMIN,t.RESELLER,t.SUPER_ADMIN]},{text:i("Identities"),to:{name:"Identities"},icon:"mdi-account",roles:[t.DOMAIN_ADMIN,t.RESELLER,t.SUPER_ADMIN]},{text:i("Alarms"),to:{name:"Alarms"},icon:"mdi-bell"},{icon:"mdi-history",text:i("Monitoring"),roles:[t.SUPER_ADMIN,t.RESELLER,t.DOMAIN_ADMIN],children:[{text:i("Statistics"),to:{name:"Statistics"},roles:[t.SUPER_ADMIN]},{text:i("Audit trail"),to:{name:"AuditTrail"},roles:[t.SUPER_ADMIN]},{text:i("Messages"),to:{name:"MessageLog"},roles:[t.DOMAIN_ADMIN,t.RESELLER,t.SUPER_ADMIN]}]},{icon:"mdi-email-sync-outline",text:i("IMAP Migration"),roles:[t.SUPER_ADMIN,t.RESELLER],condition:()=>R.value,children:[{text:i("Email providers"),to:{name:"ProvidersList"},roles:[t.SUPER_ADMIN,t.RESELLER]},{text:i("Migrations"),to:{name:"MigrationsList"},roles:[t.RESELLER,t.SUPER_ADMIN]}]}],o=[];return d.value.forEach(E=>{o.push({text:E.label,to:{name:"ParametersEdit",params:{app:E.name}}})}),e.concat([{icon:"mdi-cog",text:i("Settings"),children:o,roles:[t.SUPER_ADMIN]},{icon:"mdi-email-check-outline",text:"Rspamd",action:I,roles:[t.SUPER_ADMIN],condition:()=>n.value},{icon:"mdi-information",text:i("Information"),roles:[t.SUPER_ADMIN],to:{name:"Information"},withBell:!0}])});if(M.value.role===t.SUPER_ADMIN){let e=([a,s]=p(()=>_.getGlobalApplications()),a=await a,s(),a);d.value=e.data,e=([a,s]=p(()=>f.getCapabilities()),a=await a,s(),a);const o=(u=e.data)==null?void 0:u.capabilities;o.imap_migration&&r.imapMigrationEnabled===null&&(e=([a,s]=p(()=>_.getGlobalApplication("imap_migration")),a=await a,s(),a),r.imapMigrationEnabled=e.data.params.enabled_imapmigration),n.value="rspamd"in o,n.value&&(c.value=o.rspamd.location||"/rspamd")}return(e,o)=>(N(),b(h,{"menu-items":S.value},null,8,["menu-items"]))}};export{X as default};
