Fundamental theoretical concepts
================================

This section provides the basics and fundamental theory involved in NetSSE, including a brief review of the relevant literature. The text and illustrations are copied and adapted from Mounet [#REGMOPhDhesis]_.

.. _sec_model_ocean_env:

Modelling the ocean wave environment
------------------------------------

    *--- Somewhere in Between Pure Randomness and Physical Determinism.*

Nonlinear dynamical processes govern the generation of real waves through ocean surface stress and their evolution from wind waves to swell. In a wave system generated by wind, like in the oceans, the heights of successive waves vary; the waves are said to be **irregular**. Moreover, the elevation along the crests also varies, hence the **short-crestedness** of real waves. 

When it is sampled over time at a fixed-point location, the surface elevation behaves as a stochastic (or random) process. The exact shape of the ocean surface cannot be forecast with full certainty. Such **aleatory uncertainty** is intrinsic (because it is natural and physical) and cannot be reduced or eliminated [#BitnerGregersen2014a]_ [#BitnerGregersen2014b]_. Nonetheless, it is generally assumed that, over a limited period of time, typically thirty minutes to one hour, and over a restricted portion of space, the surface waves can be described by a stationary and ergodic process called the **sea state**, e.g., Lewis [#Lewis1989]_ (Chapter 8, Section 2). This assumption -- sometimes referred to as the decoupling approach -- means that, at a local scale, it is possible to estimate the short-term statistical properties of the wave process from a single recording of the wave elevation at a point location.

The linear wave theory assumes that the sea surface elevation :math:`\zeta(x_0,y_0,t)` about the mean sea level (:term:`MSL`) is a random linear superposition of a large number of non-interacting regular wave components, all travelling independently of one another in different directions at different frequencies [#StDenis1953]_:

.. math::
    :label: eq_wave_superp

    \zeta(x_0,y_0,t) = \sum_n a_n \sin\left(k_n(x_0\cos\mu_n+y_0\sin\mu_n)-\omega_{0,n}t+\phi_n\right),

where :math:`t` is the time and :math:`(x_0,y_0)` are the spatial coordinates in an Earth-fixed reference system. The wave components are densely distributed in frequency and direction. For the :math:`n`-th component, :math:`a_n` is the amplitude, :math:`\mu_n` is the direction of travel, :math:`\phi_n \in [-\pi,\pi)` is a random phase angle, :math:`\omega_{0,n}` is the angular frequency (:math:`\omega_{0,n} = 2\pi f_{0,n}`) satisfying the dispersion relationship,

.. math::
    :label: eq_disp_rel

    \omega_{0,n}^2 = g k_n \tanh{k_n h},

with :math:`g` the gravitational acceleration, :math:`k_n = 2 \pi / \lambda_n` the wave number, :math:`\lambda_n` the corresponding wavelength, and :math:`h` the water depth, as illustrated in :numref:`fig_wave_sketch`. In deep water conditions (:math:`h \gtrsim \lambda_n/2`), the dispersion relation can be simplified to :math:`\omega_{0,n}^2 = g{k_n}`.

.. _fig_wave_sketch:
.. figure:: ../_static/Wave_sketch.png
    :class: with-border
    :width: 100%
    :align: center

    **Illustration of the basic wave parameters to describe the sea surface elevation in the time domain.**

Since the component sinusoids in Eq. :eq:`eq_wave_superp` have random phases, the total variance :math:`\sigma_\zeta` of the sea surface elevation equals the sum of the variances of its component wave trains [#Tucker2001]_:

.. math::
    :label: eq_wave_variance

    \sigma_\zeta \equiv \mathbb{E}[\zeta^2] = \sum_n \dfrac{a_n^2}{2},

where the dependency on spatial coordinates :math:`(x_0,y_0)` has been dropped to consider the measurement at an arbitrary point and the dependency on time is avoided due to stationarity.

If the output of a wave recorder is filtered to select only those components on the right-hand side of Eq. :eq:`eq_wave_superp` with frequencies in the range :math:`\omega_0-\delta\omega_0/2` to :math:`\omega_0+\delta\omega_0/2`, giving a variance :math:`\delta \sigma`, then a function :math:`E(\omega_0)` can be defined by [#Tucker2001]_:

.. math::
    :label: eq_var_spectrum

    E(\omega_0) \equiv \lim \limits_{\delta\omega_0 \to 0} \dfrac{\delta \sigma}{\delta\omega_0}.

:math:`E(\omega_0)` is a spectral density function and is sometimes called the **wave variance spectrum**, or simply, the wave spectrum.

If one can now filter not only in frequency, but also select those wavetrains whose direction of travel is between :math:`\mu-\delta \mu/2` and :math:`\mu+\delta\mu/2`, giving a variance :math:`\delta \sigma`, then by analogy with Eq. :eq:`eq_var_spectrum`:

.. math::
    :label: eq_DWS

    E(\omega_0,\mu) \equiv \lim \limits_{\delta\omega_0, \delta\mu \to 0} \dfrac{\delta \sigma}{\delta\omega_0 ~\delta \mu} = \dfrac{\text{d}^2 \sigma}{\text{d}\omega_0 ~\text{d}\mu}.

The **directional wave spectrum** (:term:`DWS`) :math:`E(\omega_0,\mu)` characterises how the wave power spectral density (:term:`PSD`) is distributed across frequencies :math:`\omega_0` -- or, equivalently, wave numbers :math:`k` -- and directions of travel :math:`\mu`. With an additional assumption about a Gaussian surface elevation, the DWS fully describes the stochastic properties of linear waves [#Krogstad2010]_.

.. This approach is mostly valid for waves in deep water.

The DWS is the fundamental quantity of wave modelling and the quantity that allows calculating the consequences of interactions between waves and other matter [#Hauser2005]_. Phase-averaged spectral wave models compute the development of the DWS, modelling the growth, transformation, and decay of ocean waves due to nonlinear wave-wave interactions and interactions with ocean surface winds and bathymetry. Rapid phase oscillations are not modelled, but instead, the slow evolution of the energy in each wave component is computed [#Komen1996]_. The **energy balance equation** describes the evolution of the DWS :math:`E(\omega_0,\mu)`:

.. math::
    :label: eq_energy_balance

    \dfrac{\partial E}{\partial t}+\dfrac{\partial}{\partial x_0}(c_{x_0} E)+\dfrac{\partial}{\partial y_0}(c_{y_0} E)+\dfrac{\partial}{\partial \omega_0}(c_{\omega_0} E)+\dfrac{\partial}{\partial \mu}(c_{\mu} E) = S_{\text{tot}},

where :math:`t` is time, :math:`c_{x_0}` and :math:`c_{y_0}` are the propagation velocities in the geographical space :math:`(x_0,y_0)`, while :math:`c_{\omega_0}` and :math:`c_\mu` are the propagation velocities in the spectral space [#Joensen2021]_. Currents are neglected here. The left-hand side describes the propagation through a nonhomogeneous medium (i.e., in variable water depth), which conserves the total wave energy as an adiabatic invariant. The first term represents the local rate of change of energy density in time. The second and third terms describe the geographic propagation of PSD in the :math:`(x_0,y_0)` plane. The fourth term represents the shifting of the frequency due to depth variations, and the fifth term is related to depth-induced refraction with propagation velocity :math:`c_\mu` in the directional :math:`\mu`-space. The right-hand side consists of source terms expressed as:

.. math::
    :label: eq_source_terms

    S_\text{tot} = S_\text{in} + S_\text{ds} + S_\text{bot} + S_\text{surf} + S_\text{nl}.

The source terms describe the wave generation from wind input :math:`S_\text{in}`, the energy sinks -- such as whitecapping dissipation :math:`S_\text{ds}`, bottom friction :math:`S_\text{bot}`, and depth-induced wave breaking :math:`S_\text{surf}` --, and a nonlinear wave-wave interaction term :math:`S_\text{nl}`.

.. Wave diffraction and reflection are not modelled in a phase-averaged wave model.

The **omnidirectional wave spectrum**, or, **point wave spectrum**, to distinguish it from the DWS, can be obtained by integration of the DWS over wave directions,

.. math::
    :label: eq_point_wave_spec

    E(\omega_0) = \int_{-\pi}^{\pi} E(\omega_0,\mu) ~\text{d}\mu.

Reciprocally, the DWS can be decomposed as the product of the point spectrum and a so-called **directional spreading function** (:term:`DSF`) :math:`D(\omega_0,\mu)`,

.. math::
    :label: eq_DWS&DSF

    E(\omega_0,\mu) = E(\omega_0) \cdot D(\omega_0,\mu),

such that :math:`D(\omega_0,\mu)` is positive and the integral over directions :math:`\int_{-\pi}^{\pi} D(\omega_0,\mu) ~\text{d}\mu` equals 1 for any frequency :math:`\omega_0`.

A standard functional form for the DSF was found by Mitsuyasu *et al.* [#Mitsuyasu1975]_:

.. math::
    :label: eq_DSF

    D(\mu|\omega_0) = D_0 \cos^{2s}{\left(\dfrac{\mu-\mu_0}{2}\right)},

where :math:`\mu_0` denotes the principal wave direction at the specific frequency :math:`\omega_0`, :math:`s` is a directional spreading parameter, and :math:`D_0` is a normalising constant introduced to satisfy the requirement on the integral of :math:`D`; i.e.,

.. math::
    :label: eq_D0_def

    D_0 \equiv \left[\int_{\mu_\text{min}}^{\mu_\text{max}}\cos^{2s}{\left(\dfrac{\mu-\mu_0}{2}\right)}\right]^{-1}.

If the widest possible range of directions is considered for the DSF, such that :math:`\mu_\text{min} = -\pi` and :math:`\mu_\text{max} = \pi`, then the constant :math:`D_0` becomes

.. math::
    :label: eq_D0

    D_0 = \dfrac{2^{2s-1}}{\pi} \dfrac{{\Gamma^2(s+1)}}{\Gamma(2s+1)},

where :math:`\Gamma(\cdot)` denotes the Gamma function.

Commonly used sea state parameters are computed from the DWS [#IAHR1989]_ and listed in :numref:`tab_SS_params`. Some of them depend on the :math:`n`-th order spectral moments, which are defined as:

.. math::
    :label: eq_spec_mom

    m_n \equiv \int_0^\infty \omega_0^n ~E(\omega_0) ~\text{d}\omega_0, ~~ n \in \{-1\}\cup\mathbb{N}.

.. _tab_SS_params:
.. table:: Common definitions of the sea state parameters derived from the wave spectrum [#IAHR1989]_.
   :align: center

   +-----------------+------------------------------+---------------------------------------------------------------------------------------------------------+----------+
   | **Symbol**      | **Description**              | **Mathematical definition**                                                                             | **Unit** |
   +=================+==============================+=========================================================================================================+==========+
   | :math:`H_s`     | Significant wave height      | :math:`4 \sqrt{m_0}`                                                                                    | m        |
   +-----------------+------------------------------+---------------------------------------------------------------------------------------------------------+----------+
   | :math:`T_E`     | Mean energy period           | :math:`2\pi (m_{-1}/m_0)`                                                                               | s        |
   +-----------------+------------------------------+---------------------------------------------------------------------------------------------------------+----------+
   | :math:`T_{m01}` | Mean wave period             | :math:`2\pi (m_0/m_1)`                                                                                  | s        |
   +-----------------+------------------------------+---------------------------------------------------------------------------------------------------------+----------+
   | :math:`T_p`     | Peak wave period             | :math:`2\pi/(\text{argmax}_{\omega_0}[E(\omega_0)])`                                                    | s        |
   +-----------------+------------------------------+---------------------------------------------------------------------------------------------------------+----------+
   | :math:`T_{z}`   | Mean zero up-crossing period | :math:`2\pi \sqrt{m_0/m_2}`                                                                             | s        |
   +-----------------+------------------------------+---------------------------------------------------------------------------------------------------------+----------+
   | :math:`\mu_m`   | Overall mean wave direction  | :math:`\arctan(d/c)`                                                                                    | rad      |
   |                 |                              |                                                                                                         |          |
   |                 |                              | with :math:`d=\int_{-\pi}^{\pi} \int_0^\infty E(\omega_0,\mu) \sin(\mu) ~\text{d}\omega_0 ~\text{d}\mu` |          |
   |                 |                              |                                                                                                         |          |
   |                 |                              | and :math:`c=\int_{-\pi}^{\pi} \int_0^\infty E(\omega_0,\mu) \cos(\mu) ~\text{d}\omega_0 ~\text{d}\mu`  |          |
   +-----------------+------------------------------+---------------------------------------------------------------------------------------------------------+----------+
   | :math:`\mu_p`   | Peak wave direction          | :math:`\text{argmax}_\mu[E(\omega_0,\mu)]`                                                              | rad      |
   +-----------------+------------------------------+---------------------------------------------------------------------------------------------------------+----------+


For the purpose of providing a better description of the sea state, the reduced set of sea state parameters from :numref:`tab_SS_params` can be extended with similar parameters characterising each of the few wave systems that compose the DWS. Spectral partitioning methods [#Portilla2009]_ are used in dividing the PSD of the DWS into several clusters centred around common spectral peaks. This approach is particularly useful to analyse multimodal wave spectra involving one or several swell systems, as well as a possible wind sea system. The sea state description results in a list of parameters such as :math:`H_{s,\text{wind}}`, :math:`H_{s,\text{swell1}}`, :math:`H_{s,\text{swell2}}`, ..., :math:`T_{p,\text{wind}}`, :math:`T_{p,\text{swell1}}`, etc.

In many engineering applications, such as the response analysis of marine structures exposed to waves, use of the wave spectrum is required in order to carry on the computations. In those cases, the sea state parameters can be exploited to reconstruct the wave spectrum by applying an adequately chosen parameterised spectrum. There exist several standard forms of wave spectra. The choice of one form is application-specific and made based on the geographical area of study. Among other effects, the water depth, the predominance of wind sea over swell, or the opposite, and the **fetch** -- defined as the length of the body of water that the wind blows over -- should be considered.

For example, the spectra of fully-developed wind waves in the ocean can be approximated by the Pierson and Moskowitz (PM) standard spectrum [#Pierson1964]_, expressed in terms of the wave height and period as:

.. math::
    :label: eq_PM_spec

    E_\text{PM}(\omega_0)=\dfrac{5}{16} ~H_s^2 ~\omega_p^4 ~\omega_0^{-5}\exp\left(-\dfrac{5}{4}\left(\dfrac{\omega_0}{\omega_p}\right)^{-4}\right),

where :math:`\omega_p = 2\pi/T_p` is the angular spectral peak frequency.

Wind waves rapidly developed by a strong wind in a relatively restricted water body (i.e., a fetch-limited situation) usually feature a much sharper spectral peak than that given by Eq. :eq:`eq_PM_spec` [#Goda2010]_. The Joint North Sea Wave Project (:term:`JONSWAP`) [#Hasselmann1973]_ addressed this scenario of a developing sea state in a dedicated observation program, which resulted in the proposal of another spectral form. In its generalised version, the JONSWAP spectrum is formulated as a modification of the PM spectrum:

.. math::
    :label: eq_JONSWAP

    E_\text{J}(\omega_0) = A_\gamma ~E_\text{PM}(\omega_0) ~\gamma^{\exp\left(-0.5\left(\dfrac{\omega_0-\omega_p}{\sigma(\omega_0) ~\omega_p}\right)^2\right)},

where :math:`A_\gamma = 1-0.287 \ln{(\gamma)}` is a normalising factor, :math:`\gamma` is called the **peak enhancement factor** -- which controls the sharpness of the spectral peak -- with a standard value of 3.3, and :math:`\sigma` is a spectral width parameter, taken as

.. math::
    \sigma(\omega_0) = \left\{
    \begin{array}{l}
        \sigma_a \simeq 0.07 ~~\text{ for } \omega_0 \leq \omega_p,\\
        \sigma_b \simeq 0.09 ~~\text{ for } \omega_0 > \omega_p.
    \end{array}
    \right.

For :math:`\gamma = 1`, the JONSWAP spectrum reduces to the PM spectrum.

When the respective heights and periods of the wind sea and swell systems are available, the DWS of the resultant sea state can be estimated by linearly superimposing the parameterised (point) wave spectra computed for each system in combination with a DSF [#Goda2010]_. Yet, such an approach is problematic in certain conditions because the observed DWS may differ significantly from the reconstructed spectrum. Instead, a much better description of the directional spreading in the sea state is accomplished by the Fourier coefficients of the DSF [#Benoit1997]_, defined as:

.. math::
    a_n(\omega_0) &\equiv \int_{-\pi}^\pi D(\omega_0,\mu) \cos(n\mu) ~\text{d}\mu,\\
    b_n(\omega_0) &\equiv  \int_{-\pi}^\pi D(\omega_0,\mu) \sin(n\mu) ~\text{d}\mu.

In the general short-crested case, the DSF is a continuous function of :math:`\mu` over :math:`[0,2\pi]`, satisfying :math:`D(\omega_0,0) = D(\omega_0,2\pi).` It is therefore possible to write its Fourier series decomposition as:

.. math::
    :label: eq_DSF_Fourier

    D(\omega_0,\mu) = \dfrac{1}{2\pi}+\dfrac{1}{\pi}\sum\limits_{n=1}^\infty\{a_n(\omega_0)\cos(n\mu)+b_n(\omega_0)\sin(n\mu)\}.

The so-called "First 5" spectral wave parameters consist of the combination of :math:`E(\omega_0)`, :math:`a_1(\omega_0)`, :math:`b_1(\omega_0)`, :math:`a_2(\omega_0)`, and :math:`b_2(\omega_0)`. This set of parameters contains sufficient information to estimate the DWS with good accuracy.


.. _sec_theo_resp:

Wave-induced response of surface-floating marine vessels
--------------------------------------------------------

    *--- How Waves Set Vessels in Motion.*

In this section, the term "surface-floating marine vessel" is used in a general meaning, including all kinds of man-made floating structures able to be moved forward over the sea surface by means of an onboard propulsion and steering system. This definition therefore encompasses cargo ships, tankers, passenger vessels, research vessels, fishing boats, pleasure crafts, etc., but also even smaller surface vehicles like wave gliders and unmanned surface vehicles (:term:`USV`).

.. _fig_ship_motions:
.. figure:: ../_static/Ship_motions.png
   :scale: 50%
   :align: center

   **The six-DoF rigid-body motions of a vessel**. A body-fixed coordinate system is used, with the :math:`z`-axis pointing towards the bottom of the vessel.

When sea waves encounter a floating vessel, they induce mechanical responses of the structure, such as rigid-body motions in all six degrees of freedom (:term:`DoF`) as depicted in :numref:`fig_ship_motions`, vertical and horizontal bending moments, etc. Sensors placed onboard the vessel facilitate time records of these oscillating responses. The digital signals can be processed in the frequency domain by means of a Fast Fourier Transform (:term:`FFT`) (or similar method), which yields the so-called **measured response spectra** :math:`\tilde S_{RR}` --- in which notation the tilde emphasises that the quantity is derived from measurements. Fluctuations of the ship heading in an Earth-fixed reference system should be small enough over the duration of the time window that is used to compute the response spectra (to ensure stationary conditions). Apart from a dynamic positioning (:term:`DP`) context, this assumption is most of the time valid for a 20-minute time window during transoceanic voyages of large in-service ships (e.g., container ships). In such scenarios, the vessel speed should also vary as little as possible during the time window.

For a vessel sailing at constant forward speed :math:`U` and compass heading (or yaw angle) :math:`\psi`, the wave-induced vessel responses oscillate at a frequency that differs from the (intrinsic) wave frequency due to the **Doppler shift**. The **encounter frequency** :math:`\omega_e = 2\pi f_e` is related to the intrinsic wave frequency as expressed in Eq. :eq:`eq_ome`:

.. math::
   :label: eq_ome

   \omega_e = \left|\omega_0 - \omega_0^2 \tau \right|,

where :math:`\tau = \frac{U}{g} \cos\beta` can be interpreted as the Doppler shift's intensity and :math:`\beta` is the direction of wave encounter relative to the vessel's centreline in a  North-East-Down (:term:`NED`) reference frame. If :math:`\mu` is defined as the direction where the waves are **travelling from** (nautical convention), e.g., relative to the geographical North, then :math:`\beta` is related to :math:`\mu` by the expression:

.. math::
   :label: eq_beta

   \beta = \pi + \mu - \psi.

.. dropdown:: Visualise the Doppler shift
   :icon: telescope

   .. raw:: html

        <embed>
            <iframe scrolling="no" title="Mapping encounter / intrinsic wave frequency" src="https://www.geogebra.org/material/iframe/id/cnsf7r3y/width/800/height/345/border/888888/sfsb/true/smb/false/stb/false/stbh/false/ai/false/asb/false/sri/true/rc/false/ld/false/sdz/false/ctl/false" allowfullscreen width="800px" height="345px" style="border:0px;"> </iframe>
        </embed>

   This online tool was created to visualise the effect of the Doppler shift in wave frequencies for a user-defined vessel speed and wave encounter angle. The right-hand side illustrates the mapping between intrinsic wave frequencies (:math:`x`-axis) and encounter frequencies (:math:`y`-axis) when waves are observed from a ship with forward speed :math:`U` at an encounter angle :math:`\beta`. The parameters are user-defined on the left-hand side of the panel.

Considering a given encounter frequency, the mapping of Eq. :eq:`eq_ome` can result in **up to three** distinct intrinsic frequencies denoted :math:`\omega_{0,1}`, :math:`\omega_{0,2}`, and :math:`\omega_{0,3}`, i.e., three different wave frequencies that will excite the vessel responses at the same excitation frequency :math:`\omega_e`. The triple-value feature of the Doppler shift results in complications when transforming spectra between encounter and intrinsic frequency domains. The energy is conserved in the wave spectra when transforming from intrinsic frequency to encounter frequency domain, and vice-versa. The **encounter-domain wave spectrum** :math:`E_e` is therefore defined as:

.. math::
   :label: eq_Ee

   E_e(\omega_e,\beta) = \left\langle E(\omega_0,\beta) \dfrac{\text{d}\omega_0}{\text{d}\omega_e} \right\rangle_{\omega_e},

where the notation :math:`\langle\cdot\rangle_{\omega_e}` indicates that the calculations are performed for a given encounter frequency :math:`\omega_e`. In particular, this entails that, for the specified heading :math:`\beta` -- and implicitly, for the considered vessel speed :math:`U` -- the right-hand side of Eq. :eq:`eq_Ee` is actually the sum of up to three terms, involving each of the intrinsic frequencies :math:`\omega_0` associated to the particular :math:`\omega_e`.

In NetSSE, all methods rely on the assumption that the ship acts as a linear time-invariant (LTI) wave filter, which is most often valid for analysing rigid-body motions in mild to moderate sea states. This means that the mathematical relationship between the ship response and the encountered waves is linear, which in the frequency domain involves first-order wave-to-response **transfer functions**. For a specific response component :math:`R`, the transfer function denoted :math:`\Phi_R = \Phi_R(\omega_e,\beta)` is complex-valued and is a function of the wave frequency and encounter angle. The transfer function depends on the geometry of the submerged part of the hull, the loading condition (draught, inertia distribution, etc.), and the vessel speed. In general, potential flow theory is used to calculate the transfer functions, relying on 3D panel codes, strip theory [#Salvesen1971]_, or semi-empirical closed-form expressions (:term:`CFE`). When viscous effects are important (e.g., in the presence of boundary layer separation on sharp edges), then potential flow theory becomes insufficient and Computational Fluid Dynamics (:term:`CFD`) may need to be used.

Prior knowledge of the DWS allows the theoretical computation of an estimate of the cross-spectral density function :math:`\tilde S_{RR'}(\omega_e)` between a pair of responses :math:`R` and :math:`R'`. In the most general case of an advancing ship in propagating short-crested waves, the **response cross-spectrum** is estimated by:

.. math::
   :label: eq_est_resp_spec_SC

   \hat S_{RR'}(\omega_e) = \int_{-\pi}^{\pi}\Phi_R(\omega_e,\beta)~\overline{\Phi_{R'}(\omega_e,\beta)}~E_e(\omega_e,\beta)~\text{d}\beta,

where the overline ( :math:`\bar\cdot` ) denotes the complex conjugate. For a station-kept vessel (i.e., with zero forward speed), :math:`\omega_e` can be substituted with the intrinsic frequency :math:`\omega_0` in Eq. :eq:`eq_est_resp_spec_SC`, since the two quantities become equivalent in Eq. :eq:`eq_ome` when :math:`U = 0`.

The auto-spectral density function :math:`S_{RR}(\omega_e)` for a single response :math:`R` can be estimated through the same Eq. :eq:`eq_est_resp_spec_SC`. The product of transfer functions may be rewritten as the squared modulus (or, amplitude) :math:`|\Phi_R(\omega_e,\beta)|^2`, which, in maritime engineering, is commonly called **Response Amplitude Operator** (:term:`RAO`).

In the case of long-crested waves encountering the ship with an angle :math:`\beta_0`, the integration over wave directions is no longer relevant and the dependency on wave direction becomes implicit in Eq. :eq:`eq_est_resp_spec_SC`, thus becoming:

.. math::
   :label: eq_est_resp_spec_LC

   \hat S_{RR'}(\omega_e) = \Phi_R(\omega_e;\beta_0)~\overline{\Phi_{R'}(\omega_e;\beta_0)}~E_e(\omega_e).


Inverse methods for sea state estimation from vessel measurements
-----------------------------------------------------------------

    *--- When the Devil Hides in the Details.*

This section is a summary of existing inverse methods to derive sea state estimates from information on the wave-induced responses of in-situ floating platforms.

In the special case of buoy measurements, the translational and angular motions, resulting from waves, are the basis for an estimate of the DWS describing the onsite sea state. Due to the simple geometry of the buoy, the motion cross-spectra are related by simple algebraic expressions to the first five spectral wave parameters :math:`E(\omega_0)`, :math:`a_1(\omega_0)`, :math:`b_1(\omega_0)`, :math:`a_2(\omega_0)`, and :math:`b_2(\omega_0)`, all defined earlier in :numref:`sec_model_ocean_env`. These formulas are commonly found in the literature for various types of single-point measuring devices (heave-roll-pitch buoys, particle-following buoys, GPS buoys, clover-leaf buoys, etc.); see, e.g., Benoit *et al.* [#Benoit1997]_ and Tucker and Pitt [#Tucker2001]_. A number of methods have been developed to estimate the full DWS from the information of the first five spectral wave parameters or from equivalent parameters. The most widely used are Fourier series decomposition methods, parametric methods [#LonguetHiggins1963]_, maximum likelihood methods [#Benoit1997]_, maximum entropy methods [#Kobune1986]_ [#Lygre1986]_, and Bayesian directional methods [#Hashimoto1987]_.

Marine vessels have a more complicated geometric shape compared to wave buoys, which introduces further complexities and uncertainties in the mathematical relationship between the waves and the induced vessel responses. As such, the same standard methods to analyse measurements from wave buoys cannot directly be applied for sea state estimation (:term:`SSE`) from records of vessel responses. Physics-based frequency-domain approaches of the wave buoy analogy (:term:`WBA`) involve the use of transfer functions to provide estimates of the complete directional wave spectrum based on ship response measurements. The main mathematical task of the wave estimation problem is to equate the theoretically estimated response spectrum :math:`\hat S_{RR'}(\omega_e)` of Eq. :eq:`eq_est_resp_spec_SC` with the measured one :math:`\tilde S_{RR'}(\omega_e)`. Different strategies are applied to solve the highly under-determined equation system describing the physical relationship between the PSD of waves and corresponding responses. In general, frequency-domain methods can be classified into two types: on one hand, the **parametric methods** which assume the wave spectrum to be composed of a linear combination of parameterised wave spectra, e.g., Montazeri *et al.* [#Montazeri2016a]_ [#Montazeri2016b]_ and Zago *et al.* [#Zago2023]_, and, on the other hand, the **non-parametric methods** where the values of the wave spectrum are recovered in a completely discretised frequency-directional domain without prior assumption of a spectrum model, e.g., Iseki and Ohtsu [#Iseki2000]_, Tannuri *et al.* [#Tannuri2003]_, Nielsen [#Nielsen2006]_, Nielsen and Dietz [#Nielsen2020]_, Brodtkorb and Nielsen [#Brodtkorb2023]_, Kubo *et al.* [#Kubo2023]_. These methods produce reasonable results in fair agreement with those of real ("classic") wave buoys. Some methods are not limited to an analysis of the rigid-body motions only; for instance, Chen *et al.* [#Chen2020]_ [#Chen2021a]_ used several sensors measuring the hull stresses on container ships with advance speed to estimate the on-site directional wave spectra, with good accuracy results.

The procedure for these inverse methods is however far from straightforward and a number of technical complications are not entirely solved yet. In particular, the larger size (length, breadth, draught) of a ship compared to a wave buoy results in that the ship does not respond much to high encountered wave frequencies, commonly formulated as the **low-pass filter** characteristic. This is an issue for the estimation of the higher frequency part of the wave spectrum. Moreover, for an advancing vessel with non-zero forward speed, the Doppler shift distorts the wave spectrum in a body-fixed reference system. The transformation of the encounter wave spectrum back to the intrinsic frequency domain in an Earth-fixed reference frame does not have a unique solution in following seas; this is because of the triple-value problem, as was mentioned in :numref:`sec_theo_resp`, which eventually represents a loss of (wave) information and introduces uncertainties in the estimated spectrum.

The dependency on accurate transfer functions for the studied vessel has several disadvantages in model-based methods; one disadvantage is that transfer functions obtained through physical models have inherent uncertainties when evaluated in actual conditions. In contrast, purely data-driven approaches exist, relying on artificial intelligence (:term:`AI`), i.e., machine learning (:term:`ML`) and deep learning principles in SSE computations. The non-explicit relationship between sea state parameters and several features of the wave-induced responses of a particular ship is learned by comprehensive training with a large dataset of measured responses against available sea state information. The main advantages of those model-free methods are that the relationship between waves and ship motions is not assumed to be linear and the effects of uncertainties in the transfer functions are completely avoided in the estimates. On the one hand, **artificial neural networks** (:term:`ANN`) have shown auspicious results in estimating the sea state based on records of the ship responses, e.g., Duz *et al.* [#Duz2021]_, Kawai *et al.* [#Kawai2021]_, Mittendorf *et al.* [#Mittendorf2022]_, Cheng *et al.* [#Cheng2022]_, Nielsen *et al.* [#Nielsen2024]_. On the other hand, the need for collecting a large number of high-quality sensor measurements is emphasised in order to constitute the training set for a single ship. And so is the importance of having accurate ("external") data used during the training phase as a proxy for the ground true wave parameters at the exact spatiotemporal position of the ship. Moreover, there is no guarantee that the model is able to capture the physical properties of sea states that were not sufficiently represented in the training dataset, or in new operational conditions (e.g., considering the speed and loading setup).

Another noteworthy point is that ANN models are usually described as black-box models, since it is not possible to interpret the thousands of computations that are made in hidden layers, especially as they are devoid of any physical foundation. An ANN model built to solve a specific task cannot always be directly reused or adapted to solve a similar task. As an example, imagine a scenario where two ships are deployed in an offshore location to carry out an operation at sea. Both ships are equipped with a wave sensor that derives an estimate of the wave spectrum by resorting to a deep learning model. The training has been performed independently for each ship. Consider that an estimate of the DWS is derived by each of the two sensors. An issue would arise if the estimates end up being substantially different. Of course, if the transfer functions of the vessels are known, one could try to compare estimates of the response spectra via Eq. :eq:`eq_est_resp_spec_SC` using one or the other DWS, which would enable checking the quality of the wave estimate from both ships. If the transfer functions are completely unknown, then this "easy" check (allowed by physical principles) is not possible, and one would instead need to train a different (essentially reversed) ANN model in order to estimate responses from the given information of a DWS. Hybrid methods, combining physics-based methods of the WBA and ML-based methods, have emerged, leveraging the advantages and minimising the cons of both classes of methods [#Han2022]_ [#Nielsen2023a]_ [#Nielsen2023b]_. The ML-informed physics-based method proposed by Nielsen *et al.* [#Nielsen2023a]_ [#Nielsen2023b]_ showed particularly promising results.

A specific disadvantage of the frequency-domain approaches is the requirement for stationary conditions, as well as the difficulty of producing real-time estimates, because of the need for backdated data over a certain time window to compute response spectra. Newer studies have worked on time-domain formulations. Some methods rely on Kalman filtering to estimate the directional wave spectrum, e.g., Pascoal and Guedes Soares [#Pascoal2009]_, Pascoal *et al.* [#Pascoal2017]_. Dallolio *et al.* [#Dallolio2021]_ employed a nonlinear second-order observer to estimate the wave encounter frequency from the heave motion of a wave-propelled unmanned surface vehicle. Dirdal *et al.* [#Dirdal2022]_ proposed a phase-time-path difference model using a shipboard array of :term:`IMU` sensors for online estimation of the wave direction and wavenumber. So far, the literature contains only a few methods developed to reconstruct wave profiles from measured response signals in real time. Akinturk *et al.* [#Akinturk2021]_ have studied the identification of wave profiles using ANN. The machine learning method can train models that estimate the neighbouring wave field and predict the relative wave heading without knowledge of ship response characteristics. However, training data is needed to build the estimation model, and the difficulty lies in collecting a sufficient amount of training data. Takami *et al.* [#Takami2023]_ [#Takami2022]_ presented a new approach to estimate the encountered sea surface elevation sequences based on short-time sequences of wave-induced vessel response measurements, by assuming that the response can be represented as a superposition of Prolate Spheroidal Wave Functions. Komoriyama *et al.* [#Komoriyama2023]_ developed a Kalman filter for identifying wave profiles encountered by a ship with no forward speed.

.. Real-time wave estimation and prediction methods using vessel motions can be employed for several applications requiring real-time data, such as control and decision support systems for vessel operations, in which adaptation of the algorithm parameters according to the current sea state is needed. In general, DP systems do not use phase information about waves since the position of the vessel is not controlled against the wave-frequency motions, but instead, only against the low-frequency motions. Traditionally, DP systems have pre-tuned gain settings for low, medium, and high sea states to be selected by the shipmaster. It is only in special cases that time-domain waves and short-term wave-induced response prediction are important; namely, in cases where the wave-frequency motion of the vessel is a concern, for instance, in launch and recovery operations. In this case, the WBA can also be complemented with shipborne wave radars, bow-mounted altimeters, and other remote optical measurements for near-field wave estimation [Kim2023], in possible combination with approaches for deterministic response prediction [Sclavounos2018]. Interestingly, some new methods for real-time response prediction do not take any input information from the waves and work directly with the measured responses [e.g., Takami2021, Deng2021].


.. .. _sec_Tuning_RAO:

.. Data-driven system identification to estimate vessel hydrodynamic models
.. ------------------------------------------------------------------------

..     *--- Thinking Outside the Box?*

.. It is assumed that first-order wave-to-response transfer functions have been computed for a specific vessel in predefined operational conditions, with the purpose of applying one of the several model-based WBA methods to estimate the on-site sea state. Whether this *estimate* (the term will be justified shortly) of the vessel hydrodynamic model was produced by means of a strip theory solver, or any other software, does not matter here. The computation of transfer functions relies on physical models, which imply a number of assumptions --- often, potential flow, linearity of vessel response, small wave steepness, etc. These assumptions may or may *not* reasonably hold in the experienced conditions. For example, in the case of fully multidirectional seas, the linearity of vessel responses is questionable. Moreover, numerical interpolation between *precomputed* transfer functions can be necessary, so that they match the actual operations in study (e.g., speed and heading), which comes with unavoidable losses in accuracy. Therefore, transfer functions obtained through physical models have inherent uncertainties when evaluated in actual conditions, regardless of possible numerical errors and other implementation flaws that may be specific to the used solver.

.. Even if precomputed transfer functions can only provide an incomplete description of the vessel's behaviour in a seaway, it must be stressed that these transfer functions are very useful. In fact, they are crucial in many kinds of seakeeping computations and the like, at least at a starting point; this is because, contrary to :abbr:`ML (Machine Learning)` models, these functions have a physical sense and therefore come with a certain level of robustness. Nevertheless, they should be upgraded from time to time to respond to operational changes (e.g., change of draught, speed, etc.) occurring on a daily or weekly basis, at the unavoidable risk of, otherwise, becoming highly inaccurate and, after some time, obsolete. In order to make these updates, estimates from model-based methods can be integrated into data-driven procedures, which can efficiently complete the hydrodynamic models with up-to-date information. Data-driven estimation has a lot of merits in (near) real-time applications, where timely updates of the vessel hydrodynamic model can be obtained to suit the evolution of the operational conditions. This makes up the topic of papers :JPnobrack:`1`, :JPnobrack:`4`, and :CPnobrack:`1`.

.. Why is all this relevant for network-based SSE? As was mentioned in the previous chapter, in :numref:`sec:ocean_uncert`, inaccuracies of transfer functions represent a major source of uncertainty in sea state estimates from the model-based WBA. Therefore, enhancing the fidelity of the vessel hydrodynamic model plays an essential role in improving the quality of sea state estimates. There are several other reasons that justify the need for data-driven approaches to estimate hydrodynamic models. Computer programs developed to solve seakeeping problems -- for instance, the estimation of vessel transfer functions -- require a number of user-specified input quantities for successful execution, such as a description of the mass distribution, the detailed hull geometry, and operational conditions, including vessel speed, loading condition, and heading. Parts of this information might simply be unavailable to the ship operators, or their knowledge may be approximate with respect to the exact operation. This makes it particularly difficult to compute high-fidelity transfer functions for the specific operational scenario. In addition, depending on the type of model and solver used, the long execution times and extensive computing resources required to obtain one estimate of the transfer functions may impede frequent updates, albeit needed to quickly respond to changes in any of the above-listed quantities and ensure the accuracy of the transfer functions at all times. Considering the problem of SSE from a network of vessels, it is vital to be able to readily acquire cost-efficient and up-to-date estimates of the vessel transfer functions, maybe even in an automated manner. Indeed, new ships may sporadically enter the monitored area, while some others will be moving to neighbouring areas. High-fidelity computation of the transfer functions based on the exact knowledge of the ship geometry is not relevant in such an endeavour, where responsiveness and scalability are key qualities.

.. The present thesis proposes two different data-driven solutions to this problem. The one, which is presented in paper \JPnobrack{1}, assumes that an initial estimate of the transfer functions is already available and updates of the transfer function are performed through a \textit{tuning} method. The other solution, developed in papers \CPnobrack{1} and \JPnobrack{4}, does not rely on an initial guess, and instead, estimates the RAOs ``from scratch'' through a \textit{parametric calibration} (or, fitting) approach. 

.. The tuning procedure of paper \JPnobrack{1} requires three input quantities: (1) a record of measured ship motions during operations in a seaway -- using, for instance, an IMU -- from which a Fourier transform yields the (measured) response spectra $\tilde S_{RR}(\omega_e)$; (2) an estimate of the DWS $E(\omega_0,\mu)$ for the encountered seaway; and (3) as already mentioned, an initial estimate of the transfer functions $\Phi_{R,0}(\omega_e,\beta)$. A tuned estimate of the transfer function for a response $R$ being considered is expressed as:
.. \begin{equation}
..     \hat \Phi_R(\omega_0,\beta) = \Phi_{R,0}(\omega_0,\beta)(1+\alpha_R(\omega_0,\beta))
..     \label{eq:tuned_RAO}
.. \end{equation}
.. where $\alpha_R(\omega_0,\beta)$ is a tuning coefficient which is an explicit function of the wave frequency and encounter angle and is implicitly dependent on the operational conditions.

.. Using an appropriate discretisation of the frequency-direction space, the tuning coefficients $\alpha_R$ are sought to minimise the spectral gap between the measured response spectrum $\tilde S_{RR}(\omega_e)$ and the theoretical spectrum $\hat S_{RR}(\omega_e)$ estimated via \cref{eq:est_resp_spec_SC}, in which the tuned version of the transfer functions from \cref{eq:tuned_RAO} is injected. In the general case with non-zero forward speed, the minimisation problem can be summarised as:
.. \begin{equation}
..     \min_{\alpha_R} \sum_{j=1}^J \left|\tilde S_{RR}(\omega_{e,j})-\hat S_{RR}(\omega_{e,j};\alpha_R)\right|^2
..     \label{eq:tuning_pb}
.. \end{equation}
.. where the interval of encounter frequencies is discretised as $\{\omega_{e,1},\omega_{e,2},...,\omega_{e,J}\}$.

.. This problem is nonlinear -- due to the Doppler shift in encountered wave frequencies -- and highly underdetermined, considering the number of unknown tuning coefficients to be found in the discretised frequency-direction space for each response. In paper \JPnobrack{1}, a gradient-based (quasi-Newton) method was used to solve the optimisation problem. Since it is not guaranteed that the problem is convex, the solver execution does not necessarily converge towards the global optimum, and may instead return a solution ``trapped'' in the vicinity of a local optimum, depending on the initial guess. To mitigate this effect, it is proposed to compute a mean tuning coefficient $\bar \alpha_R(\omega_0,\beta)$ as a simple average over a set of sample-specific parameters:
.. \begin{equation}
..     \bar \alpha_R(\omega_0,\beta) = \dfrac{1}{N} \sum_{n=1}^N \alpha_R(\omega_0,\beta)\{n\}
..     \label{eq:mean_tuning_coef}
.. \end{equation}
.. where $\alpha_R(\omega_0,\beta)\{n\}$ is the tuning coefficient for a specific sample $n$ representing a short portion of the voyage duration (a 30-minute sample duration was chosen in the paper). $N$ is the number of samples considered for the average.

.. The other RAO-estimation method was initially proposed in paper \CPnobrack{1}, then further developed in Nielsen *et al.* \cite{Nielsen2022} and paper \JPnobrack{4}. Paper \CPnobrack{1}, which was presented in the hydrodynamics session of the seventh World Maritime Technology Conference (WMTC 2022), takes the following assumption: the hydrodynamic behaviour of a ship in waves can be approximated by that of a uniformly loaded box-shaped floating vessel with \textit{adequately chosen} dimensions (length, breadth, and draught). The concept is illustrated in \cref{fig:WMTC_illustr}. Closed-form expressions (\acrshort{cfe}s) were derived by Jensen *et al.* \cite{Jensen2004a} for the RAOs of uncoupled heave, roll, and pitch motions, assuming a simplified hull geometry. These expressions represent an inexpensive and practical model (yet, a low-fidelity one). The formulas, which are reproduced in a concise way in paper \JPnobrack{4}, require only a small amount of information about the ship, namely for heave and pitch motions, limited to the main dimensions ($L$, $B$, $T$, $C_B$), the vessel speed, and the heading. One can reasonably assume that this basic information is immediately available to most ship operators. The CFEs are evaluated in a fraction of a second, e.g., using a spreadsheet. In the following, they are referred to as \textit{parameterised RAOs} (p-RAOs).

.. \begin{figure}[htb!]
..     \centering
..     \includegraphics[scale=0.56]{Figures/In_Chapter03/WMTC_figure.pdf}
..     \caption[Illustration of the RAO-calibration approach proposed in paper \CPnobrack{1}.]{\textbf{Illustration of the RAO-calibration approach proposed in paper \CPnobrack{1}.} The linear vessel model $\hat \Phi_{R,\text{CFE}}$ consists of parameterised RAOs describing the hydrodynamic behaviour of a box-shaped vessel with length $L$, breadth $B$, draught $T$, and block coefficient $C_B$ (not represented), advancing at a forward speed $U$. The vector $\pmb \alpha$ gathers the model parameters. The photograph at the centre of the diagram shows the NTNU-owned research vessel, Gunnerus.}
..     \label{fig:WMTC_illustr}
.. \end{figure}

.. The term ``adequately chosen dimensions'' in the above is where important efforts are made because, as the paper shows, taking the vessel's nominal dimensions for values of the p-RAO parameters does not yield the best-performing box model. The p-RAO parameters are gathered in a vector $\pmb{\alpha}$. The calibration is made in paper \CPnobrack{1} by seeking values of $\pmb{\alpha}$ that minimise the following cost function:
.. \begin{equation}
..     f(\pmb\alpha) = \sum_R \int_0^\infty \left[\dfrac{\tilde S_{RR}(\omega_e) - \hat S_{RR}(\omega_e;\pmb \alpha,\beta,U)}{\tilde m_{0,R}}\right]^2\text{d}\omega_e
..     \label{eq:cost_func_WMTC}
.. \end{equation}
.. where $\tilde m_{0,R}$ is the variance of measured response $R$, which acts as a normalising constant for the given response. Some bound-constraints are imposed on the calibration parameters to avoid them taking nonphysical values. In paper \CPnobrack{1}, the minimisation problem is solved in several long-crested wave scenarios by means of a gradient-based method. A comparison of the estimated RAOs is made before and after calibration of the fitting parameters, the nominal values being set to the actual vessel dimensions. The case study consists of response simulations for the heave and pitch motions of the NTNU-owned Gunnerus research vessel and a containership. The results show a significantly improved prediction of the responses after calibration.

.. \cref{eq:cost_func_WMTC} has similarities with the cost function of \cref{eq:tuning_pb} in the tuning method, realising that in both problems the spectral gap between response measurements and estimations needs to be minimised. Besides the optimisation variables having very different effects on the estimated RAOs in both cases, the most important difference is that, contrary to the tuning case, the vector $\pmb \alpha$ is not response-specific in the parametric calibration approach, and the minimisation applies to several responses simultaneously, hence the summation over $R$ in \cref{eq:cost_func_WMTC}. Together with the fact that only a handful of parameters suffice to define the p-RAOs, this makes the parametric calibration more computationally efficient than the tuning method.

.. Paper \JPnobrack{4} further develops the calibration method, building up from the study by Nielsen *et al.* \cite{Nielsen2022}. Small modifications are made in the methodology, especially in the cost function of \cref{eq:cost_func_WMTC}, where it was realised that taking the square is not strictly needed and could be replaced by an absolute value:
.. \begin{equation}
..     f(\pmb\alpha) = \sum_R \dfrac{1}{\tilde m_{0,R}} \int_0^\infty \left| \tilde S_{RR}(\omega_e) - \hat S_{RR}(\omega_e;\pmb \alpha)\right|\text{d}\omega_e
..     \label{eq:cost_func_AutoNaut}
.. \end{equation}

.. \begin{figure}[htb!]
..     \centering
..     \includegraphics[scale=0.85]{Figures/In_Chapter03/error_respsec_GA_tuning_results.pdf}
..     \caption[Time series of the normalised error of predicted response spectra with respect to measurements in paper \JPnobrack{4}.]{\textbf{Time series of the normalised error of predicted response spectra with respect to measurements in paper \JPnobrack{4}.} The black curves show the resulting error when the segment-specific calibrated p-RAOs are used in the spectral calculations. For the red and blue curves, the averaged p-RAOs are used applying a simple mean of the segment-specific parameters and a weighted average, respectively. Only valid segments -- i.e., featuring stationary conditions -- are considered here (324 segments, worth approximately 14 minutes each). Top panel: vertical motion at the IMU position; Middle: roll motion; Bottom: pitch motion.}
..     \label{fig:norm_error_respspec}
.. \end{figure}

.. The parameter vector $\alpha$ is extended to include parameters that allow the estimation of the RAOs of heave, roll, and pitch simultaneously. The problem is solved in short-crested waves using a genetic algorithm, which is supposed to be better suited for constrained non-convex optimisation. Moreover, outlier solutions are discarded through weight-averaging the sample-specific parameters, which yields an increased model precision and robustness. In concrete terms, the model performance is evaluated by analysing and interpreting the discrepancies between predicted and measured responses. The time series of the (normalised) error is shown in Fig. \ref{fig:norm_error_respspec}. The error results of the segment-specific p-RAOs feature some spikes, which lie well above the error levels of the averaging methods (simple mean and weighted average). The weighted-average method is effective in disregarding outlier solutions and, overall, yields the most stable error levels, especially considering the roll and pitch motions.

.. A disadvantage of the parametric calibration approach is that the p-RAOs can only take the shapes accessible via the CFEs, i.e., shapes that are attained by adjusting the values in the set of input parameters. In comparison, the tuning method is non-parametric and therefore any RAO shape could theoretically be reached, although this is moderated in case of possible bound-constraints on the tuning coefficients. On the other hand, nothing guarantees that the tuned RAOs maintain a physical shape; as such, nonphysical behaviours characterised by ``spiky'' shapes have been observed in paper \JPnobrack{2}, which also employed the same tuning method. An example plot is reproduced in \cref{fig:Heave_RAO_PSVH}, where the nonphysical spikes are particularly visible in heave.

.. \begin{figure}[htb!]
..     \centering
..     \begin{subfigure}[b]{0.49\textwidth}
..         \centering
..         \includegraphics[trim={0 0 7.7cm 10cm},clip,scale=0.9]{Figures/In_Chapter03/D_RAO_amp_U0_with_tuning_iter0.pdf}
..         \caption{Heave amplitude [m/m]}
..     \end{subfigure}
..     \begin{subfigure}[b]{0.49\textwidth}
..         \centering
..         \includegraphics[trim={7.7cm 0 0 10cm},clip,scale=0.9]{Figures/In_Chapter03/D_RAO_amp_U0_with_tuning_iter0.pdf}
..         \caption{Pitch amplitude [rad/m]}
..     \end{subfigure}    
..     \caption[RAOs of the PSVH ship studied in case study 2 (scenario D) of paper \JPnobrack{2}]{\textbf{RAOs of the PSVH ship studied in case study 2 (scenario D) of paper \JPnobrack{2}}. The solid lines represent the theoretical RAOs obtained from a linear potential flow theory-based panel code (WAMIT), the dashed lines correspond to the closed form (CFE) solutions \cite{Jensen2004a}, and the black dotted lines are the tuned RAO estimates obtained after applying the tuning method of paper \JPnobrack{1}.}
..     \label{fig:Heave_RAO_PSVH}
.. \end{figure}


.. rubric:: References

.. [#Akinturk2021] Akinturk, A., Zaman, H., Seo, D. C., He, M., and Mak, L. Estimates of wave field in the vicinity of a floating body using its motions and machine learning techniques. In *Oceans Conference Record (IEEE)* (2021), vol. 2021, Institute of Electrical and Electronics Engineers Inc., pp. 111.

.. [#Benoit1997] Benoit, M., Frigaard, P., and Schffer, H. A. Analysing multidirectional wave spectra: A tentative classification of available methods. In *Proceedings of the 27th IAHR Congress, San Francisco, CA, USA* (1997), E. Mansard, Ed., Canadian Government Publishing, pp. 131158.

.. [#BitnerGregersen2014a] Bitner-Gregersen, E. M., Bhattacharya, S. K., Chatjigeorgiou, I. K., Eames, I., Ellermann, K., Ewans, K., Hermanski, G., Johnson, M. C., Ma, N., Maisondieu, C., Nilva, A., Rychlik, I., and Waseda, T. Recent developments of ocean environmental description with focus on uncertainties. *Ocean Engineering 86* (2014), 2646.

.. [#BitnerGregersen2014b] Bitner-Gregersen, E. M., Ewans, K. C., and Johnson, M. C. Some uncertainties associated with wind and wave description and their importance for engineering applications. *Ocean Engineering 86* (2014), 1125.

.. [#Brodtkorb2023] Brodtkorb, A. H., and Nielsen, U. D. Automatic sea state estimation with online trust measure based on ship response measurements. *Control Engineering Practice 130* (2023), 105375.

.. [#Chen2020] Chen, X., Okada, T., Kawamura, Y., and Mitsuyuki, T. Estimation of on-site directional wave spectra using measured hull stresses on 14,000 TEU large container ships. *Journal of Marine Science and Technology (Japan) 25*, 3 (2020), 690706.

.. [#Chen2021a] Chen, X., Okada, T., Kawamura, Y., and Mitsuyuki, T. Estimation of directional wave spectra and hull structural responses based on measured hull data on 14,000 TEU large container ships. *Marine Structures 80* (2021), 103087.

.. [#Cheng2022] Cheng, X., Li, G., Han, P., Skulstad, R., Chen, S., and Zhang, H. Data-driven modeling for transferable sea state estimation between marine systems. *IEEE Transactions on Intelligent Transportation Systems 23*, 3 (2022), 25612571.

.. [#Dallolio2021] Dallolio, A., Alfredsen, J. A., Fossen, T. I., and Johansen, T. A. Experimental validation of a nonlinear wave encounter frequency estimator onboard a wave-propelled USV. *IFAC-PapersOnLine 54*, 16 (2021), 188194.

.. [#Dirdal2022]  Dirdal, J. A., Skjetne, R., Roh, J., and Fossen, T. I. Online wave direction and wave number estimation from surface vessel motions using distributed inertial measurement arrays and phase-time-path-differences. *Ocean Engineering 249* (2022), 110760.

.. [#Duz2021]  Duz, B., Mak, B., Hageman, R., and Grasso, N. Real time estimation of local wave characteristics from ship motions using artificial neural networks. In *Practical Design of Ships and Other Floating Structures*, T. Okada, K. Suzuki, and Y. Kawamura, Eds., vol. 65 of *Lecture Notes in Civil Engineering*. Springer Singapore, 2021, pp. 657678.

.. [#Goda2010] Goda, Y. *Random seas and design of maritime structures*, 3 ed., vol. 33 of *Advanced Series on Ocean Engineering*. World Scientific Publishing Co. Pte. Ltd., 2010.

.. [#Han2022] Han, P., Li, G., Cheng, X., Skjong, S., and Zhang, H. An uncertainty-aware hybrid approach for sea state estimation using ship motion responses. *IEEE Transactions on Industrial Informatics 18*, 2 (2022), 891900.

.. [#Hashimoto1987] Hashimoto, N., Kobune, K., and Kameyama, Y. Estimation of directional spectrum using the Bayesian approach and its application to field data analysis. *Rep. Port Harbor Res. Inst., Ministry of Transport, Japan 26* (1987), 57100.

.. [#Hasselmann1973] Hasselmann, K., Barnett, T., Bouws, E., Carlson, H., Cartwright, D., Enke, K., Ewing, J., Gienapp, A., Hasselmann, D., Kruseman, P., Meerburg, A., Mller, P., Olbers, D., Richter, K., Sell, W., and Walden, H. Measurements of wind-wave growth and swell decay during the Joint North Sea Wave Project (JONSWAP). *Ergnzungsheft Zur Deutschen Hydrographischen Zeitschrift, Reihe A*, 12 (1973).

.. [#Hauser2005] Hauser, D., Kahma, K., Krogstad, H. E., Lehner, S., Monbaliu, J. A. J., and Wyatt, L. R. Measuring and analysing the directional spectra of ocean waves. EU COST Action 714, 2005.

.. [#IAHR1989] IAHR. List of sea-state parameters. *Journal of Waterway, Port, Coastal, and Ocean Engineering 115*, 6 (1989), 793808. IAHR Working Group on Wave Generation and Analysis.

.. [#Iseki2000] Iseki, T., and Ohtsu, K. Bayesian estimation of directional wave spectra based on ship motions. *Control Engineering Practice 8*, 2 (2000), 215219.

.. [#Joensen2021] Joensen, B., Niclasen, B. A., and Bingham, H. B. Wave power assessment in Faroese waters using an oceanic to nearshore scale spectral wave model. *Energy 235* (2021), 121404.

.. [#Kawai2021] Kawai, T., Kawamura, Y., Okada, T., Mitsuyuki, T., and Chen, X. Sea state estimation using monitoring data by convolutional neural network (CNN). *Journal of Marine Science and Technology (Japan) 26*, 3 (2021), 947962.

.. [#Kobune1986] Kobune, K., and Hashimoto, N. Estimation of directional spectra from the maximum entropy principle. In *Proceedings of the 5th International Offshore Mechanics and Arctic Engineering Symposium, Tokyo, Japan* (1986), vol. 1, pp. 8085.

.. [#Komen1996] Komen, G. J., Cavaleri, L., Donelan, M., Hasselmann, K., Hasselmann, S., and Janssen, P. A. E. M. *Dynamics and modelling of ocean waves*. Cambridge Univ. Press, Cambridge, UK, 1996.

.. [#Komoriyama2023] Komoriyama, Y., Iijima, K., Tatsumi, A., and Fujikubo, M. Identification of wave profiles encountered by a ship with no forward speed using Kalman filter technique and validation by tank tests - long-crested irregular wave case -. *Ocean Engineering 271* (2023), 113627.

.. [#Krogstad2010] Krogstad, H. E., and Trulsen, K. Interpretations and observations of ocean wave spectra. *Ocean Dynamics 60*, 4 (2010), 973991.

.. [#Kubo2023] Kubo, H., Okada, T., Chen, X., Kawamura, Y., Mitsuyuki, T., and Hayakawa, G. Bayesian updating of estimated parameters representing multimodal directional wave spectrum using measured ship hull stresses. In *Proceedings of the International Conference on Offshore Mechanics and Arctic Engineering* (2023), vol. 2: Structures, Safety, and Reliability, p. V002T02A032.

.. [#Lewis1989] Lewis, E. V., Ed. *Principles of Naval Architecture: Motions in Waves and Controllability. Volume III. Second Revision.* The Society of Naval Architects and Marine Engineers, Jersey City, NJ, USA, 1989.

.. [#LonguetHiggins1963] Longuet-Higgins, M. S., Cartwright, D. E., and Smith, N. D. Observation of the directional spectrum of sea waves using the motions of a floating buoy. *Ocean Wave Spectra* (1963), 111136.

.. [#Lygre1986] Lygre, A., and Krogstad, H. E. Maximum entropy estimation of the directional distribution in ocean wave spectra. *Journal of Physical Oceanography 16*, 12 (1986), 20522060.

.. [#Mitsuyasu1975] Mitsuyasu, H., Tasai, F., Suhara, T., Mizuno, S., Ohkusu, M., Honda, T., and Rikiishi, K. Observations of the directional spectrum of ocean waves using a cloverleaf buoy. *Journal of Physical Oceanography 5*, 4 (1975), 750760.

.. [#Mittendorf2022]  Mittendorf, M., Nielsen, U. D., Bingham, H. B., and Storhaug, G. Sea state identification using machine learning: A comparative study based on in-service data from a container vessel. *Marine Structures 85* (2022), 103274.

.. [#Montazeri2016a] Montazeri, N. *Estimation of waves and ship responses using onboard measurements*. Ph.D. dissertation, Technical University of Denmark, Department of Mechanical Engineering, Kongens Lyngby, Denmark, 2016.

.. [#Montazeri2016b] Montazeri, N., Nielsen, U. D., and Jensen, J. J. Estimation of wind sea and swell using shipboard measurements  A refined parametric modelling approach. *Applied Ocean Research 54* (2016), 7386.

.. [#Nielsen2006] Nielsen, U. D. Estimations of on-site directional wave spectra from measured ship responses. *Marine Structures 19*, 1 (2006), 3369.

.. [#Nielsen2023a] Nielsen, U. D., Bingham, H. B., Brodtkorb, A. H., Iseki, T., Jensen, J. J., Mittendorf, M., Mounet, R. E. G., Shao, Y., Storhaug, G., Srensen, A. J., and Takami, T. Estimating waves via measured ship responses. *Scientific Reports 13*, 1 (2023), 17342.

.. [#Nielsen2020] Nielsen, U. D., and Dietz, J. Estimation of sea state parameters by the wave buoy analogy with comparisons to third generation spectral wave models. *Ocean Engineering 216* (2020), 107781.

.. [#Nielsen2024] Nielsen, U. D., Iwase, K., and Mounet, R. E. G. Comparing machine learning-based sea state estimates by the wave buoy analogy. *Applied Ocean Research 149* (2024), 104042.

.. [#Nielsen2023b] Nielsen, U. D., Mittendorf, M., Shao, Y., and Storhaug, G. Wave spectrum estimation conditioned on machine learning-based output using the wave buoy analogy. *Marine Structures 91* (2023), 103470.

.. [#Pascoal2009] Pascoal, R., and Guedes Soares, C. Kalman filtering of vessel motions for ocean wave directional spectrum estimation. *Ocean Engineering 36*, 6-7 (2009), 477488.

.. [#Pascoal2017] Pascoal, R., Perera, L. P., and Guedes Soares, C. Estimation of directional sea spectra from ship motions in sea trials. *Ocean Engineering 132* (2017), 126137.

.. [#Pierson1964] Pierson, W. J., and Moskowitz, L. Proposed spectral form for fully developed wind seas based on similarity theory of S. A. Kitaigorodskii. *Journal of Geophysical Research 69*, 24 (1964), 51815190.

.. [#Portilla2009] Portilla, J., Ocampo-Torres, F. J., and Monbaliu, J. Spectral partitioning and identification of wind sea and swell. *Journal of Atmospheric and Oceanic Technology 26*, 1 (2009), 107122.

.. [#REGMOPhDhesis] Mounet, R. E. G. *Sea state estimation based on measurements from multiple observation platforms*. Ph.D. dissertation, Technical University of Denmark, 2023.

.. [#Salvesen1971] Salvesen, N., Tuck, E. O., and Faltinsen, O. M. *Ship motions and sea loads*, vol. 75. The Society of Naval Architects and Marine Engineers, New York, NY, USA, November 1970.

.. [#StDenis1953] St Denis, M., and Pierson, W. J. *On the motions of ships in confused seas*, vol. 61. The Society of Naval Architects and Marine Engineers, New York, NY, USA, November 1953.

.. [#Takami2023] Takami, T., Nielsen, U. D., Jensen, J. J., and Chen, X. Estimation of encountered wave elevation sequences based on response measurements in multi-directional seas. *Applied Ocean Research 135* (2023), 103570.

.. [#Takami2022] Takami, T., Nielsen, U. D., Xi, C., Jensen, J. J., and Oka, M. Reconstruction of incident wave profiles based on short-time ship response measurements. *Applied Ocean Research 123* (2022), 103183.

.. [#Tannuri2003] Tannuri, E. A., Sparano, J. V., Simos, A. N., and Da Cruz, J. J. Estimating directional wave spectrum based on stationary ship motion measurements. *Applied Ocean Research 25*, 5 (2003), 243261.

.. [#Tucker2001] Tucker, M. J., and Pitt, E. G. *Waves in ocean engineering*. Volume 5 in Elsevier Ocean Engineering Book Series. Elsevier, 2001.

.. [#Zago2023] Zago, L., Simos, A. N., Kawano, A., and Kogishi, A. M. A new vessel motion based method for parametric estimation of the waves encountered by the ship in a seaway. *Applied Ocean Research 134* (2023), 103499.