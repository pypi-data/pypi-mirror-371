import{y as Ie,ac as ge,L as tt,a3 as Me,X as Ee,I as V,G,H as E,$ as ie,ah as A,a4 as Se,ab as R,aK as ue,B as Q,C as z,c as B,o as k,a as v,O as r,n as N,h as w,a5 as he,bP as fe,a8 as ve,a9 as se,bQ as ot,bW as at,be as Pe,aa as st,bX as oe,br as Ve,F as lt,r as nt,ax as rt,bK as it,an as ut,ae as ct,ad as dt,bY as ht,ao as ft,af as pt,aN as mt,M as D,w as y,as as gt,N as le,e as p,P as Te,bB as vt,U as Le,aH as _t,i as bt,f as O,j as Ae,E as Y,d as T,t as L,bz as wt,aQ as Ct,aB as ae,ai as Be,aL as yt,W as kt,bZ as pe,aR as ne,_ as Z,aT as X,l as W,u as ce,b_ as $t,aU as Et}from"./index-D_ZpIGYe.js";import{E as Fe}from"./index-BKr6L4lW.js";import{g as St,d as Pt,b as Vt}from"./select-u6fJWvaT.js";import{E as Tt,a as Lt}from"./form-item-DIWhEYt7.js";import"./validator-74ZdCdW7.js";const Bt=Ie({color:{type:ge(Object),required:!0},vertical:Boolean});let me=!1;function x(e,o){if(!tt)return;const s=function(a){var l;(l=o.drag)==null||l.call(o,a)},t=function(a){var l;document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",t),document.onselectstart=null,document.ondragstart=null,me=!1,(l=o.end)==null||l.call(o,a)},n=function(a){var l;me||(a.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",s),document.addEventListener("mouseup",t),document.addEventListener("touchmove",s),document.addEventListener("touchend",t),me=!0,(l=o.start)==null||l.call(o,a))};e.addEventListener("mousedown",n),e.addEventListener("touchstart",n,{passive:!1})}const _e=e=>{let o,s;return e.type==="touchend"?(s=e.changedTouches[0].clientY,o=e.changedTouches[0].clientX):e.type.startsWith("touch")?(s=e.touches[0].clientY,o=e.touches[0].clientX):(s=e.clientY,o=e.clientX),{clientX:o,clientY:s}},It=e=>{const o=ue(),{t:s}=Me(),t=Ee(),n=Ee(),a=V(()=>e.color.get("alpha")),l=V(()=>s("el.colorpicker.alphaLabel"));function u(d){var m;d.target!==t.value&&c(d),(m=t.value)==null||m.focus()}function c(d){if(!n.value||!t.value)return;const h=o.vnode.el.getBoundingClientRect(),{clientX:g,clientY:C}=_e(d);if(e.vertical){let $=C-h.top;$=Math.max(t.value.offsetHeight/2,$),$=Math.min($,h.height-t.value.offsetHeight/2),e.color.set("alpha",Math.round(($-t.value.offsetHeight/2)/(h.height-t.value.offsetHeight)*100))}else{let $=g-h.left;$=Math.max(t.value.offsetWidth/2,$),$=Math.min($,h.width-t.value.offsetWidth/2),e.color.set("alpha",Math.round(($-t.value.offsetWidth/2)/(h.width-t.value.offsetWidth)*100))}}function f(d){const{code:m,shiftKey:h}=d,g=h?10:1;switch(m){case R.left:case R.down:d.preventDefault(),d.stopPropagation(),P(-g);break;case R.right:case R.up:d.preventDefault(),d.stopPropagation(),P(g);break}}function P(d){let m=a.value+d;m=m<0?0:m>100?100:m,e.color.set("alpha",m)}return{thumb:t,bar:n,alpha:a,alphaLabel:l,handleDrag:c,handleClick:u,handleKeydown:f}},Mt=(e,{bar:o,thumb:s,handleDrag:t})=>{const n=ue(),a=G("color-alpha-slider"),l=E(0),u=E(0),c=E();function f(){if(!s.value||e.vertical)return 0;const S=n.vnode.el,_=e.color.get("alpha");return S?Math.round(_*(S.offsetWidth-s.value.offsetWidth/2)/100):0}function P(){if(!s.value)return 0;const S=n.vnode.el;if(!e.vertical)return 0;const _=e.color.get("alpha");return S?Math.round(_*(S.offsetHeight-s.value.offsetHeight/2)/100):0}function d(){if(e.color&&e.color.value){const{r:S,g:_,b:J}=e.color.toRgb();return`linear-gradient(to right, rgba(${S}, ${_}, ${J}, 0) 0%, rgba(${S}, ${_}, ${J}, 1) 100%)`}return""}function m(){l.value=f(),u.value=P(),c.value=d()}ie(()=>{if(!o.value||!s.value)return;const S={drag:_=>{t(_)},end:_=>{t(_)}};x(o.value,S),x(s.value,S),m()}),A(()=>e.color.get("alpha"),()=>m()),A(()=>e.color.value,()=>m());const h=V(()=>[a.b(),a.is("vertical",e.vertical)]),g=V(()=>a.e("bar")),C=V(()=>a.e("thumb")),$=V(()=>({background:c.value})),M=V(()=>({left:Se(l.value),top:Se(u.value)}));return{rootKls:h,barKls:g,barStyle:$,thumbKls:C,thumbStyle:M,update:m}},At="ElColorAlphaSlider",Ft=z({name:At}),Dt=z({...Ft,props:Bt,setup(e,{expose:o}){const s=e,{alpha:t,alphaLabel:n,bar:a,thumb:l,handleDrag:u,handleClick:c,handleKeydown:f}=It(s),{rootKls:P,barKls:d,barStyle:m,thumbKls:h,thumbStyle:g,update:C}=Mt(s,{bar:a,thumb:l,handleDrag:u});return o({update:C,bar:a,thumb:l}),($,M)=>(k(),B("div",{class:w(r(P))},[v("div",{ref_key:"bar",ref:a,class:w(r(d)),style:N(r(m)),onClick:r(c)},null,14,["onClick"]),v("div",{ref_key:"thumb",ref:l,class:w(r(h)),style:N(r(g)),"aria-label":r(n),"aria-valuenow":r(t),"aria-orientation":$.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:r(f)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var Ht=Q(Dt,[["__file","alpha-slider.vue"]]);const Kt=z({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const o=G("color-hue-slider"),s=ue(),t=E(),n=E(),a=E(0),l=E(0),u=V(()=>e.color.get("hue"));A(()=>u.value,()=>{m()});function c(h){h.target!==t.value&&f(h)}function f(h){if(!n.value||!t.value)return;const C=s.vnode.el.getBoundingClientRect(),{clientX:$,clientY:M}=_e(h);let S;if(e.vertical){let _=M-C.top;_=Math.min(_,C.height-t.value.offsetHeight/2),_=Math.max(t.value.offsetHeight/2,_),S=Math.round((_-t.value.offsetHeight/2)/(C.height-t.value.offsetHeight)*360)}else{let _=$-C.left;_=Math.min(_,C.width-t.value.offsetWidth/2),_=Math.max(t.value.offsetWidth/2,_),S=Math.round((_-t.value.offsetWidth/2)/(C.width-t.value.offsetWidth)*360)}e.color.set("hue",S)}function P(){if(!t.value)return 0;const h=s.vnode.el;if(e.vertical)return 0;const g=e.color.get("hue");return h?Math.round(g*(h.offsetWidth-t.value.offsetWidth/2)/360):0}function d(){if(!t.value)return 0;const h=s.vnode.el;if(!e.vertical)return 0;const g=e.color.get("hue");return h?Math.round(g*(h.offsetHeight-t.value.offsetHeight/2)/360):0}function m(){a.value=P(),l.value=d()}return ie(()=>{if(!n.value||!t.value)return;const h={drag:g=>{f(g)},end:g=>{f(g)}};x(n.value,h),x(t.value,h),m()}),{bar:n,thumb:t,thumbLeft:a,thumbTop:l,hueValue:u,handleClick:c,update:m,ns:o}}});function Ot(e,o,s,t,n,a){return k(),B("div",{class:w([e.ns.b(),e.ns.is("vertical",e.vertical)])},[v("div",{ref:"bar",class:w(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),v("div",{ref:"thumb",class:w(e.ns.e("thumb")),style:N({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var Rt=Q(Kt,[["render",Ot],["__file","hue-slider.vue"]]);const Nt=Ie({persistent:{type:Boolean,default:!0},modelValue:{type:ge(String),default:void 0},id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:st,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:Pe.teleported,appendTo:Pe.appendTo,predefine:{type:ge(Array)},validateEvent:{type:Boolean,default:!0},...at,...ot(["ariaLabel"])}),Wt={[se]:e=>he(e)||fe(e),[ve]:e=>he(e)||fe(e),activeChange:e=>he(e)||fe(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},De=Symbol("colorPickerContextKey");class re{constructor(o={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this._tiny=new oe,this._isValid=!1,this.enableAlpha=!1,this.format="",this.value="";for(const s in o)Ve(o,s)&&(this[s]=o[s]);o.value?this.fromString(o.value):this.doOnChange()}set(o,s){if(arguments.length===1&&typeof o=="object"){for(const t in o)Ve(o,t)&&this.set(t,o[t]);return}this[`_${o}`]=s,this._isValid=!0,this.doOnChange()}get(o){return["hue","saturation","value","alpha"].includes(o)?Math.round(this[`_${o}`]):this[`_${o}`]}toRgb(){return this._isValid?this._tiny.toRgb():{r:255,g:255,b:255,a:0}}fromString(o){const s=new oe(o);if(this._isValid=s.isValid,s.isValid){const{h:t,s:n,v:a,a:l}=s.toHsv();this._hue=t,this._saturation=n*100,this._value=a*100,this._alpha=l*100}else this._hue=0,this._saturation=100,this._value=100,this._alpha=100;this.doOnChange()}compare(o){const s=new oe({h:o._hue,s:o._saturation/100,v:o._value/100,a:o._alpha/100});return this._tiny.equals(s)}doOnChange(){const{_hue:o,_saturation:s,_value:t,_alpha:n,format:a,enableAlpha:l}=this;let u=a||(l?"rgb":"hex");a==="hex"&&l&&(u="hex8"),this._tiny=new oe({h:o,s:s/100,v:t/100,a:n/100}),this.value=this._isValid?this._tiny.toString(u):""}}const zt=z({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const o=G("color-predefine"),{currentColor:s}=rt(De),t=E(a(e.colors,e.color));A(()=>s.value,l=>{const u=new re({value:l});t.value.forEach(c=>{c.selected=u.compare(c)})}),it(()=>{t.value=a(e.colors,e.color)});function n(l){e.color.fromString(e.colors[l])}function a(l,u){return l.map(c=>{const f=new re({value:c});return f.selected=f.compare(u),f})}return{rgbaColors:t,handleSelect:n,ns:o}}});function Ut(e,o,s,t,n,a){return k(),B("div",{class:w(e.ns.b())},[v("div",{class:w(e.ns.e("colors"))},[(k(!0),B(lt,null,nt(e.rgbaColors,(l,u)=>(k(),B("div",{key:e.colors[u],class:w([e.ns.e("color-selector"),e.ns.is("alpha",l.get("alpha")<100),{selected:l.selected}]),onClick:c=>e.handleSelect(u)},[v("div",{style:N({backgroundColor:l.value})},null,4)],10,["onClick"]))),128))],2)],2)}var qt=Q(zt,[["render",Ut],["__file","predefine.vue"]]);const jt=z({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const o=G("color-svpanel"),s=ue(),t=E(0),n=E(0),a=E("hsl(0, 100%, 50%)"),l=V(()=>{const f=e.color.get("hue"),P=e.color.get("value");return{hue:f,value:P}});function u(){const f=e.color.get("saturation"),P=e.color.get("value"),d=s.vnode.el,{clientWidth:m,clientHeight:h}=d;n.value=f*m/100,t.value=(100-P)*h/100,a.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function c(f){const d=s.vnode.el.getBoundingClientRect(),{clientX:m,clientY:h}=_e(f);let g=m-d.left,C=h-d.top;g=Math.max(0,g),g=Math.min(g,d.width),C=Math.max(0,C),C=Math.min(C,d.height),n.value=g,t.value=C,e.color.set({saturation:g/d.width*100,value:100-C/d.height*100})}return A(()=>l.value,()=>{u()}),ie(()=>{x(s.vnode.el,{drag:f=>{c(f)},end:f=>{c(f)}}),u()}),{cursorTop:t,cursorLeft:n,background:a,colorValue:l,handleDrag:c,update:u,ns:o}}});function Xt(e,o,s,t,n,a){return k(),B("div",{class:w(e.ns.b()),style:N({backgroundColor:e.background})},[v("div",{class:w(e.ns.e("white"))},null,2),v("div",{class:w(e.ns.e("black"))},null,2),v("div",{class:w(e.ns.e("cursor")),style:N({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[v("div")],6)],6)}var Yt=Q(jt,[["render",Xt],["__file","sv-panel.vue"]]);const xt=z({name:"ElColorPicker"}),Gt=z({...xt,props:Nt,emits:Wt,setup(e,{expose:o,emit:s}){const t=e,{t:n}=Me(),a=G("color"),{formItem:l}=ut(),u=ct(),c=dt(),{valueOnClear:f,isEmptyValue:P}=ht(t,null),{inputId:d,isLabeledByFormItem:m}=ft(t,{formItemContext:l}),h=E(),g=E(),C=E(),$=E(),M=E(),S=E(),{isFocused:_,handleFocus:J,handleBlur:Ne}=pt(M,{disabled:c,beforeBlur(i){var I;return(I=$.value)==null?void 0:I.isFocusInsideContent(i)},afterBlur(){j(!1),q()}});let de=!0;const b=mt(new re({enableAlpha:t.showAlpha,format:t.colorFormat||"",value:t.modelValue})),U=E(!1),H=E(!1),F=E(""),We=V(()=>!t.modelValue&&!H.value?"transparent":je(b,t.showAlpha)),ee=V(()=>!t.modelValue&&!H.value?"":b.value),ze=V(()=>m.value?void 0:t.ariaLabel||n("el.colorpicker.defaultLabel")),Ue=V(()=>m.value?l?.labelId:void 0),qe=V(()=>[a.b("picker"),a.is("disabled",c.value),a.bm("picker",u.value),a.is("focused",_.value)]);function je(i,I){const{r:K,g:ke,b:$e,a:et}=i.toRgb();return I?`rgba(${K}, ${ke}, ${$e}, ${et})`:`rgb(${K}, ${ke}, ${$e})`}function j(i){U.value=i}const te=St(j,100,{leading:!0});function be(){c.value||j(!0)}function we(){te(!1),q()}function q(){ae(()=>{t.modelValue?b.fromString(t.modelValue):(b.value="",!ee.value&&F.value&&(F.value=""),ae(()=>{H.value=!1}))})}function Xe(){c.value||(U.value&&q(),te(!U.value))}function Ye(){b.fromString(F.value),b.value!==F.value&&(F.value=b.value)}function xe(){const i=P(b.value)?f.value:b.value;s(se,i),s(ve,i),t.validateEvent&&l?.validate("change").catch(I=>Be()),te(!1),ae(()=>{const I=new re({enableAlpha:t.showAlpha,format:t.colorFormat||"",value:t.modelValue});b.compare(I)||q()})}function Ge(){te(!1),s(se,f.value),s(ve,f.value),t.modelValue!==f.value&&t.validateEvent&&l?.validate("change").catch(i=>Be()),q()}function Qe(){U.value&&(we(),_.value&&ye())}function Ce(i){i.preventDefault(),i.stopPropagation(),j(!1),q()}function Ze(i){switch(i.code){case R.enter:case R.numpadEnter:case R.space:i.preventDefault(),i.stopPropagation(),be(),S.value.focus();break;case R.esc:Ce(i);break}}function ye(){M.value.focus()}function Je(){M.value.blur()}return ie(()=>{t.modelValue&&(F.value=ee.value)}),A(()=>t.modelValue,i=>{i?i&&i!==b.value&&(de=!1,b.fromString(i)):H.value=!1}),A(()=>[t.colorFormat,t.showAlpha],()=>{b.enableAlpha=t.showAlpha,b.format=t.colorFormat||b.format,b.doOnChange(),s(se,b.value)}),A(()=>ee.value,i=>{F.value=i,de&&s("activeChange",i),de=!0}),A(()=>b.value,()=>{!t.modelValue&&!H.value&&(H.value=!0)}),A(()=>U.value,()=>{ae(()=>{var i,I,K;(i=h.value)==null||i.update(),(I=g.value)==null||I.update(),(K=C.value)==null||K.update()})}),yt(De,{currentColor:ee}),o({color:b,show:be,hide:we,focus:ye,blur:Je}),(i,I)=>(k(),D(r(Ct),{ref_key:"popper",ref:$,visible:U.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[r(a).be("picker","panel"),r(a).b("dropdown"),i.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:i.teleported,transition:`${r(a).namespace.value}-zoom-in-top`,persistent:i.persistent,"append-to":i.appendTo,onHide:K=>j(!1)},{content:y(()=>[le((k(),B("div",{onKeydown:bt(Ce,["esc"])},[v("div",{class:w(r(a).be("dropdown","main-wrapper"))},[p(Rt,{ref_key:"hue",ref:h,class:"hue-slider",color:r(b),vertical:""},null,8,["color"]),p(Yt,{ref_key:"sv",ref:g,color:r(b)},null,8,["color"])],2),i.showAlpha?(k(),D(Ht,{key:0,ref_key:"alpha",ref:C,color:r(b)},null,8,["color"])):O("v-if",!0),i.predefine?(k(),D(qt,{key:1,ref:"predefine","enable-alpha":i.showAlpha,color:r(b),colors:i.predefine},null,8,["enable-alpha","color","colors"])):O("v-if",!0),v("div",{class:w(r(a).be("dropdown","btns"))},[v("span",{class:w(r(a).be("dropdown","value"))},[p(r(Ae),{ref_key:"inputRef",ref:S,modelValue:F.value,"onUpdate:modelValue":K=>F.value=K,"validate-event":!1,size:"small",onChange:Ye},null,8,["modelValue","onUpdate:modelValue"])],2),p(r(Y),{class:w(r(a).be("dropdown","link-btn")),text:"",size:"small",onClick:Ge},{default:y(()=>[T(L(r(n)("el.colorpicker.clear")),1)]),_:1},8,["class"]),p(r(Y),{plain:"",size:"small",class:w(r(a).be("dropdown","btn")),onClick:xe},{default:y(()=>[T(L(r(n)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[r(wt),Qe,M.value]])]),default:y(()=>[v("div",gt({id:r(d),ref_key:"triggerRef",ref:M},i.$attrs,{class:r(qe),role:"button","aria-label":r(ze),"aria-labelledby":r(Ue),"aria-description":r(n)("el.colorpicker.description",{color:i.modelValue||""}),"aria-disabled":r(c),tabindex:r(c)?void 0:i.tabindex,onKeydown:Ze,onFocus:r(J),onBlur:r(Ne)}),[v("div",{class:w(r(a).be("picker","trigger")),onClick:Xe},[v("span",{class:w([r(a).be("picker","color"),r(a).is("alpha",i.showAlpha)])},[v("span",{class:w(r(a).be("picker","color-inner")),style:N({backgroundColor:r(We)})},[le(p(r(Te),{class:w([r(a).be("picker","icon"),r(a).is("icon-arrow-down")])},{default:y(()=>[p(r(vt))]),_:1},8,["class"]),[[Le,i.modelValue||H.value]]),le(p(r(Te),{class:w([r(a).be("picker","empty"),r(a).is("icon-close")])},{default:y(()=>[p(r(_t))]),_:1},8,["class"]),[[Le,!i.modelValue&&!H.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","persistent","append-to","onHide"]))}});var Qt=Q(Gt,[["__file","color-picker.vue"]]);const Zt=kt(Qt),Jt={install(e){pe._context=e._context,ne._context=e._context,e.directive("loading",ne),e.config.globalProperties.$loading=pe},directive:ne,service:pe},eo={name:"restartBotButton",data(){const{t:e}=ce();return{t:e,pollingTimeout:6e4,pollingInterval:2e3,hasShownTimeoutError:!1}},methods:{async handleRestart(){try{await Fe.confirm(this.t("confirm.message"),this.t("confirm.warning"),{confirmButtonText:this.t("button.confirm"),cancelButtonText:this.t("button.cancel"),type:"warning"}),await this.restartBot()}catch{return}},async restartBot(){try{if((await X.post("/api/restart",{})).status===200){Jt.service({fullscreen:!0,text:this.t("setting.restart_bot.loading.text")});const o=Date.now(),s=async()=>{try{if((await X.get("/api")).status===200)window.location.href="/";else throw new Error("Not ready")}catch{Date.now()-o>=this.pollingTimeout&&!this.hasShownTimeoutError&&(this.hasShownTimeoutError=!0,W({message:this.t("setting.restart_bot.message.failed"),type:"error",duration:0})),setTimeout(s,this.pollingInterval)}};this.hasShownTimeoutError=!1,setTimeout(s,this.pollingInterval)}}catch(e){W.error(this.t("message.error.fetch")+e.message)}}}};function to(e,o,s,t,n,a){const l=Y;return k(),B("div",null,[v("h3",null,[o[0]||(o[0]=v("i",{class:"mdi mdi-restart"},null,-1)),T(" "+L(e.$t("setting.restart_bot.title")),1)]),p(l,{type:"danger",onClick:a.handleRestart},{default:y(()=>[T(L(e.$t("setting.restart_bot.button.restart")),1)]),_:1},8,["onClick"])])}const He=Z(eo,[["render",to]]),oo={name:"ThemeSelector",data(){const{t:e}=ce();return{presets:{akari:"#edaab3",teahouse:"#0091ff"},customColor:"",showColorPicker:localStorage.getItem("isCustomTheme")==="true",t:e}},methods:{applyPreset(e){const o=this.presets[e];localStorage.setItem("isCustomTheme","false"),localStorage.setItem("themeColor",o),this.showColorPicker=!1,window.dispatchEvent(new Event("theme-change"))},applyCustomColor(e){e?(localStorage.setItem("isCustomTheme","true"),localStorage.setItem("themeColor",e)):(localStorage.removeItem("isCustomTheme","false"),localStorage.removeItem("themeColor","#edaab3")),window.dispatchEvent(new Event("theme-change"))},onCustomButtonClick(){this.applyCustomColor(this.customColor),this.showColorPicker=!0},customButtonStyle(){if(localStorage.getItem("isCustomTheme")==="true"){const o=localStorage.getItem("themeColor");this.customColor=o}return this.customColor?{backgroundColor:this.customColor,borderColor:this.customColor,color:"white"}:{}}}},ao={class:"preset-buttons"},so={class:"custom-theme"};function lo(e,o,s,t,n,a){const l=Y,u=Zt;return k(),B("div",null,[v("h3",null,[o[3]||(o[3]=v("i",{class:"mdi mdi-palette"},null,-1)),T(" "+L(e.$t("setting.theme_setting.title")),1)]),v("div",ao,[p(l,{onClick:o[0]||(o[0]=c=>a.applyPreset("akari")),class:"theme-button akari"},{default:y(()=>[T(L(e.$t("setting.theme_setting.button.pink")),1)]),_:1}),p(l,{onClick:o[1]||(o[1]=c=>a.applyPreset("teahouse")),class:"theme-button teahouse"},{default:y(()=>[T(L(e.$t("setting.theme_setting.button.blue")),1)]),_:1}),v("div",so,[p(l,{onClick:a.onCustomButtonClick,class:"theme-button custom",style:N(a.customButtonStyle())},{default:y(()=>[T(L(e.$t("setting.theme_setting.button.custom")),1)]),_:1},8,["onClick","style"]),n.showColorPicker?(k(),D(u,{key:0,modelValue:n.customColor,"onUpdate:modelValue":o[2]||(o[2]=c=>n.customColor=c),onChange:a.applyCustomColor,clearable:!0},null,8,["modelValue","onChange"])):O("",!0)])])])}const Ke=Z(oo,[["render",lo],["__scopeId","data-v-9d617304"]]),no={name:"LanguageSelector",data(){const{t:e}=ce();return{currentLang:localStorage.getItem("language")||"zh_cn",t:e}},inject:["elementLocale"],methods:{changeLanguage(e){this.currentLang=e,this.$i18n.locale=e,localStorage.setItem("language",e),this.elementLocale.lang=$t[e]}}};function ro(e,o,s,t,n,a){const l=Pt,u=Vt;return k(),B("div",null,[v("h3",null,[o[1]||(o[1]=v("i",{class:"mdi mdi-translate"},null,-1)),T(" "+L(e.$t("setting.select_language.title")),1)]),p(u,{modelValue:n.currentLang,"onUpdate:modelValue":o[0]||(o[0]=c=>n.currentLang=c),onChange:a.changeLanguage,class:"lang-select",style:{width:"100px","margin-right":"10px"}},{default:y(()=>[p(l,{label:"简体中文",value:"zh_cn"}),p(l,{label:"繁體中文",value:"zh_tw"}),p(l,{label:"English",value:"en_us"}),p(l,{label:"日本語",value:"ja_jp"})]),_:1},8,["modelValue","onChange"])])}const Oe=Z(no,[["render",ro],["__scopeId","data-v-4187ee23"]]),io={data(){const{t:e}=ce();return{isLoading:!0,form:{old_password:"",new_password:"",confirm_password:""},noPassword:!1,rules:{old_password:[{required:!0,message:this.$t("setting.change_password.validate.old_password"),trigger:"blur"}],new_password:[{required:!0,message:this.$t("setting.change_password.validate.new_password"),trigger:"blur"}],confirm_password:[{required:!0,message:this.$t("setting.change_password.validate.confirm_password"),trigger:"blur"},{validator:(o,s,t)=>{s!==this.form.new_password?t(new Error(this.$t("setting.change_password.validate.inconsistent"))):t()},trigger:"blur"}]},t:e}},async mounted(){const{data:e}=await X.get("/api/has-password");this.noPassword=!e.data,this.isLoading=!1},methods:{async handleUpdatePassword(){try{try{await this.$refs.formRef.validate()}catch{return}const e={new_password:this.form.new_password};this.noPassword||(e.password=this.form.old_password),(await X.post("/api/change-password",e)).status===204&&location.reload()}catch(e){e.response?.status===401?W.error(this.$t("setting.change_password.message.failed")):e.response?.status===403&&Et||W.error(this.$t("message.error.fetch")+e.message)}},async handleClearPassword(){try{await this.$refs.formRef.validateField("old_password"),Fe.confirm(this.$t("setting.change_password.confirm.message"),this.$t("confirm.warning"),{confirmButtonText:this.$t("button.confirm"),cancelButtonText:this.$t("button.cancel"),type:"warning"}).then(async()=>{await this.confirmClearPassword()}).catch(()=>{})}catch{return}},async confirmClearPassword(){try{const e={password:this.form.old_password};(await X.post("/api/clear-password",e)).status===200&&(W.success(this.$t("setting.change_password.message.success.clear")),localStorage.removeItem("noPasswordPromptDisabled"),location.reload())}catch(e){e.response?.status===401?W.error(this.$t("setting.change_password.message.failed")):W.error(this.$t("message.error.fetch")+e.message)}}}},uo={class:"password-buttons"};function co(e,o,s,t,n,a){const l=Ae,u=Tt,c=Y,f=Lt,P=ne;return le((k(),B("div",null,[v("h3",null,[o[4]||(o[4]=v("i",{class:"mdi mdi-lock"},null,-1)),T(" "+L(e.$t("setting.change_password.title")),1)]),p(f,{model:n.form,rules:n.rules,ref:"formRef","label-width":"auto"},{default:y(()=>[n.noPassword?O("",!0):(k(),D(u,{key:0,label:e.$t("setting.change_password.input.old_password"),prop:"old_password"},{default:y(()=>[p(l,{modelValue:n.form.old_password,"onUpdate:modelValue":o[0]||(o[0]=d=>n.form.old_password=d),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])),n.noPassword?O("",!0):(k(),D(u,{key:1,label:e.$t("setting.change_password.input.new_password"),prop:"new_password"},{default:y(()=>[p(l,{modelValue:n.form.new_password,"onUpdate:modelValue":o[1]||(o[1]=d=>n.form.new_password=d),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])),n.noPassword?(k(),D(u,{key:2,label:e.$t("setting.change_password.input.set_password"),prop:"new_password"},{default:y(()=>[p(l,{modelValue:n.form.new_password,"onUpdate:modelValue":o[2]||(o[2]=d=>n.form.new_password=d),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])):O("",!0),p(u,{label:e.$t("setting.change_password.input.confirm_password"),prop:"confirm_password"},{default:y(()=>[p(l,{modelValue:n.form.confirm_password,"onUpdate:modelValue":o[3]||(o[3]=d=>n.form.confirm_password=d),type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),n.noPassword?(k(),D(u,{key:3},{default:y(()=>[p(c,{type:"primary",onClick:a.handleUpdatePassword},{default:y(()=>[T(L(e.$t("setting.change_password.button.set_password")),1)]),_:1},8,["onClick"])]),_:1})):O("",!0),n.noPassword?O("",!0):(k(),D(u,{key:4},{default:y(()=>[v("div",uo,[p(c,{type:"primary",onClick:a.handleUpdatePassword},{default:y(()=>[T(L(e.$t("setting.change_password.button.update_password")),1)]),_:1},8,["onClick"]),p(c,{type:"danger",onClick:a.handleClearPassword},{default:y(()=>[T(L(e.$t("setting.change_password.button.clear_password")),1)]),_:1},8,["onClick"])])]),_:1}))]),_:1},8,["model","rules"])])),[[P,n.isLoading]])}const Re=Z(io,[["render",co],["__scopeId","data-v-8f26b073"]]),ho={components:{ChangePassword:Re,SelectLanguage:Oe,RestartBot:He,ThemeSetting:Ke}};function fo(e,o,s,t,n,a){const l=Re,u=Oe,c=Ke,f=He;return k(),B("div",null,[p(l),p(u),p(c),p(f)])}const bo=Z(ho,[["render",fo]]);export{bo as default};
