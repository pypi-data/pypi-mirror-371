from ase.data import covalent_radii 

# Сovalent radii data sourced from softBV
# Chen, H., Wong, L. L., & Adams, S. (2019).
# SoftBV–a software tool for screening the materials genome of inorganic fast ion conductors. 
# Structural Science, 75(1), 18-33

covalent_radii_softbv = {
 1: {1: 0.37, -1: 1.14},
 3: {1: 1.31},
 4: {2: 0.91},
 5: {3: 0.71, 1: 0.71},
 6: {4: 0.77, 2: 0.77},
 7: {5: 0.74, 3: 0.74, -3: 1.39},
 8: {-2: 1.33, 6: 0.74},
 9: {-1: 1.26},
 11: {1: 1.66},
 12: {2: 1.36},
 13: {3: 1.11},
 14: {4: 1.17},
 15: {5: 1.1, 4: 1.1, 3: 1.1, -3: 1.92},
 16: {-2: 1.84, 6: 1.04, 4: 1.04},
 17: {7: 0.99, 5: 0.99, 3: 0.99, -1: 1.74},
 18: {0: 0.97},
 19: {1: 2.06},
 20: {2: 1.66},
 21: {3: 1.46},
 22: {4: 1.26, 3: 1.26, 2: 1.26},
 23: {5: 1.21, 4: 1.21, 3: 1.21, 2: 1.21},
 24: {6: 1.21, 4: 1.21, 3: 1.21, 2: 1.21, 5: 1.21},
 25: {7: 1.26, 6: 1.26, 5: 1.26, 4: 1.26, 3: 1.26, 2: 1.26},
 26: {3: 1.26, 2: 1.26, 4: 1.26},
 27: {3: 1.21, 4: 1.21, 2: 1.21, 1: 1.21},
 28: {2: 1.21, 4: 1.21, 3: 1.21},
 29: {2: 1.21, 3: 1.21, 1: 1.21},
 30: {2: 1.21},
 31: {3: 1.16, 1: 1.16},
 32: {4: 1.22, 2: 1.22},
 33: {5: 1.21, 3: 1.21, -3: 2.04},
 34: {6: 1.17, 4: 1.17, -2: 1.91},
 35: {7: 1.14, 5: 1.14, -1: 1.89},
 36: {0: 1.1},
 37: {1: 2.21},
 38: {2: 1.86},
 39: {3: 1.66},
 40: {4: 1.41, 3: 1.41, 2: 1.41},
 41: {5: 1.31, 4: 1.31, 3: 1.31, 2: 1.31},
 42: {6: 1.31, 5: 1.31, 4: 1.31, 3: 1.31, 2: 1.31},
 43: {7: 1.21, 4: 1.21},
 44: {6: 1.16, 5: 1.16, 4: 1.16, 3: 1.16},
 45: {4: 1.21, 3: 1.21},
 46: {2: 1.26, 4: 1.26},
 47: {1: 1.46, 3: 1.46, 2: 1.46},
 48: {2: 1.41},
 49: {3: 1.41, 1: 1.41},
 50: {4: 1.4, 2: 1.4},
 51: {5: 1.41, 3: 1.41, -3: 2.31},
 52: {6: 1.37, 4: 1.37, 2: 1.37, -2: 2.14},
 53: {7: 1.33, 5: 1.33, -1: 2.13},
 54: {6: 1.3, 4: 1.3, 2: 1.3},
 55: {1: 2.46},
 56: {2: 2.01},
 57: {3: 1.81},
 58: {4: 1.71, 3: 1.71},
 59: {3: 1.71},
 60: {3: 1.71},
 62: {3: 1.71},
 63: {3: 1.71, 2: 1.71},
 64: {3: 1.66},
 65: {3: 1.61, 4: 1.61},
 66: {3: 1.61},
 67: {3: 1.61},
 68: {3: 1.61},
 69: {3: 1.61},
 70: {3: 1.61, 2: 1.61},
 71: {3: 1.61},
 72: {4: 1.41},
 73: {5: 1.31, 4: 1.31, 3: 1.31, 2: 1.31},
 74: {6: 1.21, 5: 1.21, 4: 1.21, 3: 1.21, 2: 1.21},
 75: {7: 1.21, 6: 1.21, 5: 1.21, 4: 1.21, 3: 1.21},
 76: {8: 1.16, 7: 1.16, 6: 1.16, 5: 1.16, 4: 1.16},
 77: {5: 1.21, 4: 1.21, 3: 1.21},
 78: {2: 1.21, 5: 1.21, 4: 1.21, 3: 1.21},
 79: {3: 1.21, 1: 1.21},
 80: {2: 1.36, 1: 1.36},
 81: {3: 1.76, 1: 1.76},
 82: {4: 1.66, 2: 1.66},
 83: {5: 1.46, 3: 1.46},
 90: {4: 1.66},
 92: {4: 1.61, 6: 1.61}
}


def get_covalent_radii(z, oxi_state=None):
    """
    Get covalent radii of an element

    Parameters
    ----------

    z: int
        atomic number
        
    oxi_state: int, None by default
        valence state of an ion
        Note: if None will use ASE data, otherwise softBV data will be used

    Returns
    -------
    covalent radii of an element: np.array
        meshgrid
    """
    if oxi_state:
        return covalent_radii_softbv[z][oxi_state]
    else: 
        return covalent_radii[z]