# Aspect Definitions
# This file contains aspect type definitions and their properties

# Aspect Definitions
aspects:
  corpUserInfo:
    type: versioned
    properties:
      - active
      - displayName
      - email
      - title
      - department
      - managerUrn
      - skills
    required: ["active", "displayName", "email"]
    defaults:
      active: true
    # Entity creation parameters for independent ingestion
    entity_creation:
      entity_type: "CorpUser"
      urn_generator: "corpUser"
      required_params: ["username"]
      optional_params: []
  
  corpGroupInfo:
    type: versioned
    properties:
      - name
      - description
      - email
      - slackChannel
    required: ["name"]
    entity_creation:
      entity_type: "CorpGroup"
      urn_generator: "corpGroup"
      required_params: ["name"]
      optional_params: []
  
  datasetProperties:
    type: versioned
    properties:
      - description
      - customProperties
      - tags
      - externalUrl
    required: ["description"]
    entity_creation:
      entity_type: "Dataset"
      urn_generator: "dataset"
      required_params: ["platform", "name"]
      optional_params: ["env"]
  
  schemaMetadata:
    type: versioned
    properties:
      - schemaName
      - platform
      - version
      - fields
      - primaryKeys
      - foreignKeys
    required: ["schemaName", "platform", "fields"]
    entity_creation:
      entity_type: "Dataset"
      urn_generator: "dataset"
      required_params: ["platform", "name"]
      optional_params: ["env"]
  
  ownership:
    type: versioned
    properties:
      - owners
      - lastModified
    required: ["owners"]
    # Ownership can be attached to multiple entity types
    # Entity creation will be determined by the context where it's used
    entity_creation:
      entity_type: "Dataset"  # Default to Dataset, but can be overridden
      urn_generator: "dataset"
      required_params: ["platform", "name"]
      optional_params: ["env"]
  
  globalTags:
    type: versioned
    properties:
      - tags
    required: ["tags"]
    # Global tags can be attached to multiple entity types
    # Entity creation will be determined by the context where it's used
    entity_creation:
      entity_type: "Dataset"  # Default to Dataset, but can be overridden
      urn_generator: "dataset"
      required_params: ["platform", "name"]
      optional_params: ["env"]
  
  datasetProfile:
    type: timeseries
    properties:
      - rowCount
      - columnCount
      - sizeInBytes
      - lastModified
      - partitionCount
    required: ["rowCount", "columnCount"]
    entity_creation:
      entity_type: "Dataset"
      urn_generator: "dataset"
      required_params: ["platform", "name"]
      optional_params: ["env"]
  
  dataFlowInfo:
    type: versioned
    properties:
      - name
      - namespace
      - description
      - version
    required: ["name", "namespace"]
    entity_creation:
      entity_type: "DataFlow"
      urn_generator: "dataFlow"
      required_params: ["platform", "flow_id"]
      optional_params: ["env"]
  
  dataJobInfo:
    type: versioned
    properties:
      - name
      - namespace
      - versionId
      - integration
      - processingType
      - jobType
      - description
    required: ["name", "namespace"]
    entity_creation:
      entity_type: "DataJob"
      urn_generator: "dataJob"
      required_params: ["flow_urn", "job_name"]
      optional_params: []
  
  documentation:
    type: versioned
    properties:
      - description
      - contentType
      - content
    required: ["description"]
    # Documentation is typically attached to DataJob entities
    entity_creation:
      entity_type: "DataJob"
      urn_generator: "dataJob"
      required_params: ["flow_urn", "job_name"]
      optional_params: []
  
  sourceCodeLocation:
    type: versioned
    properties:
      - type
      - url
      - repo
      - branch
      - path
    required: ["type", "url"]
    # Source code location is typically attached to DataJob entities
    entity_creation:
      entity_type: "DataJob"
      urn_generator: "dataJob"
      required_params: ["flow_urn", "job_name"]
      optional_params: []
  
  sourceCode:
    type: versioned
    properties:
      - language
      - snippet
      - fullCode
    required: ["language"]
    # Source code is typically attached to DataJob entities
    entity_creation:
      entity_type: "DataJob"
      urn_generator: "dataJob"
      required_params: ["flow_urn", "job_name"]
      optional_params: []
  
  environmentProperties:
    type: versioned
    properties:
      - env
      - config
    required: ["env"]
    # Environment properties are typically attached to DataJob entities
    entity_creation:
      entity_type: "DataJob"
      urn_generator: "dataJob"
      required_params: ["flow_urn", "job_name"]
      optional_params: []
  
  dataJobInputOutput:
    type: versioned
    properties:
      - inputs
      - outputs
    required: ["inputs", "outputs"]
    # Data job I/O is typically attached to DataJob entities
    entity_creation:
      entity_type: "DataJob"
      urn_generator: "dataJob"
      required_params: ["flow_urn", "job_name"]
      optional_params: []
  
  dataJobRun:
    type: timeseries
    properties:
      - eventType
      - runId
      - parent
      - status
      - startTime
      - endTime
    required: ["eventType", "runId"]
    # Data job runs are typically attached to DataJob entities
    entity_creation:
      entity_type: "DataJob"
      urn_generator: "dataJob"
      required_params: ["flow_urn", "job_name"]
      optional_params: []
  
  columnProperties:
    type: versioned
    properties:
      - description
      - dataType
      - nullable
      - defaultValue
    required: ["dataType"]
    entity_creation:
      entity_type: "Column"
      urn_generator: "column"
      required_params: ["dataset_urn", "field_path"]
      optional_params: []
  
  transformation:
    type: versioned
    properties:
      - inputColumns
      - steps
      - notes
      - sourceDataset
      - targetDataset
      - transformationType
    required: ["inputColumns", "transformationType"]
    defaults:
      sourceDataset: null
      targetDataset: null
    entity_creation:
      entity_type: "Column"
      urn_generator: "column"
      required_params: ["dataset_urn", "field_path"]
      optional_params: []
