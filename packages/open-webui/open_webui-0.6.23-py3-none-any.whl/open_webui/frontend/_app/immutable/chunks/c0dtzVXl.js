import{e as c}from"./D65_I83N.js";import{s as f}from"./kUZEmwP1.js";const m=async(n,a,o)=>{const e=new FormData;e.append("file",a),o&&e.append("metadata",JSON.stringify(o));let t=null;const r=await fetch(`${c}/files/`,{method:"POST",headers:{Accept:"application/json",authorization:`Bearer ${n}`},body:e}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>(t=i.detail,console.error(i),null));if(t)throw t;if(r){const i=await w(n,r.id);if(i&&i.ok){const p=i.body.pipeThrough(new TextDecoderStream).pipeThrough(f(`
`)).getReader();for(;;){const{value:u,done:d}=await p.read();if(d)break;try{let h=u.split(`
`);for(const l of h)if(l!==""&&l!=="data: [DONE]"){let s=JSON.parse(l.replace(/^data: /,""));s!=null&&s.error&&(console.error(s.error),r.error=s.error)}}catch{}}}}if(t)throw t;return r},w=async(n,a)=>{const o=new URLSearchParams;o.append("stream","true");let e=null;const t=await fetch(`${c}/files/${a}/process/status?${o}`,{method:"GET",headers:{Accept:"application/json",authorization:`Bearer ${n}`}}).catch(r=>(e=r.detail,console.error(r),null));if(e)throw e;return t},$=async(n,a)=>{let o=null;const e=await fetch(`${c}/files/${a}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${n}`}}).then(async t=>{if(!t.ok)throw await t.json();return t.json()}).then(t=>t).catch(t=>(o=t.detail,console.error(t),null));if(o)throw o;return e},g=async(n,a,o)=>{let e=null;const t=await fetch(`${c}/files/${a}/data/content/update`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${n}`},body:JSON.stringify({content:o})}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).then(r=>r).catch(r=>(e=r.detail,console.error(r),null));if(e)throw e;return t},T=async n=>{let a=null;const o=await fetch(`${c}/files/all`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${n}`}}).then(async e=>{if(!e.ok)throw await e.json();return e.json()}).then(e=>e).catch(e=>(a=e.detail,console.error(e),null));if(a)throw a;return o};export{g as a,T as d,$ as g,m as u};
//# sourceMappingURL=c0dtzVXl.js.map
