#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
ç¬¬äº”ç« æ•°å­¦ç»Ÿè®¡ç»“è®ºè¾“å‡ºè„šæœ¬
åŸºäºè®ºæ–‡ä¸­çš„ç»Ÿè®¡åˆ†æç»“æœï¼Œè¾“å‡ºæ‰€æœ‰æ•°å­¦ç»Ÿè®¡ç»“è®º
"""

import warnings
warnings.filterwarnings('ignore')

class Chapter5StatisticsOutput:
    """ç¬¬äº”ç« ç»Ÿè®¡ç»“æœè¾“å‡ºç±»"""
    
    def __init__(self):
        """åˆå§‹åŒ–ç»Ÿè®¡æ•°æ®"""
        self.setup_data()
    
    def setup_data(self):
        """è®¾ç½®è®ºæ–‡ä¸­çš„ç»Ÿè®¡æ•°æ®"""
        # æ ·æœ¬åŸºç¡€ä¿¡æ¯
        self.sample_info = {
            'total_comments': 212000,  # æœ‰æ•ˆè¯„è®ºæ•°
            'total_original': 235000,  # åŸå§‹è¯„è®ºæ•°
            'platforms': {
                'æ·˜å®': {'count': 85000, 'percentage': 40.1},
                'äº¬ä¸œ': {'count': 68000, 'percentage': 32.1},
                'å¤©çŒ«': {'count': 42000, 'percentage': 19.8},
                'å…¶ä»–': {'count': 17000, 'percentage': 8.0}
            },
            'enterprise_scale': {
                'å¤§å‹ä¼ä¸š': {'count': 63600, 'percentage': 30.0},
                'ä¸­å‹ä¼ä¸š': {'count': 84800, 'percentage': 40.0},
                'å°å‹ä¼ä¸š': {'count': 42400, 'percentage': 20.0},
                'ä¸ªä½“ç»è¥è€…': {'count': 21200, 'percentage': 10.0}
            },
            'product_types': {
                'åŸè¯æ': {'count': 95400, 'percentage': 45.0},
                'é¥®ç‰‡': {'count': 74200, 'percentage': 35.0},
                'é…æ–¹é¢—ç²’': {'count': 31800, 'percentage': 15.0},
                'å…¶ä»–åŠ å·¥äº§å“': {'count': 10600, 'percentage': 5.0}
            },
            'ratings': {
                '5æ˜Ÿ': {'count': 131000, 'percentage': 61.8},
                '4æ˜Ÿ': {'count': 30000, 'percentage': 14.0},
                '3æ˜Ÿ': {'count': 24000, 'percentage': 11.5},
                '2æ˜Ÿ': {'count': 16000, 'percentage': 7.5},
                '1æ˜Ÿ': {'count': 11000, 'percentage': 5.2}
            }
        }
        
        # æè¿°æ€§ç»Ÿè®¡æ•°æ®
        self.descriptive_stats = {
            'æœåŠ¡è´¨é‡': {'mean': 7.85, 'std': 1.42, 'min': 2.1, 'max': 9.8},
            'åŸæ–™è´¨é‡': {'mean': 8.12, 'std': 1.35, 'min': 2.5, 'max': 9.9},
            'åŠ å·¥å·¥è‰º': {'mean': 7.68, 'std': 1.48, 'min': 2.2, 'max': 9.7},
            'ç‰©æµé…é€': {'mean': 7.95, 'std': 1.39, 'min': 2.3, 'max': 9.8},
            'å”®åæœåŠ¡': {'mean': 7.52, 'std': 1.56, 'min': 1.8, 'max': 9.6},
            'ä¿¡æ¯é€æ˜åº¦': {'mean': 7.35, 'std': 1.62, 'min': 1.5, 'max': 9.5}
        }
        
        # å„ç»´åº¦è¯¦ç»†æŒ‡æ ‡
        self.dimension_stats = {
            'ä¸Šæ¸¸ï¼ˆåŸæ–™ï¼‰ç»´åº¦': {
                'åŸæ–™è´¨é‡è¯„åˆ†': {'mean': 8.25, 'std': 1.32},
                'åŸæ–™è§„æ ¼ä¸€è‡´æ€§': {'mean': 7.95, 'std': 1.38},
                'åŸææ–™å¯è¿½æº¯æ€§è¯„åˆ†': {'mean': 7.15, 'std': 1.75}
            },
            'ä¸­æ¸¸ï¼ˆåŠ å·¥ï¼‰ç»´åº¦': {
                'å·¥è‰ºæŠ€æœ¯è¯„ä»·': {'mean': 7.82, 'std': 1.45},
                'äº§å“ä¸€è‡´æ€§': {'mean': 7.65, 'std': 1.50},
                'è´¨æ£€æ ‡å‡†ç¬¦åˆåº¦': {'mean': 7.58, 'std': 1.52}
            },
            'ä¸‹æ¸¸ï¼ˆé”€å”®ä¸ç‰©æµï¼‰ç»´åº¦': {
                'äº¤è´§é€Ÿåº¦': {'mean': 8.15, 'std': 1.35},
                'åŒ…è£…è¯„åˆ†': {'mean': 8.05, 'std': 1.36},
                'è®¢å•å‡†ç¡®æ€§': {'mean': 8.25, 'std': 1.32},
                'å”®åæœåŠ¡è´¨é‡': {'mean': 7.52, 'std': 1.56},
                'ä¿¡æ¯é€æ˜åº¦': {'mean': 7.35, 'std': 1.62}
            }
        }
        
        # ä¸åŒä¼ä¸šè§„æ¨¡çš„æœåŠ¡è´¨é‡å¾—åˆ†
        self.enterprise_quality = {
            'å¤§å‹ä¼ä¸š': {'mean': 8.15, 'std': 1.32},
            'ä¸­å‹ä¼ä¸š': {'mean': 7.85, 'std': 1.42},
            'å°å‹ä¼ä¸š': {'mean': 7.65, 'std': 1.50},
            'ä¸ªä½“ç»è¥è€…': {'mean': 7.45, 'std': 1.58}
        }
        
        # ä¸åŒäº§å“ç±»å‹çš„æœåŠ¡è´¨é‡å¾—åˆ†
        self.product_quality = {
            'åŸè¯æ': {'mean': 7.75, 'std': 1.45},
            'é¥®ç‰‡': {'mean': 7.95, 'std': 1.38},
            'é…æ–¹é¢—ç²’': {'mean': 8.05, 'std': 1.36},
            'å…¶ä»–åŠ å·¥äº§å“': {'mean': 7.65, 'std': 1.50}
        }
        
        # ç›¸å…³æ€§åˆ†æç»“æœ
        self.correlations = {
            'è‡ªå˜é‡ä¸å› å˜é‡': {
                'åŸæ–™è´¨é‡ä¸æœåŠ¡è´¨é‡': {'r': 0.78, 'p': '<0.001'},
                'åŠ å·¥å·¥è‰ºä¸æœåŠ¡è´¨é‡': {'r': 0.72, 'p': '<0.001'},
                'ç‰©æµé…é€ä¸æœåŠ¡è´¨é‡': {'r': 0.75, 'p': '<0.001'},
                'å”®åæœåŠ¡ä¸æœåŠ¡è´¨é‡': {'r': 0.68, 'p': '<0.001'},
                'ä¿¡æ¯é€æ˜åº¦ä¸æœåŠ¡è´¨é‡': {'r': 0.65, 'p': '<0.001'}
            },
            'è‡ªå˜é‡ä¹‹é—´': {
                'åŸæ–™è´¨é‡ä¸åŠ å·¥å·¥è‰º': {'r': 0.65, 'p': '<0.001'},
                'åŸæ–™è´¨é‡ä¸ç‰©æµé…é€': {'r': 0.45, 'p': '<0.001'},
                'åŠ å·¥å·¥è‰ºä¸ç‰©æµé…é€': {'r': 0.48, 'p': '<0.001'},
                'ç‰©æµé…é€ä¸å”®åæœåŠ¡': {'r': 0.62, 'p': '<0.001'},
                'å”®åæœåŠ¡ä¸ä¿¡æ¯é€æ˜åº¦': {'r': 0.58, 'p': '<0.001'}
            },
            'ä¼ä¸šè§„æ¨¡ç›¸å…³': {
                'ä¼ä¸šè§„æ¨¡ä¸æœåŠ¡è´¨é‡': {'r': 0.42, 'p': '<0.001'},
                'ä¼ä¸šè§„æ¨¡ä¸åŸæ–™è´¨é‡': {'r': 0.38, 'p': '<0.001'},
                'ä¼ä¸šè§„æ¨¡ä¸åŠ å·¥å·¥è‰º': {'r': 0.45, 'p': '<0.001'},
                'ä¼ä¸šè§„æ¨¡ä¸ç‰©æµé…é€': {'r': 0.48, 'p': '<0.001'},
                'ä¼ä¸šè§„æ¨¡ä¸å”®åæœåŠ¡': {'r': 0.35, 'p': '<0.001'},
                'ä¼ä¸šè§„æ¨¡ä¸ä¿¡æ¯é€æ˜åº¦': {'r': 0.40, 'p': '<0.001'}
            }
        }
        
        # å›å½’åˆ†æç»“æœ
        self.regression_results = {
            'æ¨¡å‹æ‹Ÿåˆåº¦': {
                'RÂ²': 0.782,
                'RÂ²_adj': 0.778,
                'F_statistic': 2285.43,
                'F_df': (7, 44512),
                'F_p': '<0.001',
                'AIC': -12567.2,
                'BIC': -12498.6
            },
            'å›å½’ç³»æ•°': {
                'æˆªè·': {'coef': 0.128, 'se': 0.034, 't': 3.76, 'p': '<0.001', 'vif': None},
                'åŸæ–™è´¨é‡': {'coef': 0.352, 'se': 0.022, 't': 16.00, 'p': '<0.001', 'vif': 1.34},
                'åŠ å·¥å·¥è‰º': {'coef': 0.285, 'se': 0.023, 't': 12.39, 'p': '<0.001', 'vif': 1.28},
                'ç‰©æµé…é€': {'coef': 0.312, 'se': 0.021, 't': 14.86, 'p': '<0.001', 'vif': 1.15},
                'å”®åæœåŠ¡': {'coef': 0.245, 'se': 0.024, 't': 10.21, 'p': '<0.001', 'vif': 1.42},
                'ä¿¡æ¯é€æ˜åº¦': {'coef': 0.218, 'se': 0.025, 't': 8.72, 'p': '<0.001', 'vif': 1.38},
                'äº§å“ç±»å‹': {'coef': 0.067, 'se': 0.026, 't': 2.58, 'p': '0.010', 'vif': 1.08},
                'å¹³å°ç±»å‹': {'coef': 0.021, 'se': 0.018, 't': 1.17, 'p': '0.242', 'vif': 1.05}
            },
            'æ¨¡å‹è¯Šæ–­': {
                'Shapiro-Wilk': {'W': 0.998, 'p': 0.112, 'ç»“è®º': 'æ®‹å·®æœä»æ­£æ€åˆ†å¸ƒ'},
                'Breusch-Pagan': {'chi2': 12.45, 'p': 0.085, 'ç»“è®º': 'åŒæ–¹å·®å‡è®¾æˆç«‹'},
                'Durbin-Watson': {'DW': 2.02, 'ç»“è®º': 'æ— åºåˆ—ç›¸å…³'},
                'VIF': 'å‡å°äº2ï¼Œä¸å­˜åœ¨ä¸¥é‡å¤šé‡å…±çº¿æ€§é—®é¢˜'
            }
        }
        
        # è°ƒèŠ‚æ•ˆåº”åˆ†æç»“æœ
        self.moderation_effects = {
            'ä¼ä¸šè§„æ¨¡Ã—åŸæ–™è´¨é‡': {'coef': 0.125, 't': 5.45, 'p': '<0.001', 'æ•ˆåº”': 'æ˜¾è‘—æ­£å‘è°ƒèŠ‚'},
            'ä¼ä¸šè§„æ¨¡Ã—åŠ å·¥å·¥è‰º': {'coef': 0.142, 't': 6.25, 'p': '<0.001', 'æ•ˆåº”': 'æ˜¾è‘—æ­£å‘è°ƒèŠ‚'},
            'ä¼ä¸šè§„æ¨¡Ã—ç‰©æµé…é€': {'coef': 0.158, 't': 6.95, 'p': '<0.001', 'æ•ˆåº”': 'æ˜¾è‘—æ­£å‘è°ƒèŠ‚'},
            'ä¼ä¸šè§„æ¨¡Ã—å”®åæœåŠ¡': {'coef': 0.085, 't': 3.75, 'p': '<0.01', 'æ•ˆåº”': 'æ˜¾è‘—æ­£å‘è°ƒèŠ‚'},
            'ä¼ä¸šè§„æ¨¡Ã—ä¿¡æ¯é€æ˜åº¦': {'coef': 0.102, 't': 4.45, 'p': '<0.001', 'æ•ˆåº”': 'æ˜¾è‘—æ­£å‘è°ƒèŠ‚'}
        }
    
    def print_sample_overview(self):
        """è¾“å‡ºæ ·æœ¬æ¦‚å†µ"""
        print("=" * 80)
        print("ç¬¬äº”ç«  æ•°å­¦ç»Ÿè®¡ç»“è®º - æ ·æœ¬æ¦‚å†µ")
        print("=" * 80)
        
        print(f"\n1. æ ·æœ¬åŸºç¡€ä¿¡æ¯")
        print(f"   æ€»æ ·æœ¬é‡ï¼š{self.sample_info['total_comments']:,}æ¡æœ‰æ•ˆè¯„è®º")
        print(f"   åŸå§‹æ•°æ®ï¼š{self.sample_info['total_original']:,}æ¡è¯„è®º")
        print(f"   æ•°æ®æ¸…æ´—ç‡ï¼š{((self.sample_info['total_original'] - self.sample_info['total_comments']) / self.sample_info['total_original'] * 100):.1f}%")
        
        print(f"\n2. å¹³å°åˆ†å¸ƒ")
        for platform, data in self.sample_info['platforms'].items():
            print(f"   {platform}ï¼š{data['count']:,}æ¡ ({data['percentage']:.1f}%)")
        
        print(f"\n3. ä¼ä¸šè§„æ¨¡åˆ†å¸ƒ")
        for scale, data in self.sample_info['enterprise_scale'].items():
            print(f"   {scale}ï¼š{data['count']:,}æ¡ ({data['percentage']:.1f}%)")
        
        print(f"\n4. äº§å“ç±»å‹åˆ†å¸ƒ")
        for product, data in self.sample_info['product_types'].items():
            print(f"   {product}ï¼š{data['count']:,}æ¡ ({data['percentage']:.1f}%)")
        
        print(f"\n5. è¯„åˆ†åˆ†å¸ƒ")
        positive_count = self.sample_info['ratings']['5æ˜Ÿ']['count'] + self.sample_info['ratings']['4æ˜Ÿ']['count']
        positive_rate = (positive_count / self.sample_info['total_comments']) * 100
        for rating, data in self.sample_info['ratings'].items():
            print(f"   {rating}ï¼š{data['count']:,}æ¡ ({data['percentage']:.1f}%)")
        print(f"   æ­£é¢è¯„ä»·ï¼ˆ4-5æ˜Ÿï¼‰ï¼š{positive_count:,}æ¡ ({positive_rate:.1f}%)")
    
    def print_descriptive_statistics(self):
        """è¾“å‡ºæè¿°æ€§ç»Ÿè®¡"""
        print("\n" + "=" * 80)
        print("æè¿°æ€§ç»Ÿè®¡åˆ†æ")
        print("=" * 80)
        
        print("\n1. ä¸»è¦å˜é‡æè¿°æ€§ç»Ÿè®¡")
        print("-" * 60)
        print(f"{'å˜é‡':<12} {'å‡å€¼':<8} {'æ ‡å‡†å·®':<8} {'æœ€å°å€¼':<8} {'æœ€å¤§å€¼':<8}")
        print("-" * 60)
        
        for var, stats in self.descriptive_stats.items():
            print(f"{var:<12} {stats['mean']:<8.2f} {stats['std']:<8.2f} {stats['min']:<8.1f} {stats['max']:<8.1f}")
        
        print("\n2. å„ç»´åº¦è¯¦ç»†æŒ‡æ ‡ç»Ÿè®¡")
        for dimension, indicators in self.dimension_stats.items():
            print(f"\n{dimension}:")
            print("-" * 50)
            print(f"{'æŒ‡æ ‡':<20} {'å‡å€¼':<8} {'æ ‡å‡†å·®':<8}")
            print("-" * 50)
            for indicator, stats in indicators.items():
                print(f"{indicator:<20} {stats['mean']:<8.2f} {stats['std']:<8.2f}")
        
        print("\n3. ä¸åŒä¼ä¸šè§„æ¨¡çš„æœåŠ¡è´¨é‡å¾—åˆ†")
        print("-" * 40)
        print(f"{'ä¼ä¸šè§„æ¨¡':<12} {'å‡å€¼':<8} {'æ ‡å‡†å·®':<8}")
        print("-" * 40)
        for scale, stats in self.enterprise_quality.items():
            print(f"{scale:<12} {stats['mean']:<8.2f} {stats['std']:<8.2f}")
        
        print("\n4. ä¸åŒäº§å“ç±»å‹çš„æœåŠ¡è´¨é‡å¾—åˆ†")
        print("-" * 40)
        print(f"{'äº§å“ç±»å‹':<12} {'å‡å€¼':<8} {'æ ‡å‡†å·®':<8}")
        print("-" * 40)
        for product, stats in self.product_quality.items():
            print(f"{product:<12} {stats['mean']:<8.2f} {stats['std']:<8.2f}")
    
    def print_correlation_analysis(self):
        """è¾“å‡ºç›¸å…³æ€§åˆ†æ"""
        print("\n" + "=" * 80)
        print("ç›¸å…³æ€§åˆ†æç»“æœ")
        print("=" * 80)
        
        for category, correlations in self.correlations.items():
            print(f"\n{category}:")
            print("-" * 60)
            print(f"{'å˜é‡å…³ç³»':<30} {'ç›¸å…³ç³»æ•°':<10} {'æ˜¾è‘—æ€§':<10}")
            print("-" * 60)
            for relationship, data in correlations.items():
                print(f"{relationship:<30} {data['r']:<10.3f} {data['p']:<10}")
        
        print("\nç›¸å…³æ€§åˆ†æç»“è®ºï¼š")
        print("â€¢ æ‰€æœ‰è‡ªå˜é‡ä¸å› å˜é‡ä¹‹é—´å‡å­˜åœ¨æ˜¾è‘—çš„æ­£ç›¸å…³å…³ç³»")
        print("â€¢ åŸæ–™è´¨é‡ä¸æœåŠ¡è´¨é‡çš„ç›¸å…³æ€§æœ€å¼º(r=0.78)")
        print("â€¢ ä¿¡æ¯é€æ˜åº¦ä¸æœåŠ¡è´¨é‡çš„ç›¸å…³æ€§ç›¸å¯¹è¾ƒå¼±(r=0.65)")
        print("â€¢ è‡ªå˜é‡é—´ç›¸å…³ç³»æ•°å‡å°äº0.7ï¼Œä¸å­˜åœ¨ä¸¥é‡å¤šé‡å…±çº¿æ€§é—®é¢˜")
        print("â€¢ ä¼ä¸šè§„æ¨¡ä¸æœåŠ¡è´¨é‡åŠå„è‡ªå˜é‡å‡å‘ˆç°æ­£ç›¸å…³å…³ç³»")
    
    def print_regression_analysis(self):
        """è¾“å‡ºå›å½’åˆ†æç»“æœ"""
        print("\n" + "=" * 80)
        print("å¤šå…ƒçº¿æ€§å›å½’åˆ†æç»“æœ")
        print("=" * 80)
        
        # æ¨¡å‹æ‹Ÿåˆä¼˜åº¦
        print("\n1. æ¨¡å‹æ‹Ÿåˆä¼˜åº¦")
        print("-" * 50)
        fit = self.regression_results['æ¨¡å‹æ‹Ÿåˆåº¦']
        print(f"RÂ² = {fit['RÂ²']:.3f}")
        print(f"è°ƒæ•´RÂ² = {fit['RÂ²_adj']:.3f}")
        print(f"Fç»Ÿè®¡é‡ = {fit['F_statistic']:.2f}, df{fit['F_df']}, p {fit['F_p']}")
        print(f"AIC = {fit['AIC']:.1f}, BIC = {fit['BIC']:.1f}")
        
        # å›å½’ç³»æ•°
        print("\n2. å›å½’ç³»æ•°è¡¨")
        print("-" * 80)
        print(f"{'å˜é‡':<12} {'ç³»æ•°':<8} {'æ ‡å‡†è¯¯':<8} {'tå€¼':<8} {'på€¼':<10} {'VIF':<6}")
        print("-" * 80)
        
        for var, data in self.regression_results['å›å½’ç³»æ•°'].items():
            vif = data['vif'] if data['vif'] is not None else '-'
            print(f"{var:<12} {data['coef']:<8.3f} {data['se']:<8.3f} {data['t']:<8.2f} {data['p']:<10} {vif:<6}")
        
        # å›å½’æ–¹ç¨‹
        print("\n3. å›å½’æ–¹ç¨‹")
        print("-" * 50)
        coefs = self.regression_results['å›å½’ç³»æ•°']
        equation = f"æœåŠ¡è´¨é‡ = {coefs['æˆªè·']['coef']:.3f}"
        equation += f" + {coefs['åŸæ–™è´¨é‡']['coef']:.3f} Ã— åŸæ–™è´¨é‡"
        equation += f" + {coefs['åŠ å·¥å·¥è‰º']['coef']:.3f} Ã— åŠ å·¥å·¥è‰º"
        equation += f" + {coefs['ç‰©æµé…é€']['coef']:.3f} Ã— ç‰©æµé…é€"
        equation += f" + {coefs['å”®åæœåŠ¡']['coef']:.3f} Ã— å”®åæœåŠ¡"
        equation += f" + {coefs['ä¿¡æ¯é€æ˜åº¦']['coef']:.3f} Ã— ä¿¡æ¯é€æ˜åº¦ + Îµ"
        print(equation)
        
        # æ¨¡å‹è¯Šæ–­
        print("\n4. æ¨¡å‹è¯Šæ–­ç»“æœ")
        print("-" * 50)
        diag = self.regression_results['æ¨¡å‹è¯Šæ–­']
        print(f"Shapiro-Wilkæ­£æ€æ€§æ£€éªŒï¼šW = {diag['Shapiro-Wilk']['W']:.3f}, p = {diag['Shapiro-Wilk']['p']:.3f}")
        print(f"ç»“è®ºï¼š{diag['Shapiro-Wilk']['ç»“è®º']}")
        print(f"\nBreusch-PaganåŒæ–¹å·®æ£€éªŒï¼šÏ‡Â² = {diag['Breusch-Pagan']['chi2']:.2f}, p = {diag['Breusch-Pagan']['p']:.3f}")
        print(f"ç»“è®ºï¼š{diag['Breusch-Pagan']['ç»“è®º']}")
        print(f"\nDurbin-Watsonç‹¬ç«‹æ€§æ£€éªŒï¼šDW = {diag['Durbin-Watson']['DW']:.2f}")
        print(f"ç»“è®ºï¼š{diag['Durbin-Watson']['ç»“è®º']}")
        print(f"\næ–¹å·®è†¨èƒ€å› å­ï¼ˆVIFï¼‰ï¼š{diag['VIF']}")
        
        # ç»“æœè§£é‡Š
        print("\n5. å›å½’åˆ†æç»“è®º")
        print("-" * 50)
        print("â€¢ æ¨¡å‹æ•´ä½“æ˜¾è‘—æœ‰æ•ˆï¼ˆFæ£€éªŒ p < 0.001ï¼‰")
        print("â€¢ æ¨¡å‹è§£é‡Šäº†78.2%çš„æœåŠ¡è´¨é‡å˜å¼‚ï¼ˆRÂ² = 0.782ï¼‰")
        print("â€¢ åŸæ–™è´¨é‡æ˜¯æœ€é‡è¦çš„å½±å“å› ç´ ï¼ˆÎ² = 0.352ï¼‰")
        print("â€¢ ç‰©æµé…é€æ¬¡ä¹‹ï¼ˆÎ² = 0.312ï¼‰ï¼ŒåŠ å·¥å·¥è‰ºç¬¬ä¸‰ï¼ˆÎ² = 0.285ï¼‰")
        print("â€¢ å”®åæœåŠ¡ï¼ˆÎ² = 0.245ï¼‰å’Œä¿¡æ¯é€æ˜åº¦ï¼ˆÎ² = 0.218ï¼‰å½±å“ç›¸å¯¹è¾ƒå¼±")
        print("â€¢ æ‰€æœ‰ä¸»è¦å› ç´ å‡åœ¨p < 0.001æ°´å¹³ä¸Šæ˜¾è‘—")
    
    def print_moderation_analysis(self):
        """è¾“å‡ºè°ƒèŠ‚æ•ˆåº”åˆ†æ"""
        print("\n" + "=" * 80)
        print("è°ƒèŠ‚æ•ˆåº”åˆ†æç»“æœ")
        print("=" * 80)
        
        print("\nä¼ä¸šè§„æ¨¡çš„è°ƒèŠ‚æ•ˆåº”ï¼š")
        print("-" * 60)
        print(f"{'äº¤äº’é¡¹':<20} {'ç³»æ•°':<8} {'tå€¼':<8} {'på€¼':<10} {'è°ƒèŠ‚æ•ˆåº”':<12}")
        print("-" * 60)
        
        for interaction, data in self.moderation_effects.items():
            print(f"{interaction:<20} {data['coef']:<8.3f} {data['t']:<8.2f} {data['p']:<10} {data['æ•ˆåº”']:<12}")
        
        print("\nè°ƒèŠ‚æ•ˆåº”åˆ†æç»“è®ºï¼š")
        print("â€¢ ä¼ä¸šè§„æ¨¡å¯¹æ‰€æœ‰å› ç´ ä¸æœåŠ¡è´¨é‡çš„å…³ç³»å‡æœ‰æ˜¾è‘—è°ƒèŠ‚ä½œç”¨")
        print("â€¢ ä¼ä¸šè§„æ¨¡å¯¹ç‰©æµé…é€çš„è°ƒèŠ‚æ•ˆåº”æœ€å¼ºï¼ˆÎ² = 0.158ï¼‰")
        print("â€¢ ä¼ä¸šè§„æ¨¡å¯¹åŠ å·¥å·¥è‰ºçš„è°ƒèŠ‚æ•ˆåº”æ¬¡ä¹‹ï¼ˆÎ² = 0.142ï¼‰")
        print("â€¢ å¤§å‹ä¼ä¸šåœ¨åŸæ–™è´¨é‡æ§åˆ¶å’Œç‰©æµé…é€æ–¹é¢è¡¨ç°æ›´ä¼˜")
        print("â€¢ æ‰€æœ‰è°ƒèŠ‚æ•ˆåº”å‡ä¸ºæ­£å‘ï¼Œè¡¨æ˜ä¼ä¸šè§„æ¨¡è¶Šå¤§ï¼Œå„å› ç´ å¯¹æœåŠ¡è´¨é‡çš„æ­£å‘å½±å“è¶Šå¼º")
    
    def print_hypothesis_testing(self):
        """è¾“å‡ºå‡è®¾æ£€éªŒç»“æœ"""
        print("\n" + "=" * 80)
        print("å‡è®¾æ£€éªŒç»“æœæ±‡æ€»")
        print("=" * 80)
        
        hypotheses = [
            ("H1", "åŸæ–™è´¨é‡å¯¹æœåŠ¡è´¨é‡æœ‰æ˜¾è‘—æ­£å‘å½±å“", "æ”¯æŒ", "Î²=0.352, p<0.001"),
            ("H2", "åŠ å·¥å·¥è‰ºå¯¹æœåŠ¡è´¨é‡æœ‰æ˜¾è‘—æ­£å‘å½±å“", "æ”¯æŒ", "Î²=0.285, p<0.001"),
            ("H3", "ç‰©æµé…é€å¯¹æœåŠ¡è´¨é‡æœ‰æ˜¾è‘—æ­£å‘å½±å“", "æ”¯æŒ", "Î²=0.312, p<0.001"),
            ("H4", "å”®åæœåŠ¡å¯¹æœåŠ¡è´¨é‡æœ‰æ˜¾è‘—æ­£å‘å½±å“", "æ”¯æŒ", "Î²=0.245, p<0.001"),
            ("H5", "ä¿¡æ¯é€æ˜åº¦å¯¹æœåŠ¡è´¨é‡æœ‰æ˜¾è‘—æ­£å‘å½±å“", "æ”¯æŒ", "Î²=0.218, p<0.001"),
            ("H6", "ä¼ä¸šè§„æ¨¡å¯¹å„å› ç´ ä¸æœåŠ¡è´¨é‡å…³ç³»æœ‰è°ƒèŠ‚ä½œç”¨", "æ”¯æŒ", "æ‰€æœ‰äº¤äº’é¡¹å‡æ˜¾è‘—")
        ]
        
        print(f"{'å‡è®¾':<6} {'å‡è®¾å†…å®¹':<30} {'ç»“æœ':<8} {'ç»Ÿè®¡è¯æ®':<20}")
        print("-" * 70)
        for h_id, content, result, evidence in hypotheses:
            print(f"{h_id:<6} {content:<30} {result:<8} {evidence:<20}")
        
        print(f"\nå‡è®¾æ£€éªŒæ€»ç»“ï¼š")
        print(f"â€¢ å…±æå‡º6ä¸ªä¸»è¦å‡è®¾ï¼Œå…¨éƒ¨å¾—åˆ°æ”¯æŒ")
        print(f"â€¢ æ‰€æœ‰å½±å“å› ç´ å‡åœ¨p < 0.001æ°´å¹³ä¸Šæ˜¾è‘—")
        print(f"â€¢ ä¼ä¸šè§„æ¨¡çš„è°ƒèŠ‚æ•ˆåº”å¾—åˆ°éªŒè¯")
        print(f"â€¢ ç ”ç©¶å‡è®¾å¾—åˆ°å……åˆ†çš„ç»Ÿè®¡å­¦è¯æ®æ”¯æŒ")
    
    def generate_summary_report(self):
        """ç”Ÿæˆç»Ÿè®¡ç»“è®ºæ€»ç»“æŠ¥å‘Š"""
        print("\n" + "=" * 80)
        print("ç¬¬äº”ç« æ•°å­¦ç»Ÿè®¡ç»“è®ºæ€»ç»“")
        print("=" * 80)
        
        print("\nğŸ“Š ä¸»è¦ç»Ÿè®¡å‘ç°ï¼š")
        print("1. æ ·æœ¬ç‰¹å¾ï¼š")
        print(f"   â€¢ æœ‰æ•ˆæ ·æœ¬ï¼š{self.sample_info['total_comments']:,}æ¡è¯„è®º")
        print(f"   â€¢ æ­£é¢è¯„ä»·å æ¯”ï¼š75.8%ï¼ˆ4-5æ˜Ÿè¯„ä»·ï¼‰")
        print(f"   â€¢ æœåŠ¡è´¨é‡å¹³å‡å¾—åˆ†ï¼š7.85åˆ†ï¼ˆæ»¡åˆ†10åˆ†ï¼‰")
        
        print("\n2. å½±å“å› ç´ æ’åºï¼ˆæŒ‰å›å½’ç³»æ•°ï¼‰ï¼š")
        factors = [
            ("åŸæ–™è´¨é‡", 0.352),
            ("ç‰©æµé…é€", 0.312),
            ("åŠ å·¥å·¥è‰º", 0.285),
            ("å”®åæœåŠ¡", 0.245),
            ("ä¿¡æ¯é€æ˜åº¦", 0.218)
        ]
        for i, (factor, coef) in enumerate(factors, 1):
            print(f"   {i}. {factor}ï¼šÎ² = {coef:.3f}")
        
        print("\n3. æ¨¡å‹æ€§èƒ½ï¼š")
        print(f"   â€¢ è§£é‡Šåº¦ï¼šRÂ² = {self.regression_results['æ¨¡å‹æ‹Ÿåˆåº¦']['RÂ²']:.3f}")
        print(f"   â€¢ æ¨¡å‹æ˜¾è‘—æ€§ï¼šF = {self.regression_results['æ¨¡å‹æ‹Ÿåˆåº¦']['F_statistic']:.2f}, p < 0.001")
        print(f"   â€¢ æ‰€æœ‰å‡è®¾å‡å¾—åˆ°æ”¯æŒ")
        
        print("\n4. è°ƒèŠ‚æ•ˆåº”ï¼š")
        print("   â€¢ ä¼ä¸šè§„æ¨¡å¯¹æ‰€æœ‰å› ç´ å‡æœ‰æ˜¾è‘—æ­£å‘è°ƒèŠ‚ä½œç”¨")
        print("   â€¢ å¤§å‹ä¼ä¸šåœ¨å„ç»´åº¦è¡¨ç°æ›´ä¼˜")
        
        print("\n5. å®è·µå¯ç¤ºï¼š")
        print("   â€¢ ä¼˜å…ˆå…³æ³¨åŸæ–™è´¨é‡ç®¡æ§ï¼ˆå½±å“æœ€å¤§ï¼‰")
        print("   â€¢ é‡è§†ç‰©æµé…é€ä½“ç³»å»ºè®¾")
        print("   â€¢ å®Œå–„åŠ å·¥å·¥è‰ºæ ‡å‡†åŒ–")
        print("   â€¢ æå‡å”®åæœåŠ¡æ°´å¹³")
        print("   â€¢ å¢å¼ºä¿¡æ¯é€æ˜åº¦")
        
        print("\n" + "=" * 80)
        print("ç»Ÿè®¡åˆ†æå®Œæˆ")
        print("=" * 80)
    
    def run_all_outputs(self):
        """è¿è¡Œæ‰€æœ‰ç»Ÿè®¡è¾“å‡º"""
        self.print_sample_overview()
        self.print_descriptive_statistics()
        self.print_correlation_analysis()
        self.print_regression_analysis()
        self.print_moderation_analysis()
        self.print_hypothesis_testing()
        self.generate_summary_report()

def main():
    """ä¸»å‡½æ•°"""
    print("ç¬¬äº”ç« æ•°å­¦ç»Ÿè®¡ç»“è®ºè¾“å‡ºç¨‹åº")
    print("åŸºäºè®ºæ–‡ä¸­çš„ç»Ÿè®¡åˆ†æç»“æœ")
    print("ä½œè€…ï¼šä¸­è¯æç”µå•†è¯„è®ºåˆ†æç³»ç»Ÿ")
    print("æ—¶é—´ï¼š2024å¹´")
    
    # åˆ›å»ºç»Ÿè®¡è¾“å‡ºå¯¹è±¡
    stats_output = Chapter5StatisticsOutput()
    
    # è¿è¡Œæ‰€æœ‰ç»Ÿè®¡è¾“å‡º
    stats_output.run_all_outputs()

if __name__ == "__main__":
    main() 