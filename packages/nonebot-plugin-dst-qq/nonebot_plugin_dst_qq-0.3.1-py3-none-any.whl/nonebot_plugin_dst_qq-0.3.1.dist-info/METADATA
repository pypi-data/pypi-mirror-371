Metadata-Version: 2.4
Name: nonebot-plugin-dst-qq
Version: 0.3.1
Summary: åŸºäº NoneBot2 çš„é¥¥è’ç®¡ç†å¹³å° (DMP) QQ æœºå™¨äººæ’ä»¶ï¼Œæ”¯æŒæ¸¸æˆä¿¡æ¯æŸ¥è¯¢ã€å‘½ä»¤æ‰§è¡Œå’Œæ¶ˆæ¯äº’é€šåŠŸèƒ½
Project-URL: Homepage, https://github.com/uitok/nonebot-plugin-dst-qq
Project-URL: Repository, https://github.com/uitok/nonebot-plugin-dst-qq
Project-URL: Documentation, https://github.com/uitok/nonebot-plugin-dst-qq#readme
Project-URL: Bug Tracker, https://github.com/uitok/nonebot-plugin-dst-qq/issues
Author-email: uitok <ui_101@qq.com>
License: MIT
License-File: LICENSE
Keywords: dmp,don't starve together,dst,message-exchange,nonebot,nonebot2,plugin,qq-bot,é¥¥è’
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Communications :: Chat
Classifier: Topic :: Games/Entertainment
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: <4.0,>=3.9
Requires-Dist: aiosqlite>=0.19.0
Requires-Dist: httpx>=0.24.0
Requires-Dist: nonebot-adapter-onebot>=2.4.0
Requires-Dist: nonebot-plugin-alconna>=0.22.0
Requires-Dist: nonebot-plugin-localstore>=0.6.0
Requires-Dist: nonebot2>=2.4.0
Requires-Dist: pillow>=10.0.0
Requires-Dist: pydantic
Requires-Dist: watchdog>=3.0.0
Provides-Extra: dev
Requires-Dist: black>=23.0.0; extra == 'dev'
Requires-Dist: flake8>=6.0.0; extra == 'dev'
Requires-Dist: isort>=5.12.0; extra == 'dev'
Requires-Dist: mypy>=1.0.0; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.21.0; extra == 'dev'
Requires-Dist: pytest>=7.0.0; extra == 'dev'
Description-Content-Type: text/markdown

# nonebot-plugin-dst-qq

[![PyPI](https://img.shields.io/pypi/v/nonebot-plugin-dst-qq)](https://pypi.org/project/nonebot-plugin-dst-qq/)
[![Python](https://img.shields.io/pypi/pyversions/nonebot-plugin-dst-qq)](https://pypi.org/pypi/nonebot-plugin-dst-qq/)
[![License](https://img.shields.io/pypi/l/nonebot-plugin-dst-qq)](https://pypi.org/project/nonebot-plugin-dst-qq/)

åŸºäº NoneBot2 å’Œ Alconna çš„é¥¥è’ç®¡ç†å¹³å° (DMP) QQ æœºå™¨äººæ’ä»¶ï¼Œæ”¯æŒæ¸¸æˆä¿¡æ¯æŸ¥è¯¢ã€å‘½ä»¤æ‰§è¡Œå’Œæ¶ˆæ¯äº’é€šåŠŸèƒ½ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

**æ–°ç”¨æˆ·ï¼Ÿ** æŸ¥çœ‹ [å¿«é€Ÿå¼€å§‹æŒ‡å—](QUICK_START.md) ç«‹å³ä½“éªŒï¼  
**è¯¦ç»†é…ç½®ï¼Ÿ** æŸ¥çœ‹ [é…ç½®è®¾ç½®æŒ‡å—](CONFIG_SETUP_GUIDE.md) äº†è§£æ‰€æœ‰é…ç½®é€‰é¡¹ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ® åŸºç¡€åŠŸèƒ½
- **ä¸–ç•Œä¿¡æ¯æŸ¥è¯¢** - è·å–æ¸¸æˆä¸–ç•ŒçŠ¶æ€ã€è¿è¡Œä¿¡æ¯
- **æˆ¿é—´ä¿¡æ¯æŸ¥è¯¢** - æŸ¥çœ‹æˆ¿é—´è®¾ç½®ã€å­£èŠ‚ä¿¡æ¯ã€ç©å®¶çŠ¶æ€
- **ç³»ç»Ÿä¿¡æ¯ç›‘æ§** - ç›‘æ§æœåŠ¡å™¨CPUã€å†…å­˜ä½¿ç”¨æƒ…å†µ
- **ç©å®¶ç®¡ç†** - æŸ¥çœ‹åœ¨çº¿ç©å®¶åˆ—è¡¨å’Œè¯¦ç»†ä¿¡æ¯
- **ç›´è¿ä¿¡æ¯** - è·å–æœåŠ¡å™¨ç›´è¿ä»£ç 

### ğŸ”§ ç®¡ç†åŠŸèƒ½
- **å¤‡ä»½ç®¡ç†** - æŸ¥çœ‹å’Œåˆ›å»ºæ¸¸æˆå¤‡ä»½æ–‡ä»¶
- **å‘½ä»¤æ‰§è¡Œ** - åœ¨æ¸¸æˆä¸­æ‰§è¡Œæ§åˆ¶å°å‘½ä»¤
- **ä¸–ç•Œå›æ¡£** - æ”¯æŒ1-5å¤©çš„ä¸–ç•Œå›æ¡£åŠŸèƒ½
- **ä¸–ç•Œé‡ç½®** - é‡ç½®æŒ‡å®šä¸–ç•Œï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
- **èŠå¤©å†å²** - æŸ¥çœ‹æ¸¸æˆå†…èŠå¤©è®°å½•
- **èŠå¤©ç»Ÿè®¡** - ç»Ÿè®¡èŠå¤©æ•°æ®å’Œä½¿ç”¨æƒ…å†µ

### ğŸ’¬ æ¶ˆæ¯äº’é€š
- **åŒå‘é€šä¿¡** - QQæ¶ˆæ¯ä¸æ¸¸æˆå†…æ¶ˆæ¯åŒå‘äº’é€š
- **å®æ—¶åŒæ­¥** - è‡ªåŠ¨åŒæ­¥æ¸¸æˆå†…æœ€æ–°æ¶ˆæ¯åˆ°QQ
- **ç”¨æˆ·ç®¡ç†** - æ”¯æŒå¤šç”¨æˆ·ç‹¬ç«‹çš„æ¶ˆæ¯äº’é€šè®¾ç½®
- **æ¶ˆæ¯è¿‡æ»¤** - æ™ºèƒ½è¿‡æ»¤å’Œæ ¼å¼åŒ–æ¶ˆæ¯å†…å®¹

### ğŸš€ Alconna ç‰¹æ€§
- **Alconna å‘½ä»¤ç³»ç»Ÿ**: ä½¿ç”¨å¼ºå¤§çš„ Alconna å‘½ä»¤è§£æå™¨ï¼Œæ”¯æŒæ™ºèƒ½å‚æ•°è§£æå’Œç±»å‹æ£€æŸ¥
- **æ™ºèƒ½é›†ç¾¤é€‰æ‹©**: è‡ªåŠ¨è·å–å¯ç”¨é›†ç¾¤ï¼Œæ™ºèƒ½é€‰æ‹©ç¬¬ä¸€ä¸ªå¯ç”¨é›†ç¾¤
- **ä¸­è‹±æ–‡æ”¯æŒ**: æ”¯æŒä¸­è‹±æ–‡å‘½ä»¤ï¼Œæ–¹ä¾¿ä¸åŒç”¨æˆ·ä½¿ç”¨
- **å‚æ•°ç±»å‹æ£€æŸ¥**: è‡ªåŠ¨ç±»å‹è½¬æ¢å’ŒéªŒè¯ï¼Œæ™ºèƒ½å‚æ•°è§£æï¼Œå‹å¥½çš„é”™è¯¯æç¤º
- **å¯é€‰å‚æ•°æ”¯æŒ**: ä½¿ç”¨æ–¹æ‹¬å· `[]` è¡¨ç¤ºå¯é€‰å‚æ•°ï¼Œä½¿ç”¨å°–æ‹¬å· `<>` è¡¨ç¤ºå¿…éœ€å‚æ•°

### ğŸ—„ï¸ æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§
- **å¤šçº§ç¼“å­˜ç³»ç»Ÿ**: ä¸‰å±‚ç¼“å­˜æ¶æ„ï¼Œæ™ºèƒ½TTLç®¡ç†ï¼Œå“åº”é€Ÿåº¦æå‡10-50å€
- **æ•°æ®å‹ç¼©å½’æ¡£**: è‡ªåŠ¨å‹ç¼©å’Œå½’æ¡£å†å²æ•°æ®ï¼ŒèŠ‚çœ70%+å­˜å‚¨ç©ºé—´
- **å®šæ—¶ä»»åŠ¡è°ƒåº¦**: è‡ªåŠ¨åŒ–æ•°æ®ç»´æŠ¤ï¼Œæ— éœ€äººå·¥å¹²é¢„
- **æ™ºèƒ½ç›‘æ§**: å®æ—¶ç³»ç»ŸçŠ¶æ€ç›‘æ§å’Œæ€§èƒ½åˆ†æ
- **æ‰¹é‡å¤„ç†**: é«˜æ•ˆçš„æ‰¹å¤„ç†æœºåˆ¶ï¼Œæ”¯æŒå¤§æ•°æ®é‡æ“ä½œ

## ğŸ› ï¸ å®‰è£…

### ç¯å¢ƒè¦æ±‚

- Python 3.9+
- NoneBot2 2.0+

### å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### é…ç½®

æœ¬æ’ä»¶æ”¯æŒ**æ™ºèƒ½é…ç½®ç³»ç»Ÿ**ï¼Œæä¾›å¤šç§é…ç½®æ–¹å¼æ»¡è¶³ä¸åŒç”¨æˆ·éœ€æ±‚ï¼š

#### ğŸ¯ å¿«é€Ÿé…ç½®ï¼ˆæ¨èæ–°æ‰‹ï¼‰

1. **å®‰è£…å¹¶é¦–æ¬¡å¯åŠ¨æ’ä»¶**
   ```bash
   pip install nonebot-plugin-dst-qq
   python bot.py  # é¦–æ¬¡å¯åŠ¨
   ```

2. **è‡ªåŠ¨ç”Ÿæˆé…ç½®æ–‡ä»¶**
   æ’ä»¶ä¼šè‡ªåŠ¨åˆ›å»ºé…ç½®æ–‡ä»¶ï¼ˆä½ç½®å–å†³äºå®‰è£…æ–¹å¼ï¼‰ï¼š
   ```
   # å¼€å‘æ¨¡å¼æˆ–æºç è¿è¡Œ
   æ‚¨çš„é¡¹ç›®ç›®å½•/nonebot_plugin_dst_qq/app_config.json
   
   # pipå®‰è£…æ¨¡å¼
   è™šæ‹Ÿç¯å¢ƒ/Lib/site-packages/nonebot_plugin_dst_qq/app_config.json
   ```

3. **ç¼–è¾‘å¿…è¦é…ç½®**
   åœæ­¢æœºå™¨äººï¼Œç¼–è¾‘ç”Ÿæˆçš„ `app_config.json`ï¼š
   ```json
   {
     "dmp": {
       "base_url": "http://ä½ çš„DMPæœåŠ¡å™¨:ç«¯å£/v1",
       "token": "ä½ çš„DMPä»¤ç‰Œ"
     },
     "bot": {
       "superusers": ["ä½ çš„QQå·"]
     }
   }
   ```

4. **é‡æ–°å¯åŠ¨æœºå™¨äºº**
   ```bash
   python bot.py
   ```

#### ğŸ”§ é…ç½®æ–‡ä»¶ä½ç½®

é…ç½®æ–‡ä»¶ä½ç½®å–å†³äºå®‰è£…æ–¹å¼ï¼š

**å¼€å‘æ¨¡å¼/æºç è¿è¡Œ**:
```
æ‚¨çš„é¡¹ç›®ç›®å½•/nonebot_plugin_dst_qq/app_config.json
```

**pipæ ‡å‡†å®‰è£…**:  
```
è™šæ‹Ÿç¯å¢ƒ/Lib/site-packages/nonebot_plugin_dst_qq/app_config.json
```

ğŸ’¡ **å¦‚ä½•æ‰¾åˆ°é…ç½®æ–‡ä»¶**ï¼š
- æŸ¥çœ‹æœºå™¨äººå¯åŠ¨æ—¥å¿—ä¸­çš„é…ç½®æ–‡ä»¶è·¯å¾„
- ä½¿ç”¨å‘½ä»¤ `/é…ç½®æŸ¥çœ‹` æŸ¥çœ‹å½“å‰é…ç½®
- Windows: `dir /s app_config.json`
- Linux/macOS: `find . -name "app_config.json"`

#### ğŸ”„ é…ç½®çƒ­é‡è½½

æ”¯æŒé…ç½®æ–‡ä»¶å®æ—¶æ›´æ–°ï¼Œæ— éœ€é‡å¯æœºå™¨äººï¼š
1. ç¼–è¾‘ `app_config.json` æ–‡ä»¶
2. ä¿å­˜æ–‡ä»¶ï¼ˆçº¦1ç§’åè‡ªåŠ¨é‡è½½ï¼‰
3. å‘é€ `/é…ç½®æŸ¥çœ‹` ç¡®è®¤æ›´æ–°

#### æ–¹å¼äºŒï¼šç¯å¢ƒå˜é‡é…ç½®ï¼ˆç®€åŒ–é…ç½®ï¼‰

åœ¨ `.env` æ–‡ä»¶ä¸­æ·»åŠ åŸºç¡€é…ç½®ï¼š

```env
# DMP æœåŠ¡å™¨é…ç½®
DMP_BASE_URL=http://your-dmp-server:port/v1
DMP_TOKEN=your-jwt-token

# OneBot é…ç½®
ONEBOT_WS_URLS=["ws://your-onebot-server:port"]
ONEBOT_ACCESS_TOKEN=your-access-token

# è¶…çº§ç”¨æˆ·é…ç½®
SUPERUSERS=["ä½ çš„QQå·"]
```

#### ğŸ“‹ è¯¦ç»†é…ç½®æŒ‡å—

æŸ¥çœ‹å®Œæ•´çš„é…ç½®è®¾ç½®æŒ‡å—ï¼š[CONFIG_SETUP_GUIDE.md](CONFIG_SETUP_GUIDE.md)

##### ğŸ”§ DMP æœåŠ¡å™¨é…ç½® (å¿…éœ€)

```json
{
  "dmp": {
    "base_url": "https://your-dmp-server.com:8080/v1",
    "token": "your_dmp_token_here",
    "timeout": 10.0,
    "max_retries": 3,
    "retry_delay": 1.0,
    "auto_discover_clusters": true,
    "cluster_cache_ttl": 300
  }
}
```

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ | å¿…éœ€ |
|--------|------|--------|------|
| `base_url` | DMPæœåŠ¡å™¨åœ°å€ï¼ˆåŒ…å«ç«¯å£ï¼‰ | `https://your-dmp-server.com` | âœ… |
| `token` | DMP APIè®¿é—®ä»¤ç‰Œ | `your_dmp_token_here` | âœ… |
| `timeout` | è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ | `10.0` | âŒ |
| `max_retries` | æœ€å¤§é‡è¯•æ¬¡æ•° | `3` | âŒ |
| `retry_delay` | é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰ | `1.0` | âŒ |
| `auto_discover_clusters` | æ˜¯å¦è‡ªåŠ¨å‘ç°é›†ç¾¤ | `true` | âŒ |
| `cluster_cache_ttl` | é›†ç¾¤ä¿¡æ¯ç¼“å­˜æ—¶é—´ï¼ˆç§’ï¼‰ | `300` | âŒ |

##### ğŸ‘¥ æœºå™¨äººæƒé™é…ç½®

```json
{
  "bot": {
    "superusers": ["123456789"],
    "admin_groups": [],
    "allowed_groups": [],
    "command_prefix": "/",
    "enable_private_chat": true,
    "enable_group_chat": true
  }
}
```

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ | å¿…éœ€ |
|--------|------|--------|------|
| `superusers` | è¶…çº§ç”¨æˆ·QQå·åˆ—è¡¨ | `[]` | âœ… |
| `admin_groups` | ç®¡ç†å‘˜ç¾¤ç»„åˆ—è¡¨ | `[]` | âŒ |
| `allowed_groups` | å…è®¸ä½¿ç”¨çš„ç¾¤ç»„åˆ—è¡¨ï¼ˆç©ºè¡¨ç¤ºä¸é™åˆ¶ï¼‰ | `[]` | âŒ |
| `command_prefix` | å‘½ä»¤å‰ç¼€ | `"/"` | âŒ |
| `enable_private_chat` | æ˜¯å¦å¯ç”¨ç§èŠåŠŸèƒ½ | `true` | âŒ |
| `enable_group_chat` | æ˜¯å¦å¯ç”¨ç¾¤èŠåŠŸèƒ½ | `true` | âŒ |

##### ğŸ’¬ æ¶ˆæ¯äº’é€šé…ç½®

```json
{
  "message": {
    "enable_message_bridge": true,
    "sync_interval": 3.0,
    "max_message_length": 200,
    "default_chat_mode": "private",
    "allow_group_chat": true,
    "allow_private_chat": true,
    "default_target_cluster": "",
    "default_target_world": "Master",
    "auto_select_world": true,
    "filter_system_messages": true,
    "filter_qq_messages": true,
    "blocked_words": [],
    "blocked_players": [],
    "qq_to_game_template": "[QQ] {username}: {message}",
    "game_to_qq_template": "ğŸ® [{cluster}] {player}: {message}",
    "system_message_template": "ğŸ“¢ [{cluster}] ç³»ç»Ÿ: {message}",
    "enable_message_cache": true,
    "cache_duration": 300,
    "max_batch_size": 5,
    "dedupe_window": 60,
    "notify_connection_status": true,
    "notify_new_users": true,
    "show_player_join_leave": false
  }
}
```

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `enable_message_bridge` | æ˜¯å¦å¯ç”¨æ¶ˆæ¯äº’é€šåŠŸèƒ½ | `true` |
| `sync_interval` | æ¶ˆæ¯åŒæ­¥é—´éš”ï¼ˆç§’ï¼‰ | `3.0` |
| `max_message_length` | å•æ¡æ¶ˆæ¯æœ€å¤§é•¿åº¦é™åˆ¶ | `200` |
| `default_chat_mode` | é»˜è®¤èŠå¤©æ¨¡å¼ï¼ˆprivate/groupï¼‰ | `"private"` |
| `allow_group_chat` | æ˜¯å¦å…è®¸ç¾¤èŠæ¶ˆæ¯äº’é€š | `true` |
| `allow_private_chat` | æ˜¯å¦å…è®¸ç§èŠæ¶ˆæ¯äº’é€š | `true` |
| `default_target_cluster` | é»˜è®¤ç›®æ ‡é›†ç¾¤ï¼ˆç©ºå€¼è‡ªåŠ¨é€‰æ‹©ï¼‰ | `""` |
| `default_target_world` | é»˜è®¤ç›®æ ‡ä¸–ç•Œ | `"Master"` |
| `auto_select_world` | æ˜¯å¦è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„ä¸–ç•Œ | `true` |
| `filter_system_messages` | æ˜¯å¦è¿‡æ»¤ç³»ç»Ÿæ¶ˆæ¯ | `true` |
| `filter_qq_messages` | æ˜¯å¦è¿‡æ»¤æ¥è‡ªQQçš„æ¶ˆæ¯ï¼ˆé¿å…å¾ªç¯ï¼‰ | `true` |
| `blocked_words` | å±è”½è¯åˆ—è¡¨ | `[]` |
| `blocked_players` | å±è”½ç©å®¶åˆ—è¡¨ | `[]` |
| `qq_to_game_template` | QQåˆ°æ¸¸æˆçš„æ¶ˆæ¯æ¨¡æ¿ | `"[QQ] {username}: {message}"` |
| `game_to_qq_template` | æ¸¸æˆåˆ°QQçš„æ¶ˆæ¯æ¨¡æ¿ | `"ğŸ® [{cluster}] {player}: {message}"` |
| `system_message_template` | ç³»ç»Ÿæ¶ˆæ¯æ¨¡æ¿ | `"ğŸ“¢ [{cluster}] ç³»ç»Ÿ: {message}"` |
| `enable_message_cache` | æ˜¯å¦å¯ç”¨æ¶ˆæ¯ç¼“å­˜ | `true` |
| `cache_duration` | æ¶ˆæ¯ç¼“å­˜æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰ | `300` |
| `max_batch_size` | æ‰¹é‡æ¶ˆæ¯å¤„ç†å¤§å° | `5` |
| `dedupe_window` | æ¶ˆæ¯å»é‡æ—¶é—´çª—å£ï¼ˆç§’ï¼‰ | `60` |
| `notify_connection_status` | æ˜¯å¦é€šçŸ¥è¿æ¥çŠ¶æ€å˜åŒ– | `true` |
| `notify_new_users` | æ˜¯å¦é€šçŸ¥æ–°ç”¨æˆ·åŠ å…¥äº’é€š | `true` |
| `show_player_join_leave` | æ˜¯å¦æ˜¾ç¤ºç©å®¶è¿›å‡ºæœåŠ¡å™¨æ¶ˆæ¯ | `false` |

##### ğŸ—„ï¸ ç¼“å­˜é…ç½®

```json
{
  "cache": {
    "memory_max_size": 1000,
    "memory_default_ttl": 300,
    "file_cache_dir": "./cache",
    "file_max_size": 10000,
    "file_default_ttl": 1800,
    "cleanup_interval": 3600,
    "auto_cleanup": true
  }
}
```

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `memory_max_size` | å†…å­˜ç¼“å­˜æœ€å¤§æ¡ç›®æ•° | `1000` |
| `memory_default_ttl` | å†…å­˜ç¼“å­˜é»˜è®¤TTLï¼ˆç§’ï¼‰ | `300` |
| `file_cache_dir` | æ–‡ä»¶ç¼“å­˜ç›®å½• | `"./cache"` |
| `file_max_size` | æ–‡ä»¶ç¼“å­˜æœ€å¤§æ¡ç›®æ•° | `10000` |
| `file_default_ttl` | æ–‡ä»¶ç¼“å­˜é»˜è®¤TTLï¼ˆç§’ï¼‰ | `1800` |
| `cleanup_interval` | ç¼“å­˜æ¸…ç†é—´éš”ï¼ˆç§’ï¼‰ | `3600` |
| `auto_cleanup` | æ˜¯å¦å¯ç”¨è‡ªåŠ¨æ¸…ç† | `true` |

##### ğŸ“ æ—¥å¿—é…ç½®

```json
{
  "logging": {
    "level": "INFO",
    "format": "text",
    "log_to_file": true,
    "log_file_path": "./logs/app.log",
    "max_file_size": 10485760,
    "backup_count": 5
  }
}
```

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `level` | æ—¥å¿—çº§åˆ« (DEBUG/INFO/WARNING/ERROR/CRITICAL) | `"INFO"` |
| `format` | æ—¥å¿—æ ¼å¼ (text/json) | `"text"` |
| `log_to_file` | æ˜¯å¦è®°å½•åˆ°æ–‡ä»¶ | `true` |
| `log_file_path` | æ—¥å¿—æ–‡ä»¶è·¯å¾„ | `"./logs/app.log"` |
| `max_file_size` | æ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°ï¼ˆå­—èŠ‚ï¼‰ | `10485760` |
| `backup_count` | æ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°é‡ | `5` |

#### ğŸ”„ é…ç½®çƒ­é‡è½½

æœ¬æ’ä»¶æ”¯æŒé…ç½®çƒ­é‡è½½åŠŸèƒ½ï¼Œå½“æ‚¨ä¿®æ”¹ `app_config.json` æ–‡ä»¶å¹¶ä¿å­˜åï¼Œæ’ä»¶ä¼šè‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®ï¼Œæ— éœ€é‡å¯æœºå™¨äººã€‚

#### âš ï¸ é…ç½®æ³¨æ„äº‹é¡¹

1. **DMPæœåŠ¡å™¨é…ç½®**ï¼š`base_url` å’Œ `token` æ˜¯å¿…éœ€çš„ï¼Œè¯·ç¡®ä¿æ­£ç¡®è®¾ç½®
2. **è¶…çº§ç”¨æˆ·é…ç½®**ï¼šè‡³å°‘éœ€è¦è®¾ç½®ä¸€ä¸ªè¶…çº§ç”¨æˆ·æ‰èƒ½ä½¿ç”¨ç®¡ç†åŠŸèƒ½
3. **æ¶ˆæ¯äº’é€š**ï¼šå»ºè®®å°† `sync_interval` è®¾ç½®åœ¨ 3-10 ç§’ä¹‹é—´ï¼Œè¿‡çŸ­å¯èƒ½å½±å“æ€§èƒ½
4. **ç¼“å­˜é…ç½®**ï¼šé»˜è®¤é…ç½®é€‚åˆå¤§å¤šæ•°åœºæ™¯ï¼Œé«˜è´Ÿè½½æƒ…å†µä¸‹å¯é€‚å½“è°ƒæ•´

## ğŸ“š ä½¿ç”¨è¯´æ˜

### åŸºç¡€å‘½ä»¤

| å‘½ä»¤ | è‹±æ–‡åˆ«å | åŠŸèƒ½ | å‚æ•° |
|------|----------|------|------|
| `ä¸–ç•Œ [é›†ç¾¤]` | `world [é›†ç¾¤]` | è·å–ä¸–ç•Œä¿¡æ¯ | é›†ç¾¤åç§°ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨é€‰æ‹©ï¼‰ |
| `æˆ¿é—´ [é›†ç¾¤]` | `room [é›†ç¾¤]` | è·å–æˆ¿é—´ä¿¡æ¯ | é›†ç¾¤åç§°ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨é€‰æ‹©ï¼‰ |
| `ç³»ç»Ÿ` | `sys` | è·å–ç³»ç»Ÿä¿¡æ¯ | æ—  |
| `ç©å®¶ [é›†ç¾¤]` | `players [é›†ç¾¤]` | è·å–åœ¨çº¿ç©å®¶åˆ—è¡¨ | é›†ç¾¤åç§°ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨é€‰æ‹©ï¼‰ |
| `ç›´è¿ [é›†ç¾¤]` | `connection [é›†ç¾¤]` | è·å–æœåŠ¡å™¨ç›´è¿ä¿¡æ¯ | é›†ç¾¤åç§°ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨é€‰æ‹©ï¼‰ |
| `èœå•` | `help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | æ—  |

### ç®¡ç†å‘˜å‘½ä»¤

| å‘½ä»¤ | è‹±æ–‡åˆ«å | åŠŸèƒ½ | å‚æ•° |
|------|----------|------|------|
| `ç®¡ç†å‘½ä»¤` | `admin` | æ˜¾ç¤ºç®¡ç†å‘˜åŠŸèƒ½èœå• | æ—  |
| `æŸ¥çœ‹å¤‡ä»½` | `backup` | è·å–å¤‡ä»½æ–‡ä»¶åˆ—è¡¨ | è‡ªåŠ¨é€‰æ‹©é›†ç¾¤ |
| `åˆ›å»ºå¤‡ä»½` | `createbackup` | æ‰‹åŠ¨åˆ›å»ºå¤‡ä»½ | è‡ªåŠ¨é€‰æ‹©é›†ç¾¤ |
| `æ‰§è¡Œå‘½ä»¤ <å‘½ä»¤>` | `exec <å‘½ä»¤>` | æ‰§è¡Œæ¸¸æˆå‘½ä»¤ | å‘½ä»¤å†…å®¹ |
| `å›æ»šä¸–ç•Œ <å¤©æ•°>` | `rollback <å¤©æ•°>` | å›æ¡£æŒ‡å®šå¤©æ•° | å¤©æ•°ï¼ˆ1-5ï¼‰ |
| `é‡ç½®ä¸–ç•Œ [ä¸–ç•Œ]` | `reset [ä¸–ç•Œ]` | é‡ç½®ä¸–ç•Œ | ä¸–ç•Œåç§°ï¼ˆå¯é€‰ï¼Œé»˜è®¤Masterï¼‰ |
| `èŠå¤©å†å² [ä¸–ç•Œ] [è¡Œæ•°]` | `chathistory [ä¸–ç•Œ] [è¡Œæ•°]` | è·å–èŠå¤©å†å² | ä¸–ç•Œåç§°ï¼ˆå¯é€‰ï¼‰ã€è¡Œæ•°ï¼ˆå¯é€‰ï¼Œé»˜è®¤50ï¼‰ |
| `èŠå¤©ç»Ÿè®¡` | `chatstats` | è·å–èŠå¤©å†å²ç»Ÿè®¡ä¿¡æ¯ | è‡ªåŠ¨é€‰æ‹©é›†ç¾¤ |

### æ¶ˆæ¯äº’é€šåŠŸèƒ½

| å‘½ä»¤ | è‹±æ–‡åˆ«å | åŠŸèƒ½ | å‚æ•° |
|------|----------|------|------|
| `æ¶ˆæ¯äº’é€š` | `exchange` | å¼€å¯æ¸¸æˆå†…æ¶ˆæ¯ä¸QQæ¶ˆæ¯äº’é€š | æ—  |
| `å…³é—­äº’é€š` | `closeexchange` | å…³é—­æ¶ˆæ¯äº’é€šåŠŸèƒ½ | æ—  |
| `äº’é€šçŠ¶æ€` | `exchangestatus` | æŸ¥çœ‹å½“å‰äº’é€šçŠ¶æ€ | æ—  |
| `æœ€æ–°æ¶ˆæ¯ [ä¸–ç•Œ] [æ•°é‡]` | `latestmessages [ä¸–ç•Œ] [æ•°é‡]` | è·å–æ¸¸æˆå†…æœ€æ–°æ¶ˆæ¯ | ä¸–ç•Œåç§°ï¼ˆå¯é€‰ï¼‰ã€æ•°é‡ï¼ˆå¯é€‰ï¼Œé»˜è®¤10ï¼‰ |

## ğŸŒ DMP API æ¥å£æ–‡æ¡£

### åŸºç¡€ä¿¡æ¯

**åŸºç¡€URL**: `http://your-server:port/v1`

**è®¤è¯æ–¹å¼**: å¤§éƒ¨åˆ†APIéœ€è¦JWT Tokenè®¤è¯ï¼Œåœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `Authorization: <token>`

### ä¸»è¦æ¥å£

#### 1. è®¤è¯æ¨¡å— (Auth)

##### 1.1 ç”¨æˆ·ç™»å½•
- **æ¥å£**: `POST /login`
- **æè¿°**: ç”¨æˆ·ç™»å½•è·å–JWT Token
- **è¯·æ±‚ä½“**:
```json
{
  "loginForm": {
    "username": "ç”¨æˆ·å",
    "password": "å¯†ç "
  }
}
```

##### 1.2 è·å–ç”¨æˆ·ä¿¡æ¯
- **æ¥å£**: `GET /userinfo`
- **æè¿°**: è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯
- **è®¤è¯**: éœ€è¦Token

#### 2. æ¸¸æˆç®¡ç†æ¨¡å—

##### 2.1 è·å–ä¸–ç•Œä¿¡æ¯
- **æ¥å£**: `GET /home/world`
- **æè¿°**: è·å–æŒ‡å®šé›†ç¾¤çš„ä¸–ç•Œä¿¡æ¯
- **å‚æ•°**: `clusterName` (é›†ç¾¤åç§°)
- **è®¤è¯**: éœ€è¦Token

##### 2.2 è·å–æˆ¿é—´ä¿¡æ¯
- **æ¥å£**: `GET /home/room`
- **æè¿°**: è·å–æŒ‡å®šé›†ç¾¤çš„æˆ¿é—´ä¿¡æ¯
- **å‚æ•°**: `clusterName` (é›†ç¾¤åç§°)
- **è®¤è¯**: éœ€è¦Token

##### 2.3 è·å–åœ¨çº¿ç©å®¶
- **æ¥å£**: `GET /home/players`
- **æè¿°**: è·å–æŒ‡å®šé›†ç¾¤çš„åœ¨çº¿ç©å®¶åˆ—è¡¨
- **å‚æ•°**: `clusterName` (é›†ç¾¤åç§°)
- **è®¤è¯**: éœ€è¦Token

##### 2.4 è·å–ç³»ç»Ÿä¿¡æ¯
- **æ¥å£**: `GET /home/sys`
- **æè¿°**: è·å–ç³»ç»ŸçŠ¶æ€ä¿¡æ¯
- **è®¤è¯**: éœ€è¦Token

#### 3. å¤‡ä»½ç®¡ç†æ¨¡å—

##### 3.1 è·å–å¤‡ä»½åˆ—è¡¨
- **æ¥å£**: `GET /tools/backup`
- **æè¿°**: è·å–å¤‡ä»½æ–‡ä»¶åˆ—è¡¨
- **å‚æ•°**: `clusterName` (é›†ç¾¤åç§°)
- **è®¤è¯**: éœ€è¦Token

##### 3.2 åˆ›å»ºå¤‡ä»½
- **æ¥å£**: `POST /backup/create`
- **æè¿°**: æ‰‹åŠ¨åˆ›å»ºå¤‡ä»½
- **å‚æ•°**: `clusterName` (é›†ç¾¤åç§°)
- **è®¤è¯**: éœ€è¦Token

#### 4. å‘½ä»¤æ‰§è¡Œæ¨¡å—

##### 4.1 æ‰§è¡Œæ¸¸æˆå‘½ä»¤
- **æ¥å£**: `POST /home/exec`
- **æè¿°**: åœ¨æ¸¸æˆå†…æ‰§è¡Œæ§åˆ¶å°å‘½ä»¤
- **è¯·æ±‚ä½“**:
```json
{
  "type": "console",
  "extraData": "å‘½ä»¤å†…å®¹",
  "clusterName": "é›†ç¾¤åç§°",
  "worldName": "ä¸–ç•Œåç§°"
}
```

##### 4.2 å›æ¡£ç®¡ç†
- **æ¥å£**: `POST /home/exec`
- **æè¿°**: æ‰§è¡ŒæŒ‡å®šé›†ç¾¤çš„å›æ¡£æ“ä½œ
- **è¯·æ±‚ä½“**:
```json
{
  "type": "rollback",
  "extraData": å¤©æ•°,
  "clusterName": "é›†ç¾¤åç§°",
  "worldName": ""
}
```

#### 5. èŠå¤©ç®¡ç†æ¨¡å—

##### 5.1 è·å–èŠå¤©å†å²
- **æ¥å£**: `GET /home/chat`
- **æè¿°**: è·å–æŒ‡å®šä¸–ç•Œçš„èŠå¤©å†å²
- **å‚æ•°**: `clusterName` (é›†ç¾¤åç§°), `worldName` (ä¸–ç•Œåç§°), `lines` (è¡Œæ•°)
- **è®¤è¯**: éœ€è¦Token

##### 5.2 è·å–èŠå¤©ç»Ÿè®¡
- **æ¥å£**: `GET /home/chat/stats`
- **æè¿°**: è·å–èŠå¤©ç»Ÿè®¡ä¿¡æ¯
- **å‚æ•°**: `clusterName` (é›†ç¾¤åç§°)
- **è®¤è¯**: éœ€è¦Token

## ğŸ”§ å¼€å‘

### ç¯å¢ƒè¦æ±‚

- Python >= 3.9
- NoneBot2 >= 2.4.0
- OneBot V11 é€‚é…å™¨

### æœ¬åœ°å¼€å‘

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/uitok/nonebot-plugin-dst-qq.git
cd nonebot-plugin-dst-qq

# å®‰è£…å¼€å‘ä¾èµ–
pip install -e ".[dev]"

# è¿è¡Œæµ‹è¯•
pytest
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v0.2.8 (2024-12-30) - ğŸš€ æ€§èƒ½ä¸ä¼˜åŒ–å¤§ç‰ˆæœ¬

#### ğŸ‰ é‡å¤§æ–°åŠŸèƒ½
- âœ¨ **å¤šçº§ç¼“å­˜ç³»ç»Ÿ**: ä¸‰å±‚ç¼“å­˜æ¶æ„ï¼Œæ€§èƒ½æå‡10-50å€
- ğŸ“¦ **æ•°æ®å‹ç¼©å½’æ¡£**: æ™ºèƒ½æ•°æ®ç®¡ç†ï¼ŒèŠ‚çœ70%+å­˜å‚¨ç©ºé—´
- âš™ï¸ **çƒ­é‡è½½é…ç½®**: æ”¯æŒé…ç½®æ–‡ä»¶å®æ—¶æ›´æ–°
- ğŸ¯ **æ™ºèƒ½é›†ç¾¤ç®¡ç†**: è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜å¯ç”¨é›†ç¾¤
- ğŸ› ï¸ **ç¼“å­˜ç®¡ç†å‘½ä»¤**: å®Œæ•´çš„ç¼“å­˜çŠ¶æ€ç›‘æ§å’Œç®¡ç†

#### ğŸ’¾ æ•°æ®å­˜å‚¨æ ‡å‡†åŒ–
- âœ¨ **LocalStoreé›†æˆ**: ä½¿ç”¨ `nonebot-plugin-localstore` æ ‡å‡†åŒ–å­˜å‚¨
- ğŸ”„ **è‡ªåŠ¨æ•°æ®è¿ç§»**: æ— ç¼ä»æ—§ç‰ˆæœ¬å‡çº§ï¼Œè‡ªåŠ¨è¿ç§»ç°æœ‰æ•°æ®
- ğŸ“ **è·¨å¹³å°è·¯å¾„**: è‡ªåŠ¨å¤„ç†Windows/Linux/macOSè·¯å¾„å·®å¼‚
- ğŸ›¡ï¸ **æ•°æ®éš”ç¦»**: æ¯ä¸ªæ’ä»¶ç‹¬ç«‹æ•°æ®ç›®å½•

#### ğŸ¨ ç•Œé¢å’Œä½“éªŒä¼˜åŒ–
- ğŸ“± **æ¶ˆæ¯æ˜¾ç¤ºä¼˜åŒ–**: æˆ¿é—´ã€ä¸–ç•Œã€ç©å®¶ä¿¡æ¯æ˜¾ç¤ºæ ¼å¼ç®€åŒ–
- ğŸ“Š **å›¾æ ‡ç»Ÿä¸€**: ä½¿ç”¨ğŸ“Šæ›¿ä»£ğŸ§ å›¾æ ‡ï¼Œæ›´åŠ ä¸“ä¸šç›´è§‚
- ğŸŸ¢ **çŠ¶æ€æŒ‡ç¤º**: ç›´è§‚çš„çŠ¶æ€å›¾æ ‡å’Œæ€§èƒ½ç›‘æ§
- ğŸŒ **ä¸–ç•Œç±»å‹åŒºåˆ†**: ä¸»ä¸–ç•ŒğŸŒå’Œæ´ç©´ğŸ•³ï¸å›¾æ ‡åŒºåˆ†

#### ğŸ“š å®Œå–„æ–‡æ¡£ç³»ç»Ÿ
- ğŸ“‹ **ç¼“å­˜ä¼˜åŒ–æŒ‡å—**: [CACHE_OPTIMIZATION_GUIDE.md](CACHE_OPTIMIZATION_GUIDE.md)
- ğŸ—œï¸ **æ•°æ®å‹ç¼©æŒ‡å—**: [DATA_COMPRESSION_GUIDE.md](DATA_COMPRESSION_GUIDE.md)
- ğŸ”„ **æ•°æ®è¿ç§»æŒ‡å—**: [DATA_MIGRATION_GUIDE.md](DATA_MIGRATION_GUIDE.md)
- âš™ï¸ **é…ç½®è¯´æ˜æ›´æ–°**: [CONFIGURATION.md](CONFIGURATION.md)

#### ğŸš€ æ€§èƒ½ä¼˜åŒ–
- âš¡ **å“åº”é€Ÿåº¦**: å¹³å‡å“åº”æ—¶é—´æå‡7.5å€
- ğŸ’¾ **å†…å­˜ä¼˜åŒ–**: å‡å°‘40%çš„å†…å­˜ä½¿ç”¨
- ğŸ“Š **æŸ¥è¯¢ä¼˜åŒ–**: æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½æå‡80%
- ğŸŒ **ç½‘ç»œä¼˜åŒ–**: APIè°ƒç”¨é¢‘ç‡å‡å°‘75%

### v0.2.4

#### ğŸ‰ æ–°åŠŸèƒ½
- âœ¨ æ–°å¢ `/æŸ¥çœ‹å¤‡ä»½` å‘½ä»¤ï¼Œæ›¿ä»£åŸæœ‰çš„ `/å¤‡ä»½` å‘½ä»¤
- ğŸ¨ ä¼˜åŒ–å¤‡ä»½åˆ—è¡¨æ˜¾ç¤ºæ ¼å¼ï¼Œæ”¯æŒæ–‡ä»¶å¤§å°è‡ªåŠ¨è½¬æ¢ï¼ˆKB/MB/GBï¼‰
- ğŸ“Š æ·»åŠ ç£ç›˜ä½¿ç”¨ç‡æ˜¾ç¤º
- ğŸ”§ æ”¹è¿›å¤‡ä»½æ–‡ä»¶ä¿¡æ¯å±•ç¤ºï¼ŒåŒ…å«åˆ›å»ºæ—¶é—´ã€æ–‡ä»¶å¤§å°ã€æ¸¸æˆå‘¨æœŸ

#### ğŸ› ä¿®å¤
- ğŸ”§ ä¿®å¤æ’ä»¶åŠ è½½æ—¶çš„ç›¸å¯¹å¯¼å…¥é—®é¢˜
- ğŸ› ï¸ è§£å†³ `name 'config' is not defined` é”™è¯¯
- ğŸ”§ ç»Ÿä¸€é…ç½®è·å–æ–¹å¼ï¼Œä½¿ç”¨ `get_config()` å‡½æ•°
- ğŸ› ï¸ ä¿®å¤å¤‡ä»½åˆ—è¡¨æ•°æ®å¤„ç†ä¸­çš„åˆ‡ç‰‡é”™è¯¯

#### ğŸ¨ ä¼˜åŒ–
- ğŸ“± æ”¹è¿›æ¶ˆæ¯æ˜¾ç¤ºæ ¼å¼ï¼Œä½¿ç”¨emojiå’Œåˆ†éš”çº¿æå‡å¯è¯»æ€§
- ğŸ”§ ä¼˜åŒ–é”™è¯¯å¤„ç†å’Œç±»å‹æ£€æŸ¥
- ğŸ“ æ›´æ–°ç®¡ç†å‘½ä»¤èœå•ï¼Œåæ˜ æ–°çš„å‘½ä»¤åç§°
- ğŸ¯ æå‡æ’ä»¶ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒ

#### ğŸ”§ æŠ€æœ¯æ”¹è¿›
- ğŸ”§ é‡æ„æ’ä»¶åŠ è½½æœºåˆ¶ï¼Œä½¿ç”¨ `require()` å‡½æ•°
- ğŸ› ï¸ ç®€åŒ–ç›¸å¯¹å¯¼å…¥é€»è¾‘ï¼Œç§»é™¤å¤æ‚çš„ `sys.path` æ“ä½œ
- ğŸ“¦ æ›´æ–°é¡¹ç›®ç»“æ„ï¼Œç¬¦åˆ NoneBot2 æ’ä»¶å‘å¸ƒè§„èŒƒ
- ğŸ”§ ä¼˜åŒ–ä¾èµ–æ³¨å…¥å’Œé…ç½®ç®¡ç†

### v0.2.3
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- åŸºç¡€åŠŸèƒ½å®ç°
- æ¶ˆæ¯äº’é€šåŠŸèƒ½

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [NoneBot2](https://nonebot.dev/) - ä¼˜ç§€çš„æœºå™¨äººæ¡†æ¶
- [OneBot](https://onebot.dev/) - ç»Ÿä¸€çš„èŠå¤©æœºå™¨äººåº”ç”¨æ¥å£æ ‡å‡†
- [DMP](https://github.com/miracleEverywhere/dst-management-platform-api) - é¥¥è’ç®¡ç†å¹³å°

## ğŸ“ è”ç³»æ–¹å¼

- ä½œè€…ï¼šuitok
- é‚®ç®±ï¼šui_101@qq.com
- é¡¹ç›®ä¸»é¡µï¼š[https://github.com/uitok/nonebot-plugin-dst-qq](https://github.com/uitok/nonebot-plugin-dst-qq)

---

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ï¸ æ”¯æŒä¸€ä¸‹ï¼
