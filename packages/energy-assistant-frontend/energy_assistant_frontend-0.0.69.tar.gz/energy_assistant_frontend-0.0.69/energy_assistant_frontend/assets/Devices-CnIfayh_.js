import{g as te,p as ae,h as le,B as r,a6 as me,a7 as ve,H as J,X as R,c as s,a8 as fe,U as ge,N as pe,t as Q,f as E,a9 as Ve,b as w,n as be,a as se,G as _e,aa as ye,a1 as he,a4 as we,k as De,$ as l,I as xe,K as T,d as L,w as i,o as P,s as H,v as Ee,F as qe,x as C,y as g,z as n,C as A,W as ke}from"./index-DPl16C00.js";import{V as Pe}from"./VContainer-DfBRv9y0.js";import{V as Ce,a as Ie}from"./VRow-Dwx696kb.js";import{c as Fe,b as W,a as M,d as G,V as Y}from"./VCard-CJTiHjO-.js";import{a as F,m as Ue}from"./VBtn-ClDdYB5F.js";import{a as Z,m as Se,b as Be,V as Te}from"./VSelect-Dtf2lpH6.js";import{f as Ae,u as Le}from"./forwardRefs-BQ8_JL2J.js";import{b as He}from"./scopeId-C7DHxJXu.js";import{a as ne,p as Re,M as ze,r as Ne,s as $e}from"./index-w-dkzpPh.js";import{V as Oe}from"./VForm-v9rzANiR.js";import{V}from"./VTextField-BpJ2unt4.js";import{V as K}from"./VDivider-Dr0TEagO.js";import{m as We,a as Me}from"./layout-DPDN2kkE.js";import{_ as Ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VImg-B-97Yzkt.js";import"./group-bVGzOFiw.js";import"./VInput-qFshDEqa.js";import"./VCheckboxBtn-BS0WhS02.js";import"./VSelectionControl-MTkDIXZh.js";const Ke=Fe("v-spacer","div","VSpacer"),Xe=ae({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Se({origin:"center center",scrollStrategy:"block",transition:{component:Be},zIndex:2400})},"VDialog"),ee=te()({name:"VDialog",props:Xe(),emits:{"update:modelValue":a=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(a,U){let{emit:q,slots:b}=U;const m=le(a,"modelValue"),{scopeId:D}=He(),u=r();function f(d){var p,y;const o=d.relatedTarget,_=d.target;if(o!==_&&((p=u.value)!=null&&p.contentEl)&&((y=u.value)!=null&&y.globalTop)&&![document,u.value.contentEl].includes(_)&&!u.value.contentEl.contains(_)){const v=fe(u.value.contentEl);if(!v.length)return;const h=v[0],I=v[v.length-1];o===h?I.focus():h.focus()}}me(()=>{document.removeEventListener("focusin",f)}),ve&&J(()=>m.value&&a.retainFocus,d=>{d?document.addEventListener("focusin",f):document.removeEventListener("focusin",f)},{immediate:!0});function x(){var d;q("afterEnter"),(a.scrim||a.retainFocus)&&((d=u.value)!=null&&d.contentEl)&&!u.value.contentEl.contains(document.activeElement)&&u.value.contentEl.focus({preventScroll:!0})}function k(){q("afterLeave")}return J(m,async d=>{var o;d||(await ge(),(o=u.value.activatorEl)==null||o.focus({preventScroll:!0}))}),ne(()=>{const d=Z.filterProps(a),o=R({"aria-haspopup":"dialog"},a.activatorProps),_=R({tabindex:-1},a.contentProps);return s(Z,R({ref:u,class:["v-dialog",{"v-dialog--fullscreen":a.fullscreen,"v-dialog--scrollable":a.scrollable},a.class],style:a.style},d,{modelValue:m.value,"onUpdate:modelValue":p=>m.value=p,"aria-modal":"true",activatorProps:o,contentProps:_,height:a.fullscreen?void 0:a.height,width:a.fullscreen?void 0:a.width,maxHeight:a.fullscreen?void 0:a.maxHeight,maxWidth:a.fullscreen?void 0:a.maxWidth,role:"dialog",onAfterEnter:x,onAfterLeave:k},D),{activator:b.activator,default:function(){for(var p=arguments.length,y=new Array(p),v=0;v<p;v++)y[v]=arguments[v];return s(Re,{root:"VDialog"},{default:()=>{var h;return[(h=b.default)==null?void 0:h.call(b,...y)]}})}})}),Ae({},u)}}),je=ae({app:Boolean,appear:Boolean,extended:Boolean,layout:Boolean,offset:Boolean,modelValue:{type:Boolean,default:!0},..._e(Ue({active:!0}),["location"]),...We(),...$e(),...Ne({transition:"fab-transition"})},"VFab"),Je=te()({name:"VFab",props:je(),emits:{"update:modelValue":a=>!0},setup(a,U){let{slots:q}=U;const b=le(a,"modelValue"),m=pe(56),D=r(),{resizeRef:u}=Le(o=>{o.length&&(m.value=o[0].target.clientHeight)}),f=Q(()=>a.app||a.absolute),x=E(()=>{var o;return f.value?((o=a.location)==null?void 0:o.split(" ").shift())??"bottom":!1}),k=E(()=>{var o;return f.value?((o=a.location)==null?void 0:o.split(" ")[1])??"end":!1});Ve(()=>a.app,()=>{const o=Me({id:a.name,order:E(()=>parseInt(a.order,10)),position:x,layoutSize:E(()=>a.layout?m.value+24:0),elementSize:E(()=>m.value+24),active:E(()=>a.app&&b.value),absolute:Q(()=>a.absolute)});ye(()=>{D.value=o.layoutItemStyles.value})});const d=r();return ne(()=>{const o=F.filterProps(a);return w("div",{ref:d,class:se(["v-fab",{"v-fab--absolute":a.absolute,"v-fab--app":!!a.app,"v-fab--extended":a.extended,"v-fab--offset":a.offset,[`v-fab--${x.value}`]:f.value,[`v-fab--${k.value}`]:f.value},a.class]),style:be([a.app?{...D.value}:{height:a.absolute?"100%":"inherit"},a.style])},[w("div",{class:"v-fab__container"},[s(ze,{appear:a.appear,transition:a.transition},{default:()=>[he(s(F,R({ref:u},o,{active:void 0,location:void 0}),q),[[we,a.active]])]})])])}),{}}}),Qe={class:""},Ye={class:"mb-4"},Ze={key:0},et={class:"text-subtitle-2 mb-2"},tt={key:1},at={class:"text-subtitle-2 mb-2"},lt={key:2},st={class:"text-subtitle-2 mb-2"},nt={class:"text-subtitle-2 mt-4 mb-2"},ot={class:"text-subtitle-2 mt-4 mb-2"},ut={class:"text-subtitle-2 mt-4 mb-2"},it=De({__name:"Devices",setup(a){const U=ke(),q=r(),b=r(!1),m=r(!1),D=r(!1),u=r(""),f=r(""),x=r(""),k=r(""),d=r(""),o=r(""),_=r(""),p=r(""),y=r(""),v=r(""),h=r(""),I=r(""),S=r(""),B=r(""),z=E(()=>u.value==="homeassistant"||u.value==="readonly-homeassistant"),N=E(()=>u.value==="homeassistant"),$=E(()=>u.value==="evcc"),O=E(()=>u.value==="sg-ready-heat-pump"),X=r([{text:l("settings.device_type_home_assistant"),value:"homeassistant"},{text:l("settings.device_type_home_assistant_readonly"),value:"readonly-homeassistant"},{text:l("settings.device_type_evcc"),value:"evcc"},{text:l("settings.device_type_sg_ready_heat_pump"),value:"sg-ready-heat-pump"}]),oe=function(c){const t=X.value.filter(e=>e.value==c);return t.length>0?t[0].text:"unknown"},ue=async function(c){await T.deleteDevice(c),q.value=await T.getAllDevices(!1),b.value=!0},j=function(c){U.push(`/settings/editdevice/${c}`)},ie=function(){u.value="",f.value="",x.value="",k.value="",d.value="",o.value="",_.value="",p.value="",y.value="",v.value="",h.value="",I.value="",S.value="",B.value="",D.value=!1,m.value=!0},re=async function(){if(D.value&&u.value&&f.value&&x.value){if(z.value&&(!k.value||!d.value||N.value&&!o.value)||$.value&&!_.value||O.value&&(!p.value||!y.value||!v.value||!h.value||!I.value||!S.value||!B.value))return;try{const c={icon:x.value};z.value&&(c.power=k.value,c.energy=d.value,N.value&&(c.output=o.value)),$.value&&(c.load_point_name=_.value),O.value&&(c.heating={state:p.value,energy:y.value,temperature:v.value},c.water={state:h.value,energy:I.value,temperature:S.value},c.output=B.value);const t=await T.addDevice(u.value,f.value,c);console.log("Device added successfully with ID:",t),q.value=await T.getAllDevices(!1),m.value=!1,j(t)}catch(c){console.error("Failed to add device:",c),m.value=!1}}};return xe(async()=>{q.value=await T.getAllDevices(!1)}),(c,t)=>(P(),L(Pe,{class:"bg-background pa-4"},{default:i(()=>[s(Ce,null,{default:i(()=>[(P(!0),H(qe,null,Ee(q.value,(e,de)=>(P(),L(Ie,{key:de,cols:"12",md:"6",xl:"3"},{default:i(()=>[e.id!="9c0e0865-f3b0-488f-8d3f-b3b0cdda5de7"?(P(),L(W,{key:0,class:"ma-4 elevation-2"},{default:i(()=>[s(Y,null,{default:i(()=>[w("span",{class:se(["mdi pr-2",e.icon])},null,2),w("span",Qe,g(e.name),1)]),_:2},1024),s(M,null,{default:i(()=>[C(g(oe(e.type)),1)]),_:2},1024),s(G,null,{default:i(()=>[s(F,{class:"ma-2",onClick:ce=>j(e.id)},{default:i(()=>[C(g(n(l)("settings.edit_action")),1)]),_:2},1032,["onClick"]),s(F,{class:"ma-2",onClick:ce=>ue(e.id)},{default:i(()=>[C(g(n(l)("settings.delete_action")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1024))),128))]),_:1}),s(ee,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=e=>b.value=e),width:"auto"},{default:i(()=>[s(W,null,{default:i(()=>[s(M,null,{default:i(()=>t[19]||(t[19]=[C(" Please remove the device manually from the config file. ",-1)])),_:1,__:[19]}),s(G,null,{default:i(()=>[s(F,{color:"primary",block:"",onClick:t[0]||(t[0]=e=>b.value=!1)},{default:i(()=>t[20]||(t[20]=[C(" Close ",-1)])),_:1,__:[20]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(ee,{modelValue:m.value,"onUpdate:modelValue":t[18]||(t[18]=e=>m.value=e),"max-width":"500px"},{default:i(()=>[s(W,null,{default:i(()=>[s(Y,null,{default:i(()=>[C(g(n(l)("settings.add_device_dialog_title")),1)]),_:1}),s(M,null,{default:i(()=>[w("p",Ye,g(n(l)("settings.add_device_instruction")),1),s(Oe,{ref:"addDeviceForm",modelValue:D.value,"onUpdate:modelValue":t[16]||(t[16]=e=>D.value=e)},{default:i(()=>[s(Te,{modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=e=>u.value=e),items:X.value,label:n(l)("settings.device_type"),"item-title":"text","item-value":"value",required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],class:"mb-4"},null,8,["modelValue","items","label","rules"]),s(V,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=e=>f.value=e),label:n(l)("settings.device_name"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],maxlength:"50"},null,8,["modelValue","label","rules"]),s(V,{modelValue:x.value,"onUpdate:modelValue":t[4]||(t[4]=e=>x.value=e),label:n(l)("settings.device_icon"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],maxlength:"50",placeholder:"mdi-home",hint:"e.g., mdi-home, mdi-car, mdi-heat-pump","persistent-hint":""},null,8,["modelValue","label","rules"]),z.value?(P(),H("div",Ze,[s(K,{class:"my-4"}),w("p",et,g(n(l)("settings.home_assistant_entity_ids")),1),s(V,{modelValue:k.value,"onUpdate:modelValue":t[5]||(t[5]=e=>k.value=e),label:n(l)("settings.power"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"sensor.power_entity",hint:"Home Assistant entity ID for power measurement","persistent-hint":"",class:"mb-2"},null,8,["modelValue","label","rules"]),s(V,{modelValue:d.value,"onUpdate:modelValue":t[6]||(t[6]=e=>d.value=e),label:n(l)("settings.energy"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"sensor.energy_entity",hint:"Home Assistant entity ID for energy measurement","persistent-hint":"",class:"mb-2"},null,8,["modelValue","label","rules"]),N.value?(P(),L(V,{key:0,modelValue:o.value,"onUpdate:modelValue":t[7]||(t[7]=e=>o.value=e),label:n(l)("settings.output"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"switch.output_entity",hint:"Home Assistant entity ID for device control","persistent-hint":""},null,8,["modelValue","label","rules"])):A("",!0)])):A("",!0),$.value?(P(),H("div",tt,[s(K,{class:"my-4"}),w("p",at,g(n(l)("settings.evcc_configuration")),1),s(V,{modelValue:_.value,"onUpdate:modelValue":t[8]||(t[8]=e=>_.value=e),label:n(l)("settings.load_point_name"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"e.g., wallbox, car_charger",hint:"Name of the EVCC load point","persistent-hint":""},null,8,["modelValue","label","rules"])])):A("",!0),O.value?(P(),H("div",lt,[s(K,{class:"my-4"}),w("p",st,g(n(l)("settings.heat_pump_configuration")),1),w("p",nt,g(n(l)("settings.heating")),1),s(V,{modelValue:p.value,"onUpdate:modelValue":t[9]||(t[9]=e=>p.value=e),label:n(l)("settings.state"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"sensor.heating_state",hint:"Entity ID for heating state","persistent-hint":"",class:"mb-2"},null,8,["modelValue","label","rules"]),s(V,{modelValue:y.value,"onUpdate:modelValue":t[10]||(t[10]=e=>y.value=e),label:n(l)("settings.energy"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"sensor.heating_energy",hint:"Entity ID for heating energy","persistent-hint":"",class:"mb-2"},null,8,["modelValue","label","rules"]),s(V,{modelValue:v.value,"onUpdate:modelValue":t[11]||(t[11]=e=>v.value=e),label:n(l)("settings.temperature"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"sensor.heating_temperature",hint:"Entity ID for heating temperature","persistent-hint":"",class:"mb-2"},null,8,["modelValue","label","rules"]),w("p",ot,g(n(l)("settings.water")),1),s(V,{modelValue:h.value,"onUpdate:modelValue":t[12]||(t[12]=e=>h.value=e),label:n(l)("settings.state"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"sensor.water_state",hint:"Entity ID for water heating state","persistent-hint":"",class:"mb-2"},null,8,["modelValue","label","rules"]),s(V,{modelValue:I.value,"onUpdate:modelValue":t[13]||(t[13]=e=>I.value=e),label:n(l)("settings.energy"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"sensor.water_energy",hint:"Entity ID for water heating energy","persistent-hint":"",class:"mb-2"},null,8,["modelValue","label","rules"]),s(V,{modelValue:S.value,"onUpdate:modelValue":t[14]||(t[14]=e=>S.value=e),label:n(l)("settings.temperature"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"sensor.water_temperature",hint:"Entity ID for water temperature","persistent-hint":""},null,8,["modelValue","label","rules"]),w("p",ut,g(n(l)("settings.output")),1),s(V,{modelValue:B.value,"onUpdate:modelValue":t[15]||(t[15]=e=>B.value=e),label:n(l)("settings.output"),required:"",rules:[e=>!!e||n(l)("settings.forecast_field_required")],placeholder:"switch.heat_pump_control",hint:"Entity ID for heat pump control","persistent-hint":""},null,8,["modelValue","label","rules"])])):A("",!0)]),_:1},8,["modelValue"])]),_:1}),s(G,null,{default:i(()=>[s(Ke),s(F,{onClick:t[17]||(t[17]=e=>m.value=!1)},{default:i(()=>[C(g(n(l)("close")),1)]),_:1}),s(F,{color:"primary",disabled:!D.value,onClick:re},{default:i(()=>[C(g(n(l)("settings.add_device")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(Je,{icon:"mdi-plus",size:"large",color:"primary",location:"bottom end",class:"fab-fixed",onClick:ie})]),_:1}))}}),Pt=Ge(it,[["__scopeId","data-v-1033f23f"]]);export{Pt as default};
