# Default configuration for Claude Code Guardian
# This file contains built-in rules that ship with the package

default_rules: ["security.*"]

rules:
  security.git_access:
    type: path_access
    scope: write
    action: deny
    message: "Direct access to .git directory is restricted for security"
    priority: 30
    paths:
      - pattern: "**/.git"
      - pattern: "**/.git/**"

  security.git_commands:
    type: pre_use_bash
    priority: 30
    commands:
      - pattern: "^git push --force\\b"
        message: "Use git push --force-with-lease"
        action: deny

  performance.grep_suggestion:
    type: pre_use_bash
    pattern: "^grep\\b(?!.*\\|)"
    action: deny
    message: "Use 'rg' (ripgrep) instead of 'grep' for better performance and features"
    priority: 30

  performance.find_suggestion:
    type: pre_use_bash
    pattern: "^find\\s+\\S+\\s+-name\\b"
    action: deny
    message: "Use 'rg --files | rg pattern' or 'rg --files -g pattern' instead of 'find -name' for better performance"
    priority: 30

