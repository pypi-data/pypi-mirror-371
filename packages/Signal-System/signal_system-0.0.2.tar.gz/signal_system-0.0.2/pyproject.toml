[project]
name = "Signal-System"
version = "0.0.2"
description = "A package for signal and system simulation, design, analysis, and learning."
readme = "README.md"
requires-python = ">=3.13"
license = "MIT"
authors = [
    {name = "Heng-Sheng Chang", email="hanson.hschang+signal.system@gmail.com"}
]
repository = "https://github.com/hanson-hschang/Signal-System"
keywords = ["Signal", "System", "Learning"]

# Pypi classifiers: https://pypi.org/classifiers/
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Science/Research",
    "Intended Audience :: Education",
    "Operating System :: OS Independent",
    "License :: OSI Approved :: MIT License",
    "Natural Language :: English",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.13",
]

dependencies = [
    "numpy>=1.26.0",
    "scipy>=1.11.0",
    "numba>=0.60.0",
    "torch>=2.6.0",
    "matplotlib>=3.7.2",
    "h5py>=3.0.0",
    "tqdm>=4.60.0",
    "click>=8.1.7",
    "psutil>=6.1.1",
]

[project.optional-dependencies]
dev = [
    "pyupgrade>=3.15.2",
    "pre-commit>=3.7.1",
    "pytest>=8.2.1",
    "pytest-mock>=3.14.0",
    "pytest-cov>=5.0.0",
    "pytest-dependency>=0.6.0",
    "codecov>=2.1.13",
    "black>=24.4.2",
    "isort[colors]>=5.13.2",
    "mypy>=1.10.0",
    "mypy-extensions>=1.0.0",
    "pip-tools>=7.4.0",
]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.build.targets.wheel]
# Tell Hatch where to find your package source code.
packages = ["src/ss"]

[tool.hatch.build.targets.sdist]
# Ensure the source directory is included in the source distribution.
include = ["/src"]

[tool.black]
# https://github.com/psf/black
target-version = ["py313"]
line-length = 79
color = true

exclude = '''
/(
    \.git
    | \.hg
    | \.mypy_cache
    | \.tox
    | \.venv
    | _build
    | buck-out
    | build
    | dist
    | env
    | venv
)/
'''

[tool.isort]
# https://github.com/timothycrosley/isort/
line_length = 79  # https://peps.python.org/pep-0008/
known_typing = [
    "typing",
    "types",
    "typing_extensions",
    "mypy",
    "mypy_extensions",
]
sections = [
    "FUTURE",
    "TYPING",
    "STDLIB",
    "THIRDPARTY",
    "FIRSTPARTY",
    "LOCALFOLDER",
]
include_trailing_comma = true
profile = "black"
multi_line_output = 3
indent = 4
use_parentheses = true
color_output = true

[tool.mypy]
# https://mypy.readthedocs.io/en/latest/config_file.html#using-a-pyproject-toml-file
python_version = "3.13"
pretty = true
show_traceback = true
color_output = true
strict = true
allow_redefinition = false
check_untyped_defs = false
disallow_subclassing_any = false
disallow_untyped_calls = false
disallow_any_generics = false
disallow_incomplete_defs = true
ignore_missing_imports = true
implicit_reexport = true
no_implicit_optional = true
show_column_numbers = true
show_error_codes = true
show_error_context = true
strict_equality = true
strict_optional = true
warn_no_return = true
warn_redundant_casts = true
warn_return_any = true
warn_unreachable = false
warn_unused_configs = true
warn_unused_ignores = true
exclude = [
    'src/draft/.*\.py$',
]

[tool.pytest.ini_options]
norecursedirs = [
    "hooks",
    "*.egg",
    ".eggs",
    "dist",
    "build",
    "docs",
    ".tox",
    ".git",
    "__pycache__",
]
doctest_optionflags = [
    "NUMBER",
    "NORMALIZE_WHITESPACE",
    "IGNORE_EXCEPTION_DETAIL",
    "ELLIPSIS",
]
addopts = [
    "--strict-markers",
    "--tb=short",
]

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover", # Enable pragma
    "TODO",
    # Don't complain if non-runnable code isn't run:
    "if 0:",
    "if __name__ == __main__:",
    "def __repr__",
    "def plot_.*\\b",
    "if self.debug:",
    "if settings.DEBUG",
    "if TYPE_CHECKING:",
    "raise AssertionError",
    "raise NotImplementedError",
    "class .*\\bProtocol\\):",
    "@(abc\\.)?abstractmethod",
    "\\.\\.\\."
]
fail_under = 30
show_missing = true

[tool.coverage.run]
branch = true
omit = [
    "*/.local/*",
    "setup.py",
]
