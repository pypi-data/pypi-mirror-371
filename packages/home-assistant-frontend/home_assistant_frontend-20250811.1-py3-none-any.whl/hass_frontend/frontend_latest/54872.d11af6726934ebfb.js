export const __webpack_ids__=["54872"];export const __webpack_modules__={55815:function(e,t,i){i.d(t,{Eu:()=>n,hZ:()=>r,o9:()=>d});var a=i(28105),s=i(45657);const o=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function n(e){return o[e%o.length]}function r(e,t){const i=t.getPropertyValue(`--graph-color-${e+1}`)||n(e);return(0,s.Rq)(i)}const d=(0,a.Z)(e=>o.map((t,i)=>r(i,e)),(e,t)=>e[0].getPropertyValue("--graph-color-1")===t[0].getPropertyValue("--graph-color-1"))},34302:function(e,t,i){i.d(t,{Bt:()=>n,T8:()=>r});var a=i(3574),s=i(38763);const o=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],n=e=>e.first_weekday===s.FS.language?"weekInfo"in Intl.Locale.prototype?new Intl.Locale(e.language).weekInfo.firstDay%7:(0,a.L)(e.language)%7:o.includes(e.first_weekday)?o.indexOf(e.first_weekday):1,r=e=>{const t=n(e);return o[t]}},68135:function(e,t,i){i.a(e,async function(e,a){try{i.d(t,{G:()=>l});var s=i(62229),o=i(28105),n=i(43890),r=e([s,n]);[s,n]=r.then?(await r)():r;const d=(0,o.Z)(e=>new Intl.RelativeTimeFormat(e.language,{numeric:"auto"})),l=(e,t,i,a=!0)=>{const s=(0,n.W)(e,i,t);return a?d(t).format(s.value,s.unit):Intl.NumberFormat(t.language,{style:"unit",unit:s.unit,unitDisplay:"long"}).format(Math.abs(s.value))};a()}catch(e){a(e)}})},31071:function(e,t,i){i.d(t,{U:()=>o});const a={10:"mdi:battery-10",20:"mdi:battery-20",30:"mdi:battery-30",40:"mdi:battery-40",50:"mdi:battery-50",60:"mdi:battery-60",70:"mdi:battery-70",80:"mdi:battery-80",90:"mdi:battery-90",100:"mdi:battery"},s={10:"mdi:battery-charging-10",20:"mdi:battery-charging-20",30:"mdi:battery-charging-30",40:"mdi:battery-charging-40",50:"mdi:battery-charging-50",60:"mdi:battery-charging-60",70:"mdi:battery-charging-70",80:"mdi:battery-charging-80",90:"mdi:battery-charging-90",100:"mdi:battery-charging"},o=(e,t)=>{const i=Number(e);if(isNaN(i))return"off"===e?"mdi:battery":"on"===e?"mdi:battery-alert":"mdi:battery-unknown";const o=10*Math.round(i/10);return t&&i>=10?s[o]:t?"mdi:battery-charging-outline":i<=5?"mdi:battery-alert-variant-outline":a[o]}},61981:function(e,t,i){i.d(t,{K:()=>n,T:()=>r});var a=i(58125),s=i(15459),o=i(55107);const n=(e,t)=>{const i=t.entities[e.entity_id];return i?r(i,t):(0,s.C)(e)},r=(e,t)=>{const i=e.name||("original_name"in e?e.original_name:void 0),n=e.device_id?t.devices[e.device_id]:void 0;if(!n){if(i)return i;const a=t.states[e.entity_id];return a?(0,s.C)(a):void 0}const r=(0,a.jL)(n);if(r!==i)return r&&i&&(0,o.N)(i,r)||i}},43130:function(e,t,i){i.d(t,{r:()=>a});const a=e=>e.name?.trim()},55107:function(e,t,i){i.d(t,{N:()=>s});const a=[" ",": "," - "],s=(e,t)=>{const i=e.toLowerCase(),s=t.toLowerCase();for(const t of a){const a=`${s}${t}`;if(i.startsWith(a)){const t=e.substring(a.length);if(t.length)return o(t.substr(0,t.indexOf(" ")))?t:t[0].toUpperCase()+t.slice(1)}}},o=e=>e.toLowerCase()!==e},53049:function(e,t,i){i.d(t,{f:()=>a});const a=e=>e.charAt(0).toUpperCase()+e.slice(1)},22329:function(e,t,i){i.d(t,{Q:()=>a});const a=e=>e.replace(/^_*(.)|_+(.)/g,(e,t,i)=>t?t.toUpperCase():" "+i.toUpperCase())},16037:function(e,t,i){i.d(t,{V:()=>s});var a=i(53049);const s=(e,t)=>(e=>{switch(e){case"de":case"lb":return!0;default:return!1}})(t)?(0,a.f)(e):e.toLocaleLowerCase(t)},43890:function(e,t,i){i.a(e,async function(e,a){try{i.d(t,{W:()=>h});var s=i(7722),o=i(66233),n=i(58104),r=i(34302);const d=1e3,l=60,c=60*l;function h(e,t=Date.now(),i,a={}){const h={...p,...a||{}},u=(+e-+t)/d;if(Math.abs(u)<h.second)return{value:Math.round(u),unit:"second"};const _=u/l;if(Math.abs(_)<h.minute)return{value:Math.round(_),unit:"minute"};const g=u/c;if(Math.abs(g)<h.hour)return{value:Math.round(g),unit:"hour"};const v=new Date(e),b=new Date(t);v.setHours(0,0,0,0),b.setHours(0,0,0,0);const m=(0,s.j)(v,b);if(0===m)return{value:Math.round(g),unit:"hour"};if(Math.abs(m)<h.day)return{value:m,unit:"day"};const y=(0,r.Bt)(i),f=(0,o.z)(v,{weekStartsOn:y}),$=(0,o.z)(b,{weekStartsOn:y}),w=(0,n.p)(f,$);if(0===w)return{value:m,unit:"day"};if(Math.abs(w)<h.week)return{value:w,unit:"week"};const x=v.getFullYear()-b.getFullYear(),k=12*x+v.getMonth()-b.getMonth();return 0===k?{value:w,unit:"week"}:Math.abs(k)<h.month||0===x?{value:k,unit:"month"}:{value:Math.round(x),unit:"year"}}const p={second:45,minute:45,hour:22,day:5,week:4,month:11};a()}catch(u){a(u)}})},26979:function(e,t,i){var a=i(73742),s=i(59048),o=i(26292),n=i(31071);i(46358);class r extends s.oi{render(){return this.batteryStateObj?s.dy` <ha-icon .icon="${(0,n.U)(this.batteryStateObj.state,"on"===this.batteryChargingStateObj?.state)}"></ha-icon> `:s.Ld}}(0,a.__decorate)([(0,o.Cb)({attribute:!1})],r.prototype,"batteryStateObj",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],r.prototype,"batteryChargingStateObj",void 0),r=(0,a.__decorate)([(0,o.Mo)("ha-battery-icon")],r)},31138:function(e,t,i){var a=i(73742),s=i(59048),o=i(26292);class n extends s.oi{render(){return s.dy` ${this.header?s.dy`<h1 class="card-header">${this.header}</h1>`:s.Ld} <slot></slot> `}constructor(...e){super(...e),this.raised=!1}}n.styles=s.iv`:host{background:var(--ha-card-background,var(--card-background-color,#fff));-webkit-backdrop-filter:var(--ha-card-backdrop-filter,none);backdrop-filter:var(--ha-card-backdrop-filter,none);box-shadow:var(--ha-card-box-shadow,none);box-sizing:border-box;border-radius:var(--ha-card-border-radius,12px);border-width:var(--ha-card-border-width,1px);border-style:solid;border-color:var(--ha-card-border-color,var(--divider-color,#e0e0e0));color:var(--primary-text-color);display:block;transition:all .3s ease-out;position:relative}:host([raised]){border:none;box-shadow:var(--ha-card-box-shadow,0px 2px 1px -1px rgba(0,0,0,.2),0px 1px 1px 0px rgba(0,0,0,.14),0px 1px 3px 0px rgba(0,0,0,.12))}.card-header,:host ::slotted(.card-header){color:var(--ha-card-header-color,var(--primary-text-color));font-family:var(--ha-card-header-font-family, inherit);font-size:var(--ha-card-header-font-size, var(--ha-font-size-2xl));letter-spacing:-.012em;line-height:var(--ha-line-height-expanded);padding:12px 16px 16px;display:block;margin-block-start:0px;margin-block-end:0px;font-weight:var(--ha-font-weight-normal)}:host ::slotted(.card-content:not(:first-child)),slot:not(:first-child)::slotted(.card-content){padding-top:0px;margin-top:-8px}:host ::slotted(.card-content){padding:16px}:host ::slotted(.card-actions){border-top:1px solid var(--divider-color,#e8e8e8);padding:8px}`,(0,a.__decorate)([(0,o.Cb)()],n.prototype,"header",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean,reflect:!0})],n.prototype,"raised",void 0),n=(0,a.__decorate)([(0,o.Mo)("ha-card")],n)},80471:function(e,t,i){var a=i(73742),s=i(33856),o=i(24584),n=i(26292),r=i(59048),d=i(83054);class l extends s._{firstUpdated(e){super.firstUpdated(e),this.style.setProperty("--mdc-theme-secondary","var(--primary-color)")}}l.styles=[o.W,r.iv`:host{--mdc-typography-button-text-transform:none;--mdc-typography-button-font-size:var(--ha-font-size-l);--mdc-typography-button-font-family:var(--ha-font-family-body);--mdc-typography-button-font-weight:var(--ha-font-weight-medium)}:host .mdc-fab--extended{border-radius:var(--ha-button-border-radius,var(--ha-border-radius-pill))}:host .mdc-fab.mdc-fab--extended .ripple{border-radius:var(--ha-button-border-radius,var(--ha-border-radius-pill))}:host .mdc-fab--extended .mdc-fab__icon{margin-inline-start:-8px;margin-inline-end:12px;direction:var(--direction)}:disabled{--mdc-theme-secondary:var(--disabled-text-color);pointer-events:none}`,"rtl"===d.E.document.dir?r.iv`:host .mdc-fab--extended .mdc-fab__icon{direction:rtl}`:r.iv``],l=(0,a.__decorate)([(0,n.Mo)("ha-fab")],l)},61829:function(e,t,i){i.a(e,async function(e,t){try{i(81738),i(94814);var a=i(73742),s=i(59048),o=i(26292),n=i(88245),r=i(28105),d=i(39884),l=i(36221),c=i(96222),h=i(95814),p=(i(93673),i(38255)),u=(i(19515),i(64881),i(39091),e([p]));p=(u.then?(await u)():u)[0];const _="M21 8H3V6H21V8M13.81 16H10V18H13.09C13.21 17.28 13.46 16.61 13.81 16M18 11H6V13H18V11M21.12 15.46L19 17.59L16.88 15.46L15.47 16.88L17.59 19L15.47 21.12L16.88 22.54L19 20.41L21.12 22.54L22.54 21.12L20.41 19L22.54 16.88L21.12 15.46Z";class g extends s.oi{render(){return s.dy` <ha-expansion-panel left-chevron .expanded="${this.expanded}" @expanded-will-change="${this._expandedWillChange}" @expanded-changed="${this._expandedChanged}"> <div slot="header" class="header"> ${this.hass.localize("ui.panel.config.integrations.caption")} ${this.value?.length?s.dy`<div class="badge">${this.value?.length}</div> <ha-icon-button .path="${_}" @click="${this._clearFilter}"></ha-icon-button>`:s.Ld} </div> ${this._manifests&&this._shouldRender?s.dy`<search-input-outlined .hass="${this.hass}" .filter="${this._filter}" @value-changed="${this._handleSearchChange}"> </search-input-outlined> <ha-list class="ha-scrollbar" @click="${this._handleItemClick}" multi> ${(0,n.r)(this._integrations(this._manifests,this._filter,this.value),e=>e.domain,e=>s.dy`<ha-check-list-item .value="${e.domain}" .selected="${(this.value||[]).includes(e.domain)}" graphic="icon"> <ha-domain-icon slot="graphic" .hass="${this.hass}" .domain="${e.domain}" brand-fallback></ha-domain-icon> ${e.name||e.domain} </ha-check-list-item>`)} </ha-list> `:s.Ld} </ha-expansion-panel> `}updated(e){e.has("expanded")&&this.expanded&&setTimeout(()=>{this.expanded&&(this.renderRoot.querySelector("ha-list").style.height=this.clientHeight-49-32+"px")},300)}_expandedWillChange(e){this._shouldRender=e.detail.expanded}_expandedChanged(e){this.expanded=e.detail.expanded}async firstUpdated(){this._manifests=await(0,c.F3)(this.hass)}_handleItemClick(e){const t=e.target.closest("ha-check-list-item"),i=t?.value;i&&(this.value?.includes(i)?this.value=this.value?.filter(e=>e!==i):this.value=[...this.value||[],i],t.selected=this.value?.includes(i),(0,d.B)(this,"data-table-filter-changed",{value:this.value,items:void 0}))}_clearFilter(e){e.preventDefault(),this.value=void 0,(0,d.B)(this,"data-table-filter-changed",{value:void 0,items:void 0})}_handleSearchChange(e){this._filter=e.detail.value.toLowerCase()}static get styles(){return[h.$c,s.iv`:host{border-bottom:1px solid var(--divider-color)}:host([expanded]){flex:1;height:0}ha-expansion-panel{--ha-card-border-radius:0;--expansion-panel-content-padding:0}.header{display:flex;align-items:center}.header ha-icon-button{margin-inline-start:auto;margin-inline-end:8px}.badge{display:inline-block;margin-left:8px;margin-inline-start:8px;margin-inline-end:0;min-width:16px;box-sizing:border-box;border-radius:50%;font-size:var(--ha-font-size-xs);font-weight:var(--ha-font-weight-normal);background-color:var(--primary-color);line-height:var(--ha-line-height-normal);text-align:center;padding:0px 2px;color:var(--text-primary-color)}search-input-outlined{display:block;padding:0 8px}`]}constructor(...e){super(...e),this.narrow=!1,this.expanded=!1,this._shouldRender=!1,this._integrations=(0,r.Z)((e,t,i)=>e.filter(e=>(!e.integration_type||!["entity","system","hardware"].includes(e.integration_type))&&(!t||e.name.toLowerCase().includes(t)||e.domain.toLowerCase().includes(t))).sort((e,t)=>(0,l.$K)(e.name||e.domain,t.name||t.domain,this.hass.locale.language)))}}(0,a.__decorate)([(0,o.Cb)({attribute:!1})],g.prototype,"hass",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],g.prototype,"value",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean})],g.prototype,"narrow",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean,reflect:!0})],g.prototype,"expanded",void 0),(0,a.__decorate)([(0,o.SB)()],g.prototype,"_manifests",void 0),(0,a.__decorate)([(0,o.SB)()],g.prototype,"_shouldRender",void 0),(0,a.__decorate)([(0,o.SB)()],g.prototype,"_filter",void 0),g=(0,a.__decorate)([(0,o.Mo)("ha-filter-integrations")],g),t()}catch(e){t(e)}})},83693:function(e,t,i){i(2394),i(81738),i(29981),i(6989);var a=i(73742),s=i(59048),o=i(26292),n=i(39884),r=i(95814);i(93673),i(19515),i(46358),i(48017),i(64881);class d extends s.oi{render(){if(!this.states)return s.Ld;const e=this.states.find(e=>e.icon);return s.dy` <ha-expansion-panel left-chevron .expanded="${this.expanded}" @expanded-will-change="${this._expandedWillChange}" @expanded-changed="${this._expandedChanged}"> <div slot="header" class="header"> ${this.label} ${this.value?.length?s.dy`<div class="badge">${this.value?.length}</div> <ha-icon-button .path="${"M21 8H3V6H21V8M13.81 16H10V18H13.09C13.21 17.28 13.46 16.61 13.81 16M18 11H6V13H18V11M21.12 15.46L19 17.59L16.88 15.46L15.47 16.88L17.59 19L15.47 21.12L16.88 22.54L19 20.41L21.12 22.54L22.54 21.12L20.41 19L22.54 16.88L21.12 15.46Z"}" @click="${this._clearFilter}"></ha-icon-button>`:s.Ld} </div> ${this._shouldRender?s.dy` <ha-list @selected="${this._statesSelected}" multi class="ha-scrollbar"> ${this.states.map(t=>s.dy`<ha-check-list-item .value="${t.value}" .selected="${this.value?.includes(t.value)??!1}" .graphic="${e?"icon":null}"> ${t.icon?s.dy`<ha-icon slot="graphic" .icon="${t.icon}"></ha-icon>`:s.Ld} ${t.label} </ha-check-list-item>`)} </ha-list> `:s.Ld} </ha-expansion-panel> `}willUpdate(e){e.has("expanded")&&this.expanded&&(this._shouldRender=!0)}updated(e){(e.has("expanded")||e.has("states"))&&this.expanded&&setTimeout(async()=>{if(!this.expanded)return;const e=this._list;e&&(e.style.height=this.clientHeight-49+"px")},300)}_expandedWillChange(e){this._shouldRender=e.detail.expanded}_expandedChanged(e){this.expanded=e.detail.expanded}async _statesSelected(e){if(!e.detail.index.size)return(0,n.B)(this,"data-table-filter-changed",{value:[],items:void 0}),void(this.value=[]);const t=[];for(const i of e.detail.index){const e=this.states[i].value;t.push(e)}this.value=t,(0,n.B)(this,"data-table-filter-changed",{value:t,items:void 0})}_clearFilter(e){e.preventDefault(),this.value=void 0,(0,n.B)(this,"data-table-filter-changed",{value:void 0,items:void 0})}static get styles(){return[r.$c,s.iv`:host{border-bottom:1px solid var(--divider-color)}:host([expanded]){flex:1;height:0}ha-expansion-panel{--ha-card-border-radius:0;--expansion-panel-content-padding:0}.header{display:flex;align-items:center}.header ha-icon-button{margin-inline-start:auto;margin-inline-end:8px}.badge{display:inline-block;margin-left:8px;margin-inline-start:8px;margin-inline-end:0;min-width:16px;box-sizing:border-box;border-radius:50%;font-size:var(--ha-font-size-xs);font-weight:var(--ha-font-weight-normal);background-color:var(--primary-color);line-height:var(--ha-line-height-normal);text-align:center;padding:0px 2px;color:var(--text-primary-color)}`]}constructor(...e){super(...e),this.narrow=!1,this.expanded=!1,this._shouldRender=!1}}(0,a.__decorate)([(0,o.Cb)({attribute:!1})],d.prototype,"hass",void 0),(0,a.__decorate)([(0,o.Cb)()],d.prototype,"label",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],d.prototype,"value",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],d.prototype,"states",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean})],d.prototype,"narrow",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean,reflect:!0})],d.prototype,"expanded",void 0),(0,a.__decorate)([(0,o.SB)()],d.prototype,"_shouldRender",void 0),(0,a.__decorate)([(0,o.IO)("ha-list")],d.prototype,"_list",void 0),d=(0,a.__decorate)([(0,o.Mo)("ha-filter-states")],d)},5786:function(e,t,i){i.r(t),i.d(t,{HaIconNext:()=>r});var a=i(73742),s=i(26292),o=i(83054),n=i(993);class r extends n.HaSvgIcon{constructor(...e){super(...e),this.path="rtl"===o.E.document.dir?"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z":"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"}}(0,a.__decorate)([(0,s.Cb)()],r.prototype,"path",void 0),r=(0,a.__decorate)([(0,s.Mo)("ha-icon-next")],r)},85775:function(e,t,i){var a=i(73742),s=i(72134),o=i(48758),n=i(59048),r=i(26292);class d extends s.W{async show(){super.show(),this.menu.hasOverflow=!1}}d.styles=[o.W,n.iv`:host{--ha-icon-display:block;--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-primary:var(--primary-text-color);--md-sys-color-secondary:var(--secondary-text-color);--md-sys-color-surface:var(--card-background-color);--md-sys-color-on-surface:var(--primary-text-color);--md-sys-color-on-surface-variant:var(--secondary-text-color);--md-sys-color-secondary-container:rgba(
          var(--rgb-primary-color),
          0.15
        );--md-sys-color-on-secondary-container:var(--text-primary-color);--mdc-icon-size:16px;--md-sys-color-on-primary-container:var(--primary-text-color);--md-sys-color-on-secondary-container:var(--primary-text-color)}`],d=(0,a.__decorate)([(0,r.Mo)("ha-sub-menu")],d)},96975:function(e,t,i){i.d(t,{Bg:()=>c,DT:()=>l,SY:()=>r,aJ:()=>o,cz:()=>n,ko:()=>d});var a=i(36590),s=i(16230);const o=(e,t,i)=>e.connection.subscribeMessage(i,{type:"assist_satellite/intercept_wake_word",entity_id:t}),n=(e,t)=>e.callWS({type:"assist_satellite/test_connection",entity_id:t}),r=(e,t,i)=>e.callService("assist_satellite","announce",i,{entity_id:t}),d=(e,t)=>e.callWS({type:"assist_satellite/get_configuration",entity_id:t}),l=(e,t,i)=>e.callWS({type:"assist_satellite/set_wake_words",entity_id:t,wake_word_ids:i}),c=e=>e&&e.state!==s.nZ&&(0,a.e)(e,1)},69992:function(e,t,i){i.d(t,{B:()=>a,l:()=>s});i(81738),i(22960),i(67886),i(65451),i(46015),i(38334),i(94880),i(75643),i(29761);const a=e=>{const t={};return Object.entries(e).forEach(([e,i])=>{t[e]={value:i.value,items:i.items instanceof Set?Array.from(i.items):i.items}}),t},s=e=>{const t={};return Object.entries(e).forEach(([e,i])=>{t[e]={value:i.value,items:Array.isArray(i.items)?new Set(i.items):i.items}}),t}},27689:function(e,t,i){i.d(t,{ZK:()=>n,iP:()=>o,lf:()=>s,pD:()=>a});const a=e=>e.callWS({type:"diagnostics/list"}),s=(e,t)=>e.callWS({type:"diagnostics/get",domain:t}),o=e=>`/api/diagnostics/config_entry/${e}`,n=(e,t)=>`/api/diagnostics/config_entry/${e}/device/${t}`},43563:function(e,t,i){i.d(t,{MY:()=>b,Yc:()=>u,hb:()=>g,jV:()=>l,o1:()=>_,ri:()=>v,sS:()=>h});var a=i(40141),s=i(44272),o=i(6219),n=i(16037),r=i(16230);const d="ui.components.logbook.messages",l=["counter","proximity","sensor","zone"],c={triggered_by_numeric_state_of:"numeric state of",triggered_by_state_of:"state of",triggered_by_event:"event",triggered_by_time_pattern:"time pattern",triggered_by_time:"time",triggered_by_homeassistant_stopping:"Home Assistant stopping",triggered_by_homeassistant_starting:"Home Assistant starting"},h=async(e,t,i)=>p(e,t,void 0,void 0,i),p=(e,t,i,a,s,o)=>{if((a||o)&&(!a||0===a.length)&&(!o||0===o.length))return Promise.resolve([]);const n={type:"logbook/get_events",start_time:t};return i&&(n.end_time=i),a?.length&&(n.entity_ids=a),o?.length&&(n.device_ids=o),s&&(n.context_id=s),e.callWS(n)},u=(e,t,i,a,s,o,n)=>{if((o||n)&&(!o||0===o.length)&&(!n||0===n.length))return Promise.reject("No entities or devices");const r={type:"logbook/event_stream",start_time:i,end_time:a};return o?.length&&(r.entity_ids=o),n?.length&&(r.device_ids=n),e.connection.subscribeMessage(e=>t(e,s),r)},_=(e,t)=>({entity_id:e.entity_id,state:t,attributes:{device_class:e?.attributes.device_class,source_type:e?.attributes.source_type,has_date:e?.attributes.has_date,has_time:e?.attributes.has_time,entity_picture_local:a.iY.has((0,s.M)(e.entity_id))?void 0:e?.attributes.entity_picture_local,entity_picture:a.iY.has((0,s.M)(e.entity_id))?void 0:e?.attributes.entity_picture}}),g=(e,t)=>{for(const i of Object.keys(c)){const a=c[i];if(t.startsWith(a))return t.replace(a,`${e(`ui.components.logbook.${i}`)}`)}return t},v=(e,t,i,s,o)=>{switch(o){case"device_tracker":case"person":return"not_home"===i?t(`${d}.was_away`):"home"===i?t(`${d}.was_at_home`):t(`${d}.was_at_state`,{state:i});case"sun":return t("above_horizon"===i?`${d}.rose`:`${d}.set`);case"binary_sensor":{const o=i===a.uo,r=i===a.lC,l=s.attributes.device_class;if(l&&(o||r))return t(`${d}.${o?"detected_device_classes":"cleared_device_classes"}.${l}`,{device_class:(0,n.V)(t(`component.binary_sensor.entity_component.${l}.name`)||l,e.language)})||t(`${d}.${o?"detected_device_class":"cleared_device_class"}`,{device_class:(0,n.V)(t(`component.binary_sensor.entity_component.${l}.name`)||l,e.language)});break}case"cover":switch(i){case"open":return t(`${d}.was_opened`);case"opening":return t(`${d}.is_opening`);case"closing":return t(`${d}.is_closing`);case"closed":return t(`${d}.was_closed`)}break;case"event":return t(`${d}.detected_event_no_type`);case"lock":switch(i){case"unlocked":return t(`${d}.was_unlocked`);case"locking":return t(`${d}.is_locking`);case"unlocking":return t(`${d}.is_unlocking`);case"opening":return t(`${d}.is_opening`);case"open":return t(`${d}.is_opened`);case"locked":return t(`${d}.was_locked`);case"jammed":return t(`${d}.is_jammed`)}}return i===a.uo?t(`${d}.turned_on`):i===a.lC?t(`${d}.turned_off`):i===r.lz?t(`${d}.became_unknown`):i===r.nZ?t(`${d}.became_unavailable`):e.localize(`${d}.changed_to_state`,{state:s?e.formatEntityState(s,i):i})},b=e=>"sensor"!==(0,o.N)(e)||void 0===e.attributes.unit_of_measurement&&void 0===e.attributes.state_class},25151:function(e,t,i){function a(e){return"strategy"in e}i.d(t,{Oh:()=>o,Q2:()=>s,Tx:()=>a,vj:()=>n});const s=(e,t,i)=>e.sendMessagePromise({type:"lovelace/config",url_path:t,force:i}),o=(e,t,i)=>e.callWS({type:"lovelace/config/save",url_path:t,config:i}),n=(e,t)=>e.callWS({type:"lovelace/config/delete",url_path:t})},70695:function(e,t,i){i.d(t,{JR:()=>s,Y:()=>o,iM:()=>n,j2:()=>a});const a=e=>e.callWS({type:"lovelace/dashboards/list"}),s=(e,t)=>e.callWS({type:"lovelace/dashboards/create",...t}),o=(e,t,i)=>e.callWS({type:"lovelace/dashboards/update",dashboard_id:t,...i}),n=(e,t)=>e.callWS({type:"lovelace/dashboards/delete",dashboard_id:t})},10734:function(e,t,i){i.d(t,{t:()=>n});i(81738),i(94814),i(22960),i(6989);var a=i(59048),s=i(72242),o=i(70947);i(19515);const n=async(e,t,i)=>{const n=await(0,o.CL)(t,i),r=Object.entries(n),d=r.filter(([e,t])=>t&&e!==t).map(([e,t])=>a.dy`<tr> <td>${e}</td> <td>${t}</td> </tr>`),l=r.filter(([e,t])=>null===t).map(([e])=>a.dy`<li>${e}</li>`),c=r.filter(([e,t])=>e===t).map(([e])=>a.dy`<li>${e}</li>`);d.length?(0,s.showConfirmationDialog)(e,{title:t.localize("ui.dialogs.recreate_entity_ids.confirm_rename_title"),text:a.dy`${t.localize("ui.dialogs.recreate_entity_ids.confirm_rename_warning")} <br><br> <ha-expansion-panel outlined> <span slot="header">${t.localize("ui.dialogs.recreate_entity_ids.will_rename",{count:d.length})}</span> <div style="overflow:auto"> <table style="width:100%;text-align:var(--float-start)"> <tr> <th>${t.localize("ui.dialogs.recreate_entity_ids.old")}</th> <th>${t.localize("ui.dialogs.recreate_entity_ids.new")}</th> </tr> ${d} </table> </div> </ha-expansion-panel> ${l.length?a.dy`<ha-expansion-panel outlined style="margin-top:8px"> <span slot="header">${t.localize("ui.dialogs.recreate_entity_ids.cant_rename",{count:l.length})}</span> ${l} </ha-expansion-panel>`:a.Ld} ${c.length?a.dy`<ha-expansion-panel outlined style="margin-top:8px"> <span slot="header">${t.localize("ui.dialogs.recreate_entity_ids.wont_change",{count:c.length})}</span> ${c} </ha-expansion-panel>`:a.Ld}`,confirmText:t.localize("ui.common.update"),dismissText:t.localize("ui.common.cancel"),destructive:!0,confirm:()=>{r.filter(([e,t])=>t&&e!==t).forEach(([i,a])=>(0,o.Nv)(t,i,{new_entity_id:a}).catch(a=>{(0,s.showAlertDialog)(e,{title:t.localize("ui.dialogs.recreate_entity_ids.update_entity_error",{entityId:i}),text:a.message})}))}}):(0,s.showAlertDialog)(e,{title:t.localize("ui.dialogs.recreate_entity_ids.confirm_no_renamable_entity_ids"),text:a.dy`${l.length?a.dy`<ha-expansion-panel outlined style="margin-top:8px"> <span slot="header">${t.localize("ui.dialogs.recreate_entity_ids.cant_rename",{count:l.length})}</span> ${l} </ha-expansion-panel>`:a.Ld} ${c.length?a.dy`<ha-expansion-panel outlined style="margin-top:8px"> <span slot="header">${t.localize("ui.dialogs.recreate_entity_ids.wont_change",{count:c.length})}</span> ${c} </ha-expansion-panel>`:a.Ld}`})}},66031:function(e,t,i){i.d(t,{k:()=>o});var a=i(39884);const s=()=>Promise.all([i.e("15486"),i.e("86689"),i.e("22549"),i.e("98831"),i.e("99028"),i.e("7850"),i.e("15634"),i.e("79576"),i.e("20278"),i.e("52585"),i.e("39432"),i.e("89112"),i.e("9036"),i.e("67606"),i.e("18231")]).then(i.bind(i,95541)),o=(e,t)=>{(0,a.B)(e,"show-dialog",{dialogTag:"ha-voice-assistant-setup-dialog",dialogImport:s,dialogParams:t})}},91793:function(e,t,i){i.a(e,async function(e,a){try{i.r(t);var s=i(73742),o=i(59048),n=i(26292),r=(i(45109),i(72953)),d=(i(11969),i(12942),e([r]));r=(d.then?(await d)():d)[0];class l extends o.oi{render(){return o.dy` ${this.toolbar?o.dy`<div class="toolbar"> ${this.rootnav||history.state?.root?o.dy` <ha-menu-button .hass="${this.hass}" .narrow="${this.narrow}"></ha-menu-button> `:o.dy` <ha-icon-button-arrow-prev .hass="${this.hass}" @click="${this._handleBack}"></ha-icon-button-arrow-prev> `} </div>`:""} <div class="content"> <ha-alert alert-type="error">${this.error}</ha-alert> <slot> <ha-button appearance="plain" size="small" @click="${this._handleBack}"> ${this.hass?.localize("ui.common.back")} </ha-button> </slot> </div> `}_handleBack(){history.back()}static get styles(){return[o.iv`:host{display:block;height:100%;background-color:var(--primary-background-color)}.toolbar{display:flex;align-items:center;font-size:var(--ha-font-size-xl);height:var(--header-height);padding:8px 12px;pointer-events:none;background-color:var(--app-header-background-color);font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,#fff);border-bottom:var(--app-header-border-bottom,none);box-sizing:border-box}@media (max-width:599px){.toolbar{padding:4px}}ha-icon-button-arrow-prev{pointer-events:auto}.content{color:var(--primary-text-color);height:calc(100% - var(--header-height));display:flex;padding:16px;align-items:center;justify-content:center;flex-direction:column;box-sizing:border-box}a{color:var(--primary-color)}ha-alert{margin-bottom:16px}`]}constructor(...e){super(...e),this.toolbar=!0,this.rootnav=!1,this.narrow=!1}}(0,s.__decorate)([(0,n.Cb)({attribute:!1})],l.prototype,"hass",void 0),(0,s.__decorate)([(0,n.Cb)({type:Boolean})],l.prototype,"toolbar",void 0),(0,s.__decorate)([(0,n.Cb)({type:Boolean})],l.prototype,"rootnav",void 0),(0,s.__decorate)([(0,n.Cb)({type:Boolean})],l.prototype,"narrow",void 0),(0,s.__decorate)([(0,n.Cb)()],l.prototype,"error",void 0),l=(0,s.__decorate)([(0,n.Mo)("hass-error-screen")],l),a()}catch(e){a(e)}})},51869:function(e,t,i){var a=i(73742),s=i(59048),o=i(26292),n=i(89868),r=(i(45109),i(11969),i(95814));class d extends s.oi{render(){return s.dy` <div class="toolbar"> ${this.mainPage||history.state?.root?s.dy` <ha-menu-button .hassio="${this.supervisor}" .hass="${this.hass}" .narrow="${this.narrow}"></ha-menu-button> `:this.backPath?s.dy` <a href="${this.backPath}"> <ha-icon-button-arrow-prev .hass="${this.hass}"></ha-icon-button-arrow-prev> </a> `:s.dy` <ha-icon-button-arrow-prev .hass="${this.hass}" @click="${this._backTapped}"></ha-icon-button-arrow-prev> `} <div class="main-title"><slot name="header">${this.header}</slot></div> <slot name="toolbar-icon"></slot> </div> <div class="content ha-scrollbar" @scroll="${this._saveScrollPos}"> <slot></slot> </div> <div id="fab"> <slot name="fab"></slot> </div> `}_saveScrollPos(e){this._savedScrollPos=e.target.scrollTop}_backTapped(){this.backCallback?this.backCallback():history.back()}static get styles(){return[r.$c,s.iv`:host{display:block;height:100%;background-color:var(--primary-background-color);overflow:hidden;position:relative}:host([narrow]){width:100%;position:fixed}.toolbar{display:flex;align-items:center;font-size:var(--ha-font-size-xl);height:var(--header-height);padding:8px 12px;background-color:var(--app-header-background-color);font-weight:var(--ha-font-weight-normal);color:var(--app-header-text-color,#fff);border-bottom:var(--app-header-border-bottom,none);box-sizing:border-box}@media (max-width:599px){.toolbar{padding:4px}}.toolbar a{color:var(--sidebar-text-color);text-decoration:none}::slotted([slot=toolbar-icon]),ha-icon-button-arrow-prev,ha-menu-button{pointer-events:auto;color:var(--sidebar-icon-color)}.main-title{margin:var(--margin-title);line-height:var(--ha-line-height-normal);min-width:0;flex-grow:1;overflow-wrap:break-word;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding-bottom:1px}.content{position:relative;width:100%;height:calc(100% - 1px - var(--header-height));overflow-y:auto;overflow:auto;-webkit-overflow-scrolling:touch}#fab{position:absolute;right:calc(16px + var(--safe-area-inset-right));inset-inline-end:calc(16px + var(--safe-area-inset-right));inset-inline-start:initial;bottom:calc(16px + var(--safe-area-inset-bottom));z-index:1;display:flex;flex-wrap:wrap;justify-content:flex-end;gap:8px}:host([narrow]) #fab.tabs{bottom:calc(84px + var(--safe-area-inset-bottom))}#fab[is-wide]{bottom:24px;right:24px;inset-inline-end:24px;inset-inline-start:initial}`]}constructor(...e){super(...e),this.mainPage=!1,this.narrow=!1,this.supervisor=!1}}(0,a.__decorate)([(0,o.Cb)({attribute:!1})],d.prototype,"hass",void 0),(0,a.__decorate)([(0,o.Cb)()],d.prototype,"header",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean,attribute:"main-page"})],d.prototype,"mainPage",void 0),(0,a.__decorate)([(0,o.Cb)({type:String,attribute:"back-path"})],d.prototype,"backPath",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],d.prototype,"backCallback",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean,reflect:!0})],d.prototype,"narrow",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean})],d.prototype,"supervisor",void 0),(0,a.__decorate)([(0,n.i)(".content")],d.prototype,"_savedScrollPos",void 0),(0,a.__decorate)([(0,o.hO)({passive:!0})],d.prototype,"_saveScrollPos",null),d=(0,a.__decorate)([(0,o.Mo)("hass-subpage")],d)},2609:function(e,t,i){i.d(t,{E:()=>o,O:()=>s});var a=i(39884);const s=()=>Promise.all([i.e("73614"),i.e("2243"),i.e("75696"),i.e("22549"),i.e("15634"),i.e("26452"),i.e("76782"),i.e("67024"),i.e("39432"),i.e("89112"),i.e("9036"),i.e("19596"),i.e("88995")]).then(i.bind(i,14065)),o=(e,t)=>{(0,a.B)(e,"show-dialog",{dialogTag:"dialog-area-registry-detail",dialogImport:s,dialogParams:t})}},48548:function(e,t,i){i.a(e,async function(e,t){try{i(2394),i(81738),i(94814),i(22960),i(6989);var a=i(73742),s=i(59048),o=i(26292),n=i(31733),r=i(12790),d=i(61981),l=i(55107),c=i(72953),h=(i(31138),i(46358),i(64881),i(69760),i(70947)),p=i(29402),u=i(99469),_=i(73804),g=i(9874),v=i(5915),b=e([c,g,p]);[c,g,p]=b.then?(await b)():b;class m extends s.oi{shouldUpdate(e){return e.has("hass")&&1===e.size?(this._entityRows.forEach(e=>{e.hass=this.hass}),!1):(this._entityRows=[],!0)}render(){if(!this.entities.length)return s.dy` <ha-card outlined .header="${this.header}"> <div class="empty card-content"> ${this.hass.localize("ui.panel.config.devices.entities.none")} </div> </ha-card> `;const e=[],t=[];return this.entities.forEach(i=>{i.disabled_by?this._extDisabledEntityEntries?t.push(this._extDisabledEntityEntries[i.entity_id]||i):t.push(i):e.push(i)}),s.dy` <ha-card outlined .header="${this.header}"> ${e.length?s.dy` <div id="entities" class="move-up"> <ha-list> ${e.map(e=>this.hass.states[e.entity_id]?this._renderEntity(e):this._renderEntry(e))} </ha-list> </div> `:s.Ld} ${t.length?s.dy`<div class="${(0,n.$)({"move-up":!e.length})}"> ${this.showHidden?s.dy` <ha-list> ${t.map(e=>this._renderEntry(e))} </ha-list> <button class="show-more" @click="${this._toggleShowHidden}"> ${this.hass.localize("ui.panel.config.devices.entities.show_less")} </button> `:s.dy` <button class="show-more" @click="${this._toggleShowHidden}"> ${this.hass.localize("ui.panel.config.devices.entities.disabled_entities",{count:t.length})} </button> `} </div>`:s.Ld} <div class="card-actions"> <ha-button appearance="plain" @click="${this._addToLovelaceView}"> ${this.hass.localize("ui.panel.config.devices.entities.add_entities_lovelace")} </ha-button> </div> </ha-card> `}_toggleShowHidden(){if(this.showHidden=!this.showHidden,!this.showHidden||void 0!==this._extDisabledEntityEntries)return;this._extDisabledEntityEntries={};const e=this.entities.filter(e=>e.disabled_by),t=async()=>{if(0===e.length)return;const i=e.pop().entity_id,a=await(0,h.L3)(this.hass,i);this._extDisabledEntityEntries[i]=a,this.requestUpdate("_extDisabledEntityEntries"),t()};t(),t(),t()}_renderEntity(e){const t={entity:e.entity_id},i=(0,g.m)(t);if(this.hass){i.hass=this.hass;const a=this.hass.states[e.entity_id];let s=(0,d.K)(a,this.hass)||this.deviceName;e.hidden_by&&(s+=` (${this.hass.localize("ui.panel.config.devices.entities.hidden")})`),t.name=s}return i.entry=e,this._entityRows.push(i),s.dy` <div>${i}</div> `}_renderEntry(e){const t=e.stateName||e.name||e.original_name,i=(0,r.C)((0,p.xA)(this.hass,e));return s.dy` <ha-list-item graphic="icon" class="disabled-entry" .entry="${e}" @click="${this._openEditEntry}"> <ha-icon slot="graphic" .icon="${i}"></ha-icon> <div class="name"> ${t?(0,l.N)(t,this.deviceName)||t:e.entity_id} </div> </ha-list-item> `}_openEditEntry(e){const t=e.currentTarget.entry;(0,u.A)(this,{entityId:t.entity_id})}_addToLovelaceView(){const e=this.entities.filter(e=>!e.disabled_by).map(e=>e.entity_id);(0,v.$)(this,this.hass,(0,_.VG)(this.hass.states,e,{title:this.deviceName}),(0,_.lY)(e,{title:this.deviceName}),e)}constructor(...e){super(...e),this.showHidden=!1,this._entityRows=[]}}m.styles=s.iv`:host{display:block}ha-icon{margin-left:-8px}.entity-id{color:var(--secondary-text-color)}.buttons{text-align:right;margin:0 0 0 8px}.disabled-entry{color:var(--secondary-text-color)}.move-up{margin-top:-13px}.move-up:has(> ha-list){margin-top:-24px}:not(.move-up)>ha-list{margin-top:-24px}.move-up+:not(:has(ha-list))>button.show-more,ha-list+button.show-more{margin-top:-12px}#entities>ha-list{margin:0 16px 0 8px}.name{font-size:var(--ha-font-size-m)}.name:dir(rtl){margin-inline-start:8px}.empty{text-align:center}button.show-more{color:var(--primary-color);text-align:left;cursor:pointer;background:0 0;border-width:initial;border-style:none;border-color:initial;border-image:initial;padding:16px;font:inherit}button.show-more:focus{outline:0;text-decoration:underline}ha-list>*{margin:8px 0px}ha-list-item{height:40px;--mdc-ripple-color:transparent}.card-actions{padding:4px 16px 4px 4px}`,(0,a.__decorate)([(0,o.Cb)()],m.prototype,"header",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],m.prototype,"deviceName",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],m.prototype,"hass",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],m.prototype,"entities",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:"show-hidden",type:Boolean})],m.prototype,"showHidden",void 0),(0,a.__decorate)([(0,o.SB)()],m.prototype,"_extDisabledEntityEntries",void 0),m=(0,a.__decorate)([(0,o.Mo)("ha-device-entities-card")],m),t()}catch(e){t(e)}})},99456:function(e,t,i){i(81738),i(94814),i(6989);var a=i(73742),s=i(59048),o=i(26292),n=i(58125),r=i(22329),d=(i(31138),i(95814)),l=i(64637),c=i(37528);class h extends s.oi{render(){return s.dy` <ha-card outlined .header="${this.hass.localize("ui.panel.config.devices.device_info",{type:this.hass.localize(`ui.panel.config.devices.type.${this.device.entry_type||"device"}_heading`)})}"> <div class="card-content"> ${this.device.model?s.dy`<div class="model"> ${this.device.model} ${this.device.model_id?s.dy`(${this.device.model_id})`:""} </div>`:this.device.model_id?s.dy`<div class="model">${this.device.model_id}</div>`:""} ${this.device.manufacturer?s.dy` <div class="manuf"> ${this.hass.localize("ui.panel.config.integrations.config_entry.manuf",{manufacturer:this.device.manufacturer})} </div> `:""} ${this.device.via_device_id?s.dy` <div class="extra-info"> ${this.hass.localize("ui.panel.config.integrations.config_entry.via")} <span class="hub"><a href="/config/devices/device/${this.device.via_device_id}">${this._computeDeviceNameDislay(this.device.via_device_id)}</a></span> </div> `:""} ${this.device.sw_version?s.dy` <div class="extra-info"> ${this.hass.localize("ui.panel.config.integrations.config_entry."+("service"!==this.device.entry_type||this.device.hw_version?"firmware":"version"),{version:this.device.sw_version})} </div> `:""} ${this.device.hw_version?s.dy` <div class="extra-info"> ${this.hass.localize("ui.panel.config.integrations.config_entry.hardware",{version:this.device.hw_version})} </div> `:""} ${this.device.serial_number?s.dy` <div class="extra-info"> ${this.hass.localize("ui.panel.config.integrations.config_entry.serial_number",{serial_number:this.device.serial_number})} </div> `:""} ${this._getAddresses().map(([e,t])=>s.dy` <div class="extra-info"> ${"bluetooth"===e&&(0,c.p)(this.hass,"bluetooth")?s.dy`${(0,r.Q)(e)}: <a href="/config/bluetooth/advertisement-monitor?${(0,l.ou)({address:t})}">${t.toUpperCase()}</a>`:"mac"===e&&(0,c.p)(this.hass,"dhcp")?s.dy`MAC: <a href="/config/dhcp?${(0,l.ou)({mac_address:t})}">${t.toUpperCase()}</a>`:s.dy`${"mac"===e?"MAC":(0,r.Q)(e)}: ${t.toUpperCase()}`} </div> `)} <slot></slot> </div> <slot name="actions"></slot> </ha-card> `}_getAddresses(){return this.device.connections.filter(e=>"mac"===e[0]||"bluetooth"===e[0])}_computeDeviceNameDislay(e){const t=this.hass.devices[e];return t?(0,n.wZ)(t,this.hass):`<${this.hass.localize("ui.panel.config.integrations.config_entry.unknown_via_device")}>`}static get styles(){return[d.Qx,s.iv`:host{display:block}ha-card{flex:1 0 100%;min-width:0}.device{width:30%}.extra-info{margin-top:8px;word-wrap:break-word}.manuf,.model{color:var(--secondary-text-color);word-wrap:break-word}`]}constructor(...e){super(...e),this.narrow=!1}}(0,a.__decorate)([(0,o.Cb)({attribute:!1})],h.prototype,"hass",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],h.prototype,"device",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean})],h.prototype,"narrow",void 0),h=(0,a.__decorate)([(0,o.Mo)("ha-device-info-card")],h)},71998:function(e,t,i){i(81738),i(94814),i(6989);var a=i(73742),s=i(59048),o=i(26292),n=i(28105),r=i(58125),d=i(36221);i(31138),i(5786),i(69760);class l extends s.oi{render(){const e=this._viaDevices(this.deviceId,this.hass.devices);return 0===e.length?s.Ld:s.dy` <ha-card> <h1 class="card-header"> ${this.hass.localize("ui.panel.config.devices.connected_devices.heading")} </h1> ${(this._showAll?e:e.slice(0,10)).map(e=>s.dy` <a href="${`/config/devices/device/${e.id}`}"> <ha-list-item hasMeta> ${(0,r.wZ)(e,this.hass)} <ha-icon-next slot="meta"></ha-icon-next> </ha-list-item> </a> `)} ${!this._showAll&&e.length>10?s.dy` <button class="show-more" @click="${this._toggleShowAll}"> ${this.hass.localize("ui.panel.config.devices.connected_devices.show_more",{count:e.length-10})} </button> `:""} </ha-card> `}_toggleShowAll(){this._showAll=!this._showAll}constructor(...e){super(...e),this._showAll=!1,this._viaDevices=(0,n.Z)((e,t)=>Object.values(t).filter(t=>t.via_device_id===e).sort((e,t)=>(0,d.fe)((0,r.wZ)(e,this.hass),(0,r.wZ)(t,this.hass),this.hass.locale.language)))}}l.styles=s.iv`:host{display:block}.card-header{padding-bottom:0}a{text-decoration:none;color:var(--primary-text-color)}button.show-more{color:var(--primary-color);text-align:left;cursor:pointer;background:0 0;border-width:initial;border-style:none;border-color:initial;border-image:initial;padding:16px;font:inherit}button.show-more:focus{outline:0;text-decoration:underline}`,(0,a.__decorate)([(0,o.Cb)({attribute:!1})],l.prototype,"hass",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],l.prototype,"deviceId",void 0),(0,a.__decorate)([(0,o.SB)()],l.prototype,"_showAll",void 0),l=(0,a.__decorate)([(0,o.Mo)("ha-device-via-devices-card")],l)},82945:function(e,t,i){i.d(t,{J:()=>o});var a=i(39884);const s=()=>i.e("77624").then(i.bind(i,87124)),o=(e,t)=>{(0,a.B)(e,"show-dialog",{dialogTag:"dialog-device-automation",dialogImport:s,dialogParams:t})}},25277:function(e,t,i){i.d(t,{O:()=>s,r:()=>o});var a=i(39884);const s=()=>Promise.all([i.e("75696"),i.e("22549"),i.e("15634"),i.e("56432"),i.e("89112"),i.e("45578")]).then(i.bind(i,15006)),o=(e,t)=>{(0,a.B)(e,"show-dialog",{dialogTag:"dialog-device-registry-detail",dialogImport:s,dialogParams:t})}},66781:function(e,t,i){i.a(e,async function(e,t){try{i(2394),i(81738),i(94814),i(29981),i(22960),i(6989),i(72489);var a=i(73742),s=i(72644),o=i(59048),n=i(26292),r=i(25191),d=i(28105),l=i(37528),c=i(40141),h=i(58125),p=i(44272),u=i(61981),_=i(6219),g=i(15459),v=i(36221),b=i(64564),m=(i(26979),i(12942),i(72953)),y=(i(41037),i(48017),i(5786),i(69760),i(993),i(80298)),f=i(96975),$=i(60673),w=i(84075),x=i(97133),k=i(28905),C=i(27689),z=i(70947),L=i(96222),A=i(10734),E=i(40853),S=i(2528),I=i(72242),M=i(66031),B=i(91793),D=(i(51869),i(95814)),H=i(35580),T=i(71876),P=i(25624),O=i(48548),V=(i(99456),i(71998),i(82945)),j=i(25277),N=e([m,y,B,P,O]);[m,y,B,P,O]=N.then?(await N)():N;const U="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z",W="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z",Z="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",R="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z",F="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z",G="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z",Y="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z",K="M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",Q="M13,3A9,9 0 0,0 4,12H1L4.89,15.89L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3Z",q=3e4;class J extends o.oi{willUpdate(e){super.willUpdate(e),e.has("deviceId")&&(this._deviceActions=[],this._deviceAlerts=[],this._deleteButtons=[],this._diagnosticDownloadLinks=[]),(e.has("deviceId")||e.has("entries"))&&this._fetchData()}firstUpdated(e){super.firstUpdated(e),(0,j.O)()}updated(e){super.updated(e),e.has("deviceId")&&this._findRelated()}disconnectedCallback(){super.disconnectedCallback(),clearTimeout(this._deviceAlertsActionsTimeout)}render(){if(!this.hass||!this.deviceId)return o.Ld;const e=this.hass.devices[this.deviceId];if(!e)return o.dy` <hass-error-screen .hass="${this.hass}" .error="${this.hass.localize("ui.panel.config.devices.device_not_found")}"></hass-error-screen> `;const t=(0,h.wZ)(e,this.hass),i=this._integrations(e,this.entries,this.manifests),a=this._entities(this.deviceId,this._entityReg),s=this._entitiesByCategory(a),n=this._batteryEntity(a),d=this._batteryChargingEntity(a),c=n?this.hass.states[n.entity_id]:void 0,p=c?(0,_.N)(c):void 0,u=d?this.hass.states[d.entity_id]:void 0,v=e.area_id?this.hass.areas[e.area_id]:void 0,b=i.map(e=>o.dy`<a slot="actions" href="${`/config/integrations/integration/${e.domain}#config_entry=${e.entry_id}`}"> <ha-list-item graphic="icon" hasMeta> <img slot="graphic" alt="${(0,L.Lh)(this.hass.localize,e.domain)}" src="${(0,H.X1)({domain:e.domain,type:"icon",darkOptimized:this.hass.themes?.darkMode})}" crossorigin="anonymous" referrerpolicy="no-referrer" @error="${this._onImageError}" @load="${this._onImageLoad}"> ${(0,L.Lh)(this.hass.localize,e.domain)} <ha-icon-next slot="meta"></ha-icon-next> </ha-list-item> </a>`),m=[...this._deviceActions||[]];Array.isArray(this._diagnosticDownloadLinks)&&m.push(...this._diagnosticDownloadLinks),this._deleteButtons&&m.push(...this._deleteButtons),m.sort((e,t)=>"warning"===e.classes&&"warning"!==t.classes?1:"warning"!==e.classes&&"warning"===t.classes?-1:0);const y=m.shift();e.disabled_by&&b.push(o.dy` <ha-alert alert-type="warning"> ${this.hass.localize("ui.panel.config.devices.enabled_cause",{type:this.hass.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`),cause:this.hass.localize(`ui.panel.config.devices.disabled_by.${e.disabled_by}`)})} </ha-alert> ${"user"===e.disabled_by?o.dy` <div class="card-actions" slot="actions"> <ha-button variant="warning" size="small" @click="${this._enableDevice}"> ${this.hass.localize("ui.common.enable")} </ha-button> </div> `:""} `),this._renderIntegrationInfo(e,i,b);const f=e.disabled_by?this.hass.localize("ui.panel.config.devices.add_prompt_disabled"):this.hass.localize("ui.panel.config.devices.add_prompt_enabled"),$=(0,l.p)(this.hass,"automation")?o.dy` <ha-card outlined> <h1 class="card-header"> ${this.hass.localize("ui.panel.config.devices.automation.automations_heading")} <ha-icon-button @click="${this._showAutomationDialog}" .disabled="${e.disabled_by}" .label="${e.disabled_by?this.hass.localize("ui.panel.config.devices.automation.create_disable",{type:this.hass.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`)}):this.hass.localize("ui.panel.config.devices.automation.create",{type:this.hass.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`)})}" .path="${K}"></ha-icon-button> </h1> ${this._related?.automation?.length?o.dy` <div class="items"> ${this._getRelated(this._related).automation.map(e=>{const t=e;return t?o.dy`<a href="${(0,r.o)(t.attributes.id?`/config/automation/edit/${encodeURIComponent(t.attributes.id)}`:`/config/automation/show/${t.entity_id}`)}"> <ha-list-item hasMeta .automation="${t}"> ${(0,g.C)(t)} <ha-icon-next slot="meta"></ha-icon-next> </ha-list-item> </a>`:o.Ld})} </div> `:o.dy` <div class="card-content"> ${this.hass.localize("ui.panel.config.devices.add_prompt",{name:this.hass.localize("ui.panel.config.devices.automation.automations"),type:this.hass.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`)})} ${f} </div> `} </ha-card> `:"",w=(0,l.p)(this.hass,"scene")&&a.length?o.dy` <ha-card outlined> <h1 class="card-header"> ${this.hass.localize("ui.panel.config.devices.scene.scenes_heading")} <ha-icon-button @click="${this._createScene}" .disabled="${e.disabled_by}" .label="${e.disabled_by?this.hass.localize("ui.panel.config.devices.scene.create_disable",{type:this.hass.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`)}):this.hass.localize("ui.panel.config.devices.scene.create",{type:this.hass.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`)})}" .path="${K}"></ha-icon-button> </h1> ${this._related?.scene?.length?o.dy` <div class="items"> ${this._getRelated(this._related).scene.map(e=>{const t=e;return t&&t.attributes.id?o.dy` <a href="${`/config/scene/edit/${t.attributes.id}`}"> <ha-list-item hasMeta .scene="${t}"> ${(0,g.C)(t)} <ha-icon-next slot="meta"></ha-icon-next> </ha-list-item> </a> `:o.dy` <ha-tooltip placement="left" .content="${this.hass.localize("ui.panel.config.devices.cant_edit")}"> <ha-list-item hasMeta .scene="${t}"> ${(0,g.C)(t)} <ha-icon-next slot="meta"></ha-icon-next> </ha-list-item> </ha-tooltip> `})} </div> `:o.dy` <div class="card-content"> ${this.hass.localize("ui.panel.config.devices.add_prompt",{name:this.hass.localize("ui.panel.config.devices.scene.scenes"),type:this.hass.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`)})} ${f} </div> `} </ha-card> `:"",x=(0,l.p)(this.hass,"script")?o.dy` <ha-card outlined> <h1 class="card-header"> ${this.hass.localize("ui.panel.config.devices.script.scripts_heading")} <ha-icon-button @click="${this._showScriptDialog}" .disabled="${e.disabled_by}" .label="${e.disabled_by?this.hass.localize("ui.panel.config.devices.script.create_disable",{type:this.hass.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`)}):this.hass.localize("ui.panel.config.devices.script.create",{type:this.hass.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`)})}" .path="${K}"></ha-icon-button> </h1> ${this._related?.script?.length?o.dy` <div class="items"> ${this._getRelated(this._related).script.map(e=>{const t=e,i=this._entityReg.find(t=>t.entity_id===e.entity_id);let a=`/config/script/show/${t.entity_id}`;return i&&(a=`/config/script/edit/${i.unique_id}`),t?o.dy` <a href="${a}"> <ha-list-item hasMeta .script="${e}"> ${(0,g.C)(t)} <ha-icon-next slot="meta"></ha-icon-next> </ha-list-item> </a> `:""})} </div> `:o.dy` <div class="card-content"> ${this.hass.localize("ui.panel.config.devices.add_prompt",{name:this.hass.localize("ui.panel.config.devices.script.scripts"),type:this.hass.localize(`ui.panel.config.devices.type.${e.entry_type||"device"}`)})} ${f} </div> `} </ha-card> `:"";return o.dy`<hass-subpage .hass="${this.hass}" .narrow="${this.narrow}" .header="${t}"> <ha-icon-button slot="toolbar-icon" .path="${Y}" @click="${this._showSettings}" .label="${this.hass.localize("ui.panel.config.devices.edit_settings")}"></ha-icon-button> <ha-md-button-menu slot="toolbar-icon"> <ha-icon-button slot="trigger" .label="${this.hass.localize("ui.common.menu")}" .path="${Z}"></ha-icon-button> <ha-md-menu-item .clickAction="${this._resetEntityIds}"> <ha-svg-icon slot="start" .path="${Q}"></ha-svg-icon> <div slot="headline"> ${this.hass.localize("ui.panel.config.devices.restore_entity_ids")} </div> </ha-md-menu-item> </ha-md-button-menu> <div class="container"> <div class="header fullwidth"> ${v?o.dy`<div class="header-name"> <a href="/config/areas/area/${v.area_id}">${this.hass.localize("ui.panel.config.integrations.config_entry.area",{area:v.name||"Unnamed Area"})}</a> </div>`:""} <div class="header-right"> ${!c||"binary_sensor"!==p&&isNaN(c.state)?"":o.dy` <div class="battery"> ${"sensor"===p?this.hass.formatEntityState(c):o.Ld} <ha-battery-icon .hass="${this.hass}" .batteryStateObj="${c}" .batteryChargingStateObj="${u}"></ha-battery-icon> </div> `} ${i.length?o.dy` <img alt="${(0,L.Lh)(this.hass.localize,i[0].domain)}" src="${(0,H.X1)({domain:i[0].domain,type:"logo",darkOptimized:this.hass.themes?.darkMode})}" crossorigin="anonymous" referrerpolicy="no-referrer" @load="${this._onImageLoad}" @error="${this._onImageError}"> `:""} </div> </div> <div class="column"> ${this._deviceAlerts?.length?o.dy` <div> ${this._deviceAlerts.map(e=>o.dy` <ha-alert .alertType="${e.level}"> ${e.text} </ha-alert> `)} </div> `:""} <ha-device-info-card .hass="${this.hass}" .device="${e}"> ${b} ${y||m.length?o.dy` <div class="card-actions" slot="actions"> <div> <ha-button href="${(0,r.o)(y.href)}" rel="${(0,r.o)(y.target?"noreferrer":void 0)}" appearance="plain" target="${(0,r.o)(y.target)}" class="${(0,r.o)(y.classes)}" .action="${y.action}" @click="${this._deviceActionClicked}"> ${y.label} ${y.icon?o.dy` <ha-svg-icon class="${(0,r.o)(y.classes)}" .path="${y.icon}" slot="start"></ha-svg-icon> `:o.Ld} ${y.trailingIcon?o.dy` <ha-svg-icon .path="${y.trailingIcon}" slot="end"></ha-svg-icon> `:o.Ld} </ha-button> </div> ${m.length?o.dy` <ha-button-menu> <ha-icon-button slot="trigger" .label="${this.hass.localize("ui.common.menu")}" .path="${Z}"></ha-icon-button> ${m.map(e=>{const t=o.dy`<ha-list-item class="${(0,r.o)(e.classes)}" .action="${e.action}" @click="${this._deviceActionClicked}" graphic="icon" .hasMeta="${Boolean(e.trailingIcon)}"> ${e.label} ${e.icon?o.dy` <ha-svg-icon class="${(0,r.o)(e.classes)}" .path="${e.icon}" slot="graphic"></ha-svg-icon> `:""} ${e.trailingIcon?o.dy` <ha-svg-icon slot="meta" .path="${e.trailingIcon}"></ha-svg-icon> `:""} </ha-list-item>`;return e.href?o.dy`<a href="${e.href}" target="${(0,r.o)(e.target)}" rel="${(0,r.o)(e.target?"noreferrer":void 0)}">${t} </a>`:t})} </ha-button-menu> `:""} </div> `:""} </ha-device-info-card> ${this.narrow?"":[$,w,x]} </div> <div class="column"> ${["control","sensor","notify","event","assist","config","diagnostic"].map(i=>s[i].length>0||0===a.length&&"control"===i?o.dy` <ha-device-entities-card .hass="${this.hass}" .header="${this.hass.localize(`ui.panel.config.devices.entities.${i}`)}" .deviceName="${t}" .entities="${s[i]}" .showHidden="${null!==e.disabled_by}"> </ha-device-entities-card> `:"")} <ha-device-via-devices-card .hass="${this.hass}" .deviceId="${this.deviceId}"></ha-device-via-devices-card> </div> <div class="column"> ${this.narrow?[$,w,x]:""} ${(0,l.p)(this.hass,"logbook")?o.dy` <ha-card outlined> <h1 class="card-header"> ${this.hass.localize("panel.logbook")} </h1> <ha-logbook .hass="${this.hass}" .time="${this._logbookTime}" .entityIds="${this._entityIds(a)}" .deviceIds="${this._deviceIdInList(this.deviceId)}" virtualize narrow no-icon></ha-logbook> </ha-card> `:""} </div> </div> </hass-subpage>`}_fetchData(){this.deviceId&&this.entries.length&&(this._getDiagnosticButtons(),this._getDeleteActions(),clearTimeout(this._deviceAlertsActionsTimeout),this._getDeviceActions(),this._getDeviceAlerts())}async _getDiagnosticButtons(){const e=this.deviceId;if(!(0,l.p)(this.hass,"diagnostics"))return;const t=this.hass.devices[this.deviceId];if(!t)return;let i=await Promise.all(this._integrations(t,this.entries,this.manifests).map(async e=>{if("loaded"!==e.state)return!1;let t;try{t=await(0,C.lf)(this.hass,e.domain)}catch(e){if("not_found"===e.code)return!1;throw e}return!(!t.handlers.device&&!t.handlers.config_entry)&&{link:t.handlers.device?(0,C.ZK)(e.entry_id,this.deviceId):(0,C.iP)(e.entry_id),domain:e.domain}}));i=i.filter(Boolean),this.deviceId===e&&i.length>0&&(this._diagnosticDownloadLinks=i.map(e=>({href:e.link,icon:R,action:e=>this._signUrl(e),label:i.length>1?this.hass.localize("ui.panel.config.devices.download_diagnostics_integration",{integration:(0,L.Lh)(this.hass.localize,e.domain)}):this.hass.localize("ui.panel.config.devices.download_diagnostics")})))}_getDeleteActions(){const e=this.deviceId,t=this.hass.devices[this.deviceId];if(!t)return;const i=[];this._integrations(t,this.entries,this.manifests).forEach(e=>{"loaded"===e.state&&e.supports_remove_device&&i.push({action:async()=>{if(await(0,I.showConfirmationDialog)(this,{text:this._integrations(t,this.entries,this.manifests).length>1?this.hass.localize("ui.panel.config.devices.confirm_delete_integration",{integration:(0,L.Lh)(this.hass.localize,e.domain)}):this.hass.localize("ui.panel.config.devices.confirm_delete"),confirmText:this.hass.localize("ui.common.delete"),dismissText:this.hass.localize("ui.common.cancel"),destructive:!0}))try{await(0,k.dl)(this.hass,this.deviceId,e.entry_id)}catch(e){(0,I.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.devices.error_delete"),text:e.message})}},classes:"warning",icon:W,label:this._integrations(t,this.entries,this.manifests).length>1?this.hass.localize("ui.panel.config.devices.delete_device_integration",{integration:(0,L.Lh)(this.hass.localize,e.domain)}):this.hass.localize("ui.panel.config.devices.delete_device")})}),this.deviceId===e&&i.length>0&&(this._deleteButtons=i)}async _getDeviceActions(){const e=this.deviceId,t=this.hass.devices[this.deviceId];if(!t)return;const a=[],s=t.configuration_url?.startsWith("homeassistant://")||!1,o=s?t.configuration_url.replace("homeassistant://","/"):t.configuration_url;o&&a.push({href:o,target:s?void 0:"_blank",icon:U,label:this.hass.localize("ui.panel.config.devices.open_configuration_url"),trailingIcon:G});const n=this._entities(this.deviceId,this._entityReg).find(e=>"assist_satellite"===(0,p.M)(e.entity_id)),r=this._integrations(t,this.entries,this.manifests).map(e=>e.domain);if(!r.includes("voip")&&n&&(0,f.Bg)(this.hass.states[n.entity_id])&&a.push({action:this._voiceAssistantSetup,label:this.hass.localize("ui.panel.config.devices.set_up_voice_assistant"),icon:F}),r.includes("mqtt")){const e=(await i.e("34966").then(i.bind(i,52738))).getMQTTDeviceActions(this,t);a.push(...e)}if(r.includes("zha")){const e=await i.e("30717").then(i.bind(i,18814)),s=await e.getZHADeviceActions(this,this.hass,t);a.push(...s)}if(r.includes("zwave_js")){const e=await i.e("23370").then(i.bind(i,99793)),s=await e.getZwaveDeviceActions(this,this.hass,t);a.push(...s)}if(r.includes("matter")){const s=await i.e("79829").then(i.bind(i,33063)),o=s.getMatterDeviceDefaultActions(this,this.hass,t);a.push(...o),s.getMatterDeviceActions(this,this.hass,t).then(t=>{this.deviceId===e&&(this._deviceActions=[...t,...this._deviceActions||[]])})}this.deviceId===e&&(this._deviceActions=a)}async _getDeviceAlerts(){const e=this.deviceId,t=this.hass.devices[this.deviceId];if(!t)return;const a=[];if(this._integrations(t,this.entries,this.manifests).map(e=>e.domain).includes("zwave_js")){const e=await i.e("57780").then(i.bind(i,7143)),s=await e.getZwaveDeviceAlerts(this.hass,t);a.push(...s)}this.deviceId===e&&(this._deviceAlerts=a,a.length&&(this._deviceAlertsActionsTimeout=window.setTimeout(()=>{this._getDeviceAlerts(),this._getDeviceActions()},q)))}_computeEntityName(e){const t=this.hass.devices[this.deviceId];return(0,u.T)(e,this.hass)||(0,h.wZ)(t,this.hass)}_onImageLoad(e){e.target.style.display="inline-block"}_onImageError(e){e.target.style.display="none"}async _findRelated(){this._related=await(0,S.K)(this.hass,"device",this.deviceId)}_createScene(){const e={};this._entities(this.deviceId,this._entityReg).forEach(t=>{e[t.entity_id]=""}),(0,E.mR)({entities:e})}_showScriptDialog(){(0,V.J)(this,{device:this.hass.devices[this.deviceId],entityReg:this._entityReg,script:!0})}_showAutomationDialog(){(0,V.J)(this,{device:this.hass.devices[this.deviceId],entityReg:this._entityReg,script:!1})}_renderIntegrationInfo(e,t,a){const s=t.map(e=>e.domain);s.includes("zha")&&(i.e("6440").then(i.bind(i,62121)),a.push(o.dy` <ha-device-info-zha .hass="${this.hass}" .device="${e}"></ha-device-info-zha> `)),s.includes("zwave_js")&&(i.e("85037").then(i.bind(i,21445)),a.push(o.dy` <ha-device-info-zwave_js .hass="${this.hass}" .device="${e}"></ha-device-info-zwave_js> `)),s.includes("matter")&&(i.e("51114").then(i.bind(i,21979)),a.push(o.dy` <ha-device-info-matter .hass="${this.hass}" .device="${e}"></ha-device-info-matter> `))}async _enableDevice(){await(0,k.t1)(this.hass,this.deviceId,{disabled_by:null})}async _signUrl(e){const t=e.currentTarget.getAttribute("href")?e.currentTarget:e.currentTarget.closest("a"),i=await(0,$.iI)(this.hass,t.getAttribute("href"));(0,T.N)(i.path)}_deviceActionClicked(e){e.currentTarget.action&&(e.preventDefault(),e.currentTarget.action(e))}static get styles(){return[D.Qx,o.iv`.container{display:flex;flex-wrap:wrap;margin:auto;max-width:1000px;margin-top:32px;margin-bottom:32px}.card-header{display:flex;align-items:center;justify-content:space-between;padding-bottom:12px}.card-header ha-icon-button{margin-right:-8px;margin-inline-end:-8px;margin-inline-start:initial;color:var(--primary-color);height:auto;direction:var(--direction)}.device-info{padding:16px}h1{margin:0;font-family:var(--ha-font-family-body);-webkit-font-smoothing:var(--ha-font-smoothing);-moz-osx-font-smoothing:var(--ha-moz-osx-font-smoothing);font-size:var(--ha-font-size-2xl);font-weight:var(--ha-font-weight-normal);line-height:var(--ha-line-height-condensed);opacity:var(--dark-primary-opacity)}.header{display:flex;justify-content:space-between}.header-name{display:flex;align-items:center;padding-left:8px;padding-inline-start:8px;padding-inline-end:initial;direction:var(--direction)}.column,.fullwidth{padding:8px;box-sizing:border-box}.column{width:33%;flex-grow:1}.fullwidth{width:100%;flex-grow:1}.header-right{align-self:center}.header-right img{height:30px}.header-right{display:flex}.header-right:first-child{width:100%;justify-content:flex-end}.header-right>:not(:first-child){margin-left:16px;margin-inline-start:16px;margin-inline-end:initial;direction:var(--direction)}.battery{align-self:center;align-items:center;display:flex;white-space:nowrap}.column>:not(:first-child){margin-top:16px}:host([narrow]) .column{width:100%}:host([narrow]) .container{margin-top:0}a{text-decoration:none;color:var(--primary-color)}ha-card a{color:var(--primary-text-color)}ha-svg-icon[slot=trailingIcon]{display:block;width:18px;height:18px;margin-inline-start:8px;margin-inline-end:initial}ha-svg-icon[slot=meta]{width:18px;height:18px}.items{padding-bottom:16px}ha-card:has(ha-logbook){padding-bottom:var(--ha-card-border-radius,12px)}ha-logbook{height:400px}:host([narrow]) ha-logbook{height:235px}.card-actions{display:flex;justify-content:space-between;align-items:center;padding:4px 16px 4px 4px}`]}constructor(...e){super(...e),this.narrow=!1,this.isWide=!1,this.showAdvanced=!1,this._diagnosticDownloadLinks=[],this._deleteButtons=[],this._deviceActions=[],this._deviceAlerts=[],this._logbookTime={recent:86400},this._integrations=(0,d.Z)((e,t,i)=>{const a={};for(const e of t)a[e.entry_id]=e;const s={};for(const e of i)s[e.domain]=e;const o=e.config_entries.filter(e=>e in a).map(e=>a[e]);return(0,w.Pk)(o,e.primary_config_entry)}),this._entities=(0,d.Z)((e,t)=>t.filter(t=>t.device_id===e).map(e=>({...e,stateName:this._computeEntityName(e)})).sort((e,t)=>(0,v.$K)(e.stateName||`zzz${e.entity_id}`,t.stateName||`zzz${t.entity_id}`,this.hass.locale.language))),this._getEntitiesSorted=e=>e.sort((e,t)=>(0,v.$K)(e.attributes.friendly_name||`zzz${e.entity_id}`,t.attributes.friendly_name||`zzz${t.entity_id}`,this.hass.locale.language)),this._getRelated=(0,d.Z)(e=>({automation:this._getEntitiesSorted((e?.automation??[]).map(e=>this.hass.states[e])),scene:this._getEntitiesSorted((e?.scene??[]).map(e=>this.hass.states[e])),script:this._getEntitiesSorted((e?.script??[]).map(e=>this.hass.states[e]))})),this._deviceIdInList=(0,d.Z)(e=>[e]),this._entityIds=(0,d.Z)(e=>e.map(e=>e.entity_id)),this._entitiesByCategory=(0,d.Z)(e=>{const t=(0,b.v)(e,e=>{const t=(0,p.M)(e.entity_id);return c.a5.includes(t)?"assist":"event"===t||"notify"===t?t:e.entity_category?e.entity_category:c.zF.includes(t)?"sensor":"control"});for(const e of["assist","config","control","diagnostic","event","notify","sensor"])e in t||(t[e]=[]);return t}),this._batteryEntity=(0,d.Z)(e=>(0,z.eD)(this.hass,e)),this._batteryChargingEntity=(0,d.Z)(e=>(0,z.wX)(this.hass,e)),this._resetEntityIds=()=>{const e=this._entities(this.deviceId,this._entityReg).map(e=>e.entity_id);(0,A.t)(this,this.hass,e)},this._showSettings=async()=>{const e=this.hass.devices[this.deviceId];(0,j.r)(this,{device:e,updateEntry:async t=>{const i=e.name_by_user||e.name,a=t.name_by_user;if("user"===t.disabled_by&&"user"!==e.disabled_by){for(const i of e.config_entries)if(!Object.values(this.hass.devices).some(t=>t.id!==e.id&&t.config_entries.includes(i))){const e=this.entries.find(e=>e.entry_id===i);if(e&&!e.disabled_by&&await(0,I.showConfirmationDialog)(this,{title:this.hass.localize("ui.panel.config.devices.confirm_disable_config_entry_title"),text:this.hass.localize("ui.panel.config.devices.confirm_disable_config_entry_message",{name:e.title}),destructive:!0,confirmText:this.hass.localize("ui.common.yes"),dismissText:this.hass.localize("ui.common.no")})){let e;try{e=await(0,w.Ny)(this.hass,i)}catch(e){return void(0,I.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.integrations.config_entry.disable_error"),text:e.message})}e.require_restart&&(0,I.showAlertDialog)(this,{text:this.hass.localize("ui.panel.config.integrations.config_entry.disable_restart_confirm")}),delete t.disabled_by}}}else null!==t.disabled_by&&"user"!==t.disabled_by&&delete t.disabled_by;try{await(0,k.t1)(this.hass,this.deviceId,t)}catch(e){return void(0,I.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.devices.update_device_error"),text:e.message})}if(!i||!a||i===a)return;const s=this._entities(this.deviceId,this._entityReg).map(e=>{const t=e.name||e.stateName;let s;if(!e.has_entity_name||e.name){if(!e.has_entity_name||e.name!==i&&e.name!==a){if(!t||!t.includes(i))return;s=t.replace(i,a)}else s=null;return(0,z.Nv)(this.hass,e.entity_id,{name:s})}});await Promise.all(s)}})},this._voiceAssistantSetup=()=>{(0,M.k)(this,{deviceId:this.deviceId})}}}(0,a.__decorate)([(0,n.Cb)({attribute:!1})],J.prototype,"hass",void 0),(0,a.__decorate)([(0,n.Cb)({attribute:!1})],J.prototype,"entries",void 0),(0,a.__decorate)([(0,n.Cb)({attribute:!1})],J.prototype,"manifests",void 0),(0,a.__decorate)([(0,n.Cb)({attribute:!1})],J.prototype,"deviceId",void 0),(0,a.__decorate)([(0,n.Cb)({type:Boolean,reflect:!0})],J.prototype,"narrow",void 0),(0,a.__decorate)([(0,n.Cb)({attribute:"is-wide",type:Boolean})],J.prototype,"isWide",void 0),(0,a.__decorate)([(0,n.Cb)({attribute:!1})],J.prototype,"showAdvanced",void 0),(0,a.__decorate)([(0,n.SB)()],J.prototype,"_related",void 0),(0,a.__decorate)([(0,n.SB)()],J.prototype,"_diagnosticDownloadLinks",void 0),(0,a.__decorate)([(0,n.SB)()],J.prototype,"_deleteButtons",void 0),(0,a.__decorate)([(0,n.SB)()],J.prototype,"_deviceActions",void 0),(0,a.__decorate)([(0,n.SB)()],J.prototype,"_deviceAlerts",void 0),(0,a.__decorate)([(0,n.SB)(),(0,s.F_)({context:x.we,subscribe:!0})],J.prototype,"_entityReg",void 0),J=(0,a.__decorate)([(0,n.Mo)("ha-config-device-page")],J),t()}catch(e){t(e)}})},53415:function(e,t,i){i.a(e,async function(e,t){try{i(2394),i(81738),i(33480),i(94814),i(29981),i(22960),i(6989),i(72489),i(67886),i(65451),i(46015),i(38334),i(94880),i(75643),i(29761),i(36330),i(38221),i(75863);var a=i(73742),s=i(72644),o=i(59048),n=i(64346),r=i(26292),d=i(28105),l=i(34394),c=i(74266),h=i(9924),p=i(58125),u=i(43130),_=i(6219),g=i(29150),v=i(67050),b=i(64264),m=(i(11840),i(26979),i(12942),i(41037),i(93673),i(80471),i(57894),i(52036),i(61829)),y=(i(81299),i(83693),i(48017),i(57701),i(92952),i(85775),i(85993)),f=i(84075),$=i(97133),w=i(69992),x=i(28905),k=i(70947),C=i(27831),z=i(72242),L=(i(42497),i(6291)),A=i(95814),E=i(35580),S=i(2609),I=i(94590),M=(i(62597),i(65470)),B=i(54614),D=e([m,c]);[m,c]=D.then?(await D)():D;const H="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z",T="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",P="M7,10L12,15L17,10H7Z",O="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z",V="M20 2H4C2.9 2 2 2.9 2 4V20C2 21.11 2.9 22 4 22H20C21.11 22 22 21.11 22 20V4C22 2.9 21.11 2 20 2M4 6L6 4H10.9L4 10.9V6M4 13.7L13.7 4H18.6L4 18.6V13.7M20 18L18 20H13.1L20 13.1V18M20 10.3L10.3 20H5.4L20 5.4V10.3Z",j="M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C10.1 4 8.4 4.6 7.1 5.7L18.3 16.9C19.3 15.5 20 13.8 20 12C20 7.6 16.4 4 12 4M16.9 18.3L5.7 7.1C4.6 8.4 4 10.1 4 12C4 16.4 7.6 20 12 20C13.9 20 15.6 19.4 16.9 18.3Z";class N extends((0,L.f)(o.oi)){connectedCallback(){super.connectedCallback(),window.addEventListener("location-changed",this._locationChanged),window.addEventListener("popstate",this._popState)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("location-changed",this._locationChanged),window.removeEventListener("popstate",this._popState)}willUpdate(e){super.willUpdate(e),this.hasUpdated||this._setFiltersFromUrl()}_setFiltersFromUrl(){const e=this._searchParms.get("domain"),t=this._searchParms.get("config_entry"),i=this._searchParms.get("sub_entry"),a=this._searchParms.has("label");(e||t||a)&&(this._filter=history.state?.filter||"",this._filters={"ha-filter-states":{value:[...this._filters["ha-filter-states"]?.value||[],"disabled"],items:void 0},"ha-filter-integrations":{value:e?[e]:[],items:void 0},config_entry:{value:t?[t]:[],items:void 0},sub_entry:{value:i?[i]:[],items:void 0}},this._filterLabel())}_filterLabel(){const e=this._searchParms.get("label");e&&(this._filters={...this._filters,"ha-filter-labels":{value:[e],items:void 0}})}_clearFilter(){this._filters={}}hassSubscribe(){return[(0,C.f4)(this.hass.connection,e=>{this._labels=e})]}render(){const{devicesOutput:e}=this._devicesAndFilterDomains(this.hass.devices,this.entries,this.entities,this.hass.areas,this.manifests,this._filters,this.hass.localize,this._labels),t=this._sizeController.value&&this._sizeController.value<700||!this._sizeController.value&&"docked"===this.hass.dockedSidebar,i=o.dy`${Object.values(this.hass.areas).map(e=>o.dy`<ha-md-menu-item .value="${e.area_id}" .clickAction="${this._handleBulkArea}"> ${e.icon?o.dy`<ha-icon slot="start" .icon="${e.icon}"></ha-icon>`:o.dy`<ha-svg-icon slot="start" .path="${V}"></ha-svg-icon>`} <div slot="headline">${e.name}</div> </ha-md-menu-item>`)} <ha-md-menu-item .value="${null}" .clickAction="${this._handleBulkArea}"> <div slot="headline"> ${this.hass.localize("ui.panel.config.devices.picker.bulk_actions.no_area")} </div> </ha-md-menu-item> <ha-md-divider role="separator" tabindex="-1"></ha-md-divider> <ha-md-menu-item .clickAction="${this._bulkCreateArea}"> <div slot="headline"> ${this.hass.localize("ui.panel.config.devices.picker.bulk_actions.add_area")} </div> </ha-md-menu-item>`,a=o.dy`${this._labels?.map(e=>{const t=e.color?(0,l.I)(e.color):void 0,i=this._selected.every(t=>this.hass.devices[t]?.labels.includes(e.label_id)),a=!i&&this._selected.some(t=>this.hass.devices[t]?.labels.includes(e.label_id));return o.dy`<ha-md-menu-item .value="${e.label_id}" .action="${i?"remove":"add"}" @click="${this._handleBulkLabel}" keep-open> <ha-checkbox slot="start" .checked="${i}" .indeterminate="${a}" reducedTouchTarget></ha-checkbox> <ha-label style="${t?`--color: ${t}`:""}"> ${e.icon?o.dy`<ha-icon slot="icon" .icon="${e.icon}"></ha-icon>`:o.Ld} ${e.name} </ha-label> </ha-md-menu-item>`})} <ha-md-divider role="separator" tabindex="-1"></ha-md-divider> <ha-md-menu-item .clickAction="${this._bulkCreateLabel}"> <div slot="headline"> ${this.hass.localize("ui.panel.config.labels.add_label")} </div></ha-md-menu-item>`;return o.dy` <hass-tabs-subpage-data-table .hass="${this.hass}" .narrow="${this.narrow}" .backPath="${this._searchParms.has("historyBack")?void 0:"/config"}" .tabs="${I.configSections.devices}" .route="${this.route}" .searchLabel="${this.hass.localize("ui.panel.config.devices.picker.search",{number:e.length})}" .columns="${this._columns(this.hass.localize)}" .data="${e}" selectable .selected="${this._selected.length}" @selection-changed="${this._handleSelectionChanged}" .filter="${this._filter}" has-filters .filters="${Object.values(this._filters).filter(e=>Array.isArray(e.value)?e.value.length:e.value&&Object.values(e.value).some(e=>Array.isArray(e)?e.length:e)).length}" .initialGroupColumn="${this._activeGrouping}" .initialCollapsedGroups="${this._activeCollapsed}" .initialSorting="${this._activeSorting}" .columnOrder="${this._activeColumnOrder}" .hiddenColumns="${this._activeHiddenColumns}" @columns-changed="${this._handleColumnsChanged}" @clear-filter="${this._clearFilter}" @search-changed="${this._handleSearchChange}" @sorting-changed="${this._handleSortingChanged}" @grouping-changed="${this._handleGroupingChanged}" @collapsed-changed="${this._handleCollapseChanged}" @row-click="${this._handleRowClicked}" clickable has-fab class="${this.narrow?"narrow":""}"> <ha-integration-overflow-menu .hass="${this.hass}" slot="toolbar-icon"></ha-integration-overflow-menu> <ha-fab slot="fab" .label="${this.hass.localize("ui.panel.config.devices.add_device")}" extended @click="${this._addDevice}"> <ha-svg-icon slot="icon" .path="${O}"></ha-svg-icon> </ha-fab> ${Array.isArray(this._filters.config_entry?.value)&&this._filters.config_entry?.value.length?o.dy`<ha-alert slot="filter-pane"> ${this.hass.localize("ui.panel.config.devices.filtering_by_config_entry")} ${this.entries?.find(e=>e.entry_id===this._filters.config_entry.value[0])?.title||this._filters.config_entry.value[0]}${1===this._filters.config_entry.value.length&&Array.isArray(this._filters.sub_entry?.value)&&this._filters.sub_entry.value.length?o.dy` (${this._subEntries?.find(e=>e.subentry_id===this._filters.sub_entry.value[0])?.title||this._filters.sub_entry.value[0]})`:o.Ld} </ha-alert>`:o.Ld} <ha-filter-floor-areas .hass="${this.hass}" type="device" .value="${this._filters["ha-filter-floor-areas"]?.value}" @data-table-filter-changed="${this._filterChanged}" slot="filter-pane" .expanded="${"ha-filter-floor-areas"===this._expandedFilter}" .narrow="${this.narrow}" @expanded-changed="${this._filterExpanded}"></ha-filter-floor-areas> <ha-filter-integrations .hass="${this.hass}" .value="${this._filters["ha-filter-integrations"]?.value}" @data-table-filter-changed="${this._filterChanged}" slot="filter-pane" .expanded="${"ha-filter-integrations"===this._expandedFilter}" .narrow="${this.narrow}" @expanded-changed="${this._filterExpanded}"></ha-filter-integrations> <ha-filter-states .hass="${this.hass}" .value="${this._filters["ha-filter-states"]?.value}" .states="${this._states(this.hass.localize)}" .label="${this.hass.localize("ui.panel.config.devices.picker.state")}" @data-table-filter-changed="${this._filterChanged}" slot="filter-pane" .expanded="${"ha-filter-states"===this._expandedFilter}" .narrow="${this.narrow}" @expanded-changed="${this._filterExpanded}"></ha-filter-states> <ha-filter-labels .hass="${this.hass}" .value="${this._filters["ha-filter-labels"]?.value}" @data-table-filter-changed="${this._filterChanged}" slot="filter-pane" .expanded="${"ha-filter-labels"===this._expandedFilter}" .narrow="${this.narrow}" @expanded-changed="${this._filterExpanded}"></ha-filter-labels> ${this.narrow?o.Ld:o.dy`<ha-md-button-menu slot="selection-bar"> <ha-assist-chip slot="trigger" .label="${this.hass.localize("ui.panel.config.automation.picker.bulk_actions.add_label")}"> <ha-svg-icon slot="trailing-icon" .path="${P}"></ha-svg-icon> </ha-assist-chip> ${a} </ha-md-button-menu> ${t?o.Ld:o.dy`<ha-md-button-menu slot="selection-bar"> <ha-assist-chip slot="trigger" .label="${this.hass.localize("ui.panel.config.devices.picker.bulk_actions.move_area")}"> <ha-svg-icon slot="trailing-icon" .path="${P}"></ha-svg-icon> </ha-assist-chip> ${i} </ha-md-button-menu>`}`} ${this.narrow||t?o.dy`<ha-md-button-menu has-overflow slot="selection-bar"> ${this.narrow?o.dy`<ha-assist-chip .label="${this.hass.localize("ui.panel.config.automation.picker.bulk_action")}" slot="trigger"> <ha-svg-icon slot="trailing-icon" .path="${P}"></ha-svg-icon> </ha-assist-chip>`:o.dy`<ha-icon-button .path="${T}" .label="${this.hass.localize("ui.panel.config.automation.picker.bulk_action")}" slot="trigger"></ha-icon-button>`} ${this.narrow?o.dy` <ha-sub-menu> <ha-md-menu-item slot="item"> <div slot="headline"> ${this.hass.localize("ui.panel.config.automation.picker.bulk_actions.add_label")} </div> <ha-svg-icon slot="end" .path="${H}"></ha-svg-icon> </ha-md-menu-item> <ha-md-menu slot="menu">${a}</ha-md-menu> </ha-sub-menu>`:o.Ld} <ha-sub-menu> <ha-md-menu-item slot="item"> <div slot="headline"> ${this.hass.localize("ui.panel.config.devices.picker.bulk_actions.move_area")} </div> <ha-svg-icon slot="end" .path="${H}"></ha-svg-icon> </ha-md-menu-item> <ha-md-menu slot="menu">${i}</ha-md-menu> </ha-sub-menu> </ha-md-button-menu>`:o.Ld} </hass-tabs-subpage-data-table> `}async _loadSubEntries(e){this._subEntries=await(0,f.$H)(this.hass,e)}_filterExpanded(e){e.detail.expanded?this._expandedFilter=e.target.localName:this._expandedFilter===e.target.localName&&(this._expandedFilter=void 0)}_filterChanged(e){const t=e.target.localName;this._filters={...this._filters,[t]:e.detail}}_batteryEntity(e,t){const i=(0,k.eD)(this.hass,t[e]||[]);return i?i.entity_id:void 0}_batteryChargingEntity(e,t){const i=(0,k.wX)(this.hass,t[e]||[]);return i?i.entity_id:void 0}_handleRowClicked(e){const t=e.detail.id;this._ignoreLocationChange=!0,(0,v.c)(`/config/devices/device/${t}`)}_handleSearchChange(e){this._filter=e.detail.value,history.replaceState({filter:this._filter},"")}_addDevice(){const{filteredConfigEntry:e,filteredDomains:t}=this._devicesAndFilterDomains(this.hass.devices,this.entries,this.entities,this.hass.areas,this.manifests,this._filters,this.hass.localize,this._labels);1===t.size&&g.S.includes([...t][0])?(0,g.D)(this,this.hass,[...t][0],{config_entry:e?.entry_id}):(0,M.E)(this,{domain:this._searchParms.get("domain")||void 0})}_handleSelectionChanged(e){this._selected=e.detail.value}async _bulkAddArea(e){const t=[];this._selected.forEach(i=>{t.push((0,x.t1)(this.hass,i,{area_id:e}))});const i=await Promise.allSettled(t);if((0,b.M)(i)){const e=(0,b.a)(i);(0,z.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.common.multiselect.failed",{number:e.length}),text:o.dy`<pre>
${e.map(e=>e.reason.message||e.reason.code||e.reason).join("\r\n")}</pre>`})}}async _handleBulkLabel(e){const t=e.currentTarget.value,i=e.currentTarget.action;this._bulkLabel(t,i)}async _bulkLabel(e,t){const i=[];this._selected.forEach(a=>{i.push((0,x.t1)(this.hass,a,{labels:"add"===t?this.hass.devices[a].labels.concat(e):this.hass.devices[a].labels.filter(t=>t!==e)}))});const a=await Promise.allSettled(i);if((0,b.M)(a)){const e=(0,b.a)(a);(0,z.showAlertDialog)(this,{title:this.hass.localize("ui.panel.config.common.multiselect.failed",{number:e.length}),text:o.dy`<pre>
${e.map(e=>e.reason.message||e.reason.code||e.reason).join("\r\n")}</pre>`})}}_handleSortingChanged(e){this._activeSorting=e.detail}_handleGroupingChanged(e){this._activeGrouping=e.detail.value}_handleCollapseChanged(e){this._activeCollapsed=e.detail.value}_handleColumnsChanged(e){this._activeColumnOrder=e.detail.columnOrder,this._activeHiddenColumns=e.detail.hiddenColumns}static get styles(){return[o.iv`:host{display:block}hass-tabs-subpage-data-table{--data-table-row-height:60px}hass-tabs-subpage-data-table.narrow{--data-table-row-height:72px}ha-button-menu{margin-left:8px;margin-inline-start:8px;margin-inline-end:initial}.clear{color:var(--primary-color);padding-left:8px;padding-inline-start:8px;text-transform:uppercase;direction:var(--direction)}ha-assist-chip{--ha-assist-chip-container-shape:10px}ha-md-button-menu ha-assist-chip{--md-assist-chip-trailing-space:8px}ha-label{--ha-label-background-color:var(--color, var(--grey-color));--ha-label-background-opacity:0.5}`,A.Qx]}constructor(...e){super(...e),this.narrow=!1,this.isWide=!1,this._searchParms=new URLSearchParams(window.location.search),this._selected=[],this._filter=history.state?.filter||"",this._filters={},this._sizeController=new n.Z(this,{callback:e=>e[0]?.contentRect.width}),this._ignoreLocationChange=!1,this._locationChanged=()=>{this._ignoreLocationChange?this._ignoreLocationChange=!1:window.location.search.substring(1)!==this._searchParms.toString()&&(this._searchParms=new URLSearchParams(window.location.search),this._setFiltersFromUrl())},this._popState=()=>{window.location.search.substring(1)!==this._searchParms.toString()&&(this._searchParms=new URLSearchParams(window.location.search),this._setFiltersFromUrl())},this._states=(0,d.Z)(e=>[{value:"disabled",label:e("ui.panel.config.devices.data_table.disabled_by")}]),this._devicesAndFilterDomains=(0,d.Z)((e,t,i,a,s,o,n,r)=>{let d=Object.values(e).map(e=>({...e,label_entries:[]}));const l={};for(const e of i)e.device_id&&(e.device_id in l||(l[e.device_id]=[]),l[e.device_id].push(e));const c={};for(const e of t)c[e.entry_id]=e;const h={};for(const e of s)h[e.domain]=e;let _;const g=new Set;Object.entries(o).forEach(([e,i])=>{if("config_entry"===e&&Array.isArray(i.value)&&i.value.length){d=d.filter(e=>e.config_entries.some(e=>i.value.includes(e)));const e=t.filter(e=>e.entry_id&&i.value.includes(e.entry_id));e.forEach(e=>{g.add(e.domain)}),1===e.length&&(_=e[0])}else if("sub_entry"===e&&Array.isArray(i.value)&&i.value.length){if(!Array.isArray(this._filters.config_entry?.value)||1!==this._filters.config_entry.value.length)return;const e=this._filters.config_entry.value[0];d=d.filter(t=>t.config_entries_subentries[e]&&i.value.some(i=>t.config_entries_subentries[e].includes(i))),this._subEntries||this._loadSubEntries(e)}else if("ha-filter-integrations"===e&&Array.isArray(i.value)&&i.value.length){const e=t.filter(e=>i.value.includes(e.domain)).map(e=>e.entry_id);d=d.filter(t=>t.config_entries.some(t=>e.includes(t))),i.value.forEach(e=>g.add(e))}else"ha-filter-labels"===e&&Array.isArray(i.value)&&i.value.length?d=d.filter(e=>e.labels.some(e=>i.value.includes(e))):i.items&&(d=d.filter(e=>i.items.has(e.id)))});const v=o["ha-filter-states"]?.value;v?.length&&v.includes("disabled")||(d=d.filter(e=>!e.disabled_by));return{devicesOutput:d.map(e=>{const t=(0,f.Pk)(e.config_entries.filter(e=>e in c).map(e=>c[e]),e.primary_config_entry),i=(r&&e?.labels||[]).map(e=>r.find(t=>t.label_id===e));let s="";if(e.area_id&&a[e.area_id]?.floor_id&&this.hass.floors){const t=a[e.area_id].floor_id;this.hass.floors[t]&&(s=(0,u.r)(this.hass.floors[t]))}return{...e,name:(0,p.wZ)(e,this.hass,l[e.id]),model:e.model||`<${n("ui.panel.config.devices.data_table.unknown")}>`,manufacturer:e.manufacturer||`<${n("ui.panel.config.devices.data_table.unknown")}>`,area:e.area_id&&a[e.area_id]?a[e.area_id].name:"",floor:s,integration:t.length?t.map(e=>n(`component.${e.domain}.title`)||e.domain).join(", "):this.hass.localize("ui.panel.config.devices.data_table.no_integration"),domains:t.map(e=>e.domain),battery_entity:[this._batteryEntity(e.id,l),this._batteryChargingEntity(e.id,l)],battery_level:this.hass.states[this._batteryEntity(e.id,l)||""]?.state,label_entries:i}}),filteredConfigEntry:_,filteredDomains:g}}),this._columns=(0,d.Z)(e=>({icon:{title:"",label:e("ui.panel.config.devices.data_table.icon"),type:"icon",moveable:!1,showNarrow:!0,template:e=>e.domains.length?o.dy`<img alt="" crossorigin="anonymous" referrerpolicy="no-referrer" src="${(0,E.X1)({domain:e.domains[0],type:"icon",darkOptimized:this.hass.themes?.darkMode})}">`:""},name:{title:e("ui.panel.config.devices.data_table.device"),main:!0,sortable:!0,filterable:!0,direction:"asc",grows:!0,flex:2,minWidth:"150px",extraTemplate:e=>o.dy` ${e.label_entries.length?o.dy` <ha-data-table-labels .labels="${e.label_entries}"></ha-data-table-labels> `:o.Ld} `},area:{title:e("ui.panel.config.devices.data_table.area"),sortable:!0,filterable:!0,groupable:!0,minWidth:"120px"},floor:{title:e("ui.panel.config.devices.data_table.floor"),sortable:!0,filterable:!0,groupable:!0,minWidth:"120px",defaultHidden:!0},integration:{title:e("ui.panel.config.devices.data_table.integration"),sortable:!0,filterable:!0,groupable:!0,minWidth:"120px"},manufacturer:{title:e("ui.panel.config.devices.data_table.manufacturer"),sortable:!0,filterable:!0,groupable:!0,minWidth:"120px"},model:{title:e("ui.panel.config.devices.data_table.model"),sortable:!0,filterable:!0,minWidth:"120px"},battery_entity:{title:e("ui.panel.config.devices.data_table.battery"),showNarrow:!0,sortable:!0,type:"numeric",maxWidth:"101px",minWidth:"101px",valueColumn:"battery_level",template:e=>{const t=e.battery_entity,i=t&&t[0]?this.hass.states[t[0]]:void 0,a=i?(0,_.N)(i):void 0,s=t&&t[1]?this.hass.states[t[1]]:void 0;return!i||"binary_sensor"!==a&&isNaN(i.state)?"":o.dy` ${"sensor"===a?this.hass.formatEntityState(i):o.Ld} <ha-battery-icon .hass="${this.hass}" .batteryStateObj="${i}" .batteryChargingStateObj="${s}"></ha-battery-icon> `}},created_at:{title:e("ui.panel.config.generic.headers.created_at"),defaultHidden:!0,sortable:!0,minWidth:"128px",template:e=>e.created_at?(0,c.yD)(new Date(1e3*e.created_at),this.hass.locale,this.hass.config):""},modified_at:{title:e("ui.panel.config.generic.headers.modified_at"),defaultHidden:!0,sortable:!0,minWidth:"128px",template:e=>e.modified_at?(0,c.yD)(new Date(1e3*e.modified_at),this.hass.locale,this.hass.config):""},disabled_by:{title:e("ui.panel.config.devices.picker.state"),type:"icon",defaultHidden:!0,sortable:!0,filterable:!0,minWidth:"80px",maxWidth:"80px",template:e=>e.disabled_by?o.dy` <div tabindex="0" style="display:inline-block;position:relative"> <ha-tooltip placement="left" .content="${this.hass.localize("ui.panel.config.entities.picker.status.disabled")}"> <ha-svg-icon .path="${j}"></ha-svg-icon> </ha-tooltip> </div> `:""},labels:{title:"",hidden:!0,filterable:!0,template:e=>e.label_entries.map(e=>e.name).join(" ")}})),this._handleBulkArea=e=>{const t=e.value;this._bulkAddArea(t)},this._bulkCreateArea=()=>{(0,S.E)(this,{createEntry:async e=>{const t=await(0,y.Lo)(this.hass,e);return this._bulkAddArea(t.area_id),t}})},this._bulkCreateLabel=()=>{(0,B.T)(this,{createEntry:async e=>{const t=await(0,C.jo)(this.hass,e);this._bulkLabel(t.label_id,"add")}})}}}(0,a.__decorate)([(0,r.Cb)({attribute:!1})],N.prototype,"hass",void 0),(0,a.__decorate)([(0,r.Cb)({type:Boolean})],N.prototype,"narrow",void 0),(0,a.__decorate)([(0,r.Cb)({attribute:"is-wide",type:Boolean})],N.prototype,"isWide",void 0),(0,a.__decorate)([(0,r.Cb)({attribute:!1})],N.prototype,"entries",void 0),(0,a.__decorate)([(0,r.SB)()],N.prototype,"_subEntries",void 0),(0,a.__decorate)([(0,r.SB)(),(0,s.F_)({context:$.we,subscribe:!0})],N.prototype,"entities",void 0),(0,a.__decorate)([(0,r.Cb)({attribute:!1})],N.prototype,"manifests",void 0),(0,a.__decorate)([(0,r.Cb)({attribute:!1})],N.prototype,"route",void 0),(0,a.__decorate)([(0,r.SB)()],N.prototype,"_searchParms",void 0),(0,a.__decorate)([(0,r.SB)()],N.prototype,"_selected",void 0),(0,a.__decorate)([(0,r.SB)(),(0,h.t)({storage:"sessionStorage",key:"devices-table-search",state:!0,subscribe:!1})],N.prototype,"_filter",void 0),(0,a.__decorate)([(0,r.SB)(),(0,h.t)({storage:"sessionStorage",key:"devices-table-filters-full",state:!0,subscribe:!1,serializer:w.B,deserializer:w.l})],N.prototype,"_filters",void 0),(0,a.__decorate)([(0,r.SB)()],N.prototype,"_expandedFilter",void 0),(0,a.__decorate)([(0,r.SB)()],N.prototype,"_labels",void 0),(0,a.__decorate)([(0,h.t)({key:"devices-table-sort",state:!1,subscribe:!1})],N.prototype,"_activeSorting",void 0),(0,a.__decorate)([(0,h.t)({key:"devices-table-grouping",state:!1,subscribe:!1})],N.prototype,"_activeGrouping",void 0),(0,a.__decorate)([(0,h.t)({key:"devices-table-collapsed",state:!1,subscribe:!1})],N.prototype,"_activeCollapsed",void 0),(0,a.__decorate)([(0,h.t)({key:"devices-table-column-order",state:!1,subscribe:!1})],N.prototype,"_activeColumnOrder",void 0),(0,a.__decorate)([(0,h.t)({key:"devices-table-hidden-columns",state:!1,subscribe:!1})],N.prototype,"_activeHiddenColumns",void 0),N=(0,a.__decorate)([(0,r.Mo)("ha-config-devices-dashboard")],N),t()}catch(e){t(e)}})},99830:function(e,t,i){i.a(e,async function(e,a){try{i.r(t);var s=i(73742),o=i(26292),n=i(84075),r=i(96222),d=i(407),l=i(66781),c=i(53415),h=e([l,c]);[l,c]=h.then?(await h)():h;class p extends d.n{firstUpdated(e){super.firstUpdated(e),this._loadData()}updatePageEl(e){e.hass=this.hass,"device"===this._currentPage&&(e.deviceId=this.routeTail.path.substr(1)),e.entries=this._configEntries,e.manifests=this._manifests,e.narrow=this.narrow,e.isWide=this.isWide,e.showAdvanced=this.showAdvanced,e.route=this.routeTail}async _loadData(){this._configEntries=await(0,n.pB)(this.hass),this._manifests=await(0,r.F3)(this.hass)}constructor(...e){super(...e),this.narrow=!1,this.isWide=!1,this.showAdvanced=!1,this.routerOptions={defaultPage:"dashboard",routes:{dashboard:{tag:"ha-config-devices-dashboard",cache:!0},device:{tag:"ha-config-device-page"}}},this._configEntries=[],this._manifests=[]}}(0,s.__decorate)([(0,o.Cb)({attribute:!1})],p.prototype,"hass",void 0),(0,s.__decorate)([(0,o.Cb)({type:Boolean})],p.prototype,"narrow",void 0),(0,s.__decorate)([(0,o.Cb)({attribute:"is-wide",type:Boolean})],p.prototype,"isWide",void 0),(0,s.__decorate)([(0,o.Cb)({attribute:!1})],p.prototype,"showAdvanced",void 0),(0,s.__decorate)([(0,o.SB)()],p.prototype,"_configEntries",void 0),(0,s.__decorate)([(0,o.SB)()],p.prototype,"_manifests",void 0),p=(0,s.__decorate)([(0,o.Mo)("ha-config-devices")],p),a()}catch(e){a(e)}})},25624:function(e,t,i){i.a(e,async function(e,t){try{i(2394),i(81738),i(94814),i(22960),i(72489);var a=i(73742),s=i(59048),o=i(26292),n=i(37528),r=i(6219),d=i(40645),l=i(6514),c=i(43563),h=i(59715),p=i(99918),u=i(63583),_=e([l,u]);[l,u]=_.then?(await _)():_;const g=(e,t)=>new Date(e.getTime()-1e3*t).getTime()/1e3,v=(e,t)=>(void 0!==e||void 0!==t)&&(!e||!t||e.length!==t.length||e.some(e=>!t.includes(e))||t.some(t=>!e.includes(t)));class b extends s.oi{render(){return(0,n.p)(this.hass,"logbook")?this._error?s.dy`<div class="no-entries"> ${`${this.hass.localize("ui.components.logbook.retrieval_error")}: ${this._error}`} </div>`:void 0===this._logbookEntries?s.dy` <div class="progress-wrapper"> <ha-spinner></ha-spinner> </div> `:0===this._logbookEntries.length?s.dy`<div class="no-entries"> ${this.hass.localize("ui.components.logbook.entries_not_found")} </div>`:s.dy` <ha-logbook-renderer .hass="${this.hass}" .narrow="${this.narrow}" .virtualize="${this.virtualize}" .noIcon="${this.noIcon}" .noName="${this.noName}" .showIndicator="${this.showIndicator}" .relativeTime="${this.relativeTime}" .entries="${this._logbookEntries}" .traceContexts="${this._traceContexts}" .userIdToName="${this._userIdToName}" @hass-logbook-live="${this._handleLogbookLive}"></ha-logbook-renderer> `:s.Ld}async refresh(e=!1){(e||!this._unsubLogbook&&void 0!==this._logbookEntries)&&(this._throttleGetLogbookEntries.cancel(),this._updateTraceContexts.cancel(),this._updateUsers.cancel(),this._unsubscribe(!0),this._liveUpdatesEnabled=!0,e?this._getLogBookData():this._throttleGetLogbookEntries())}shouldUpdate(e){if(1!==e.size||!e.has("hass"))return!0;const t=e.get("hass");return!t||t.localize!==this.hass.localize}willUpdate(e){let t=e.has("time");for(const i of["entityIds","deviceIds"]){if(!e.has(i))continue;const a=e.get(i),s=this[i];if(v(a,s)){t=!0;break}}t&&this.refresh(!0)}_handleLogbookLive(e){e.detail.enable&&!this._liveUpdatesEnabled&&(this._pendingStreamMessages.forEach(e=>this._processStreamMessage(e)),this._pendingStreamMessages=[]),this._liveUpdatesEnabled=e.detail.enable}get _filterAlwaysEmptyResults(){const e=this.entityIds,t=this.deviceIds;return Boolean(e||t)&&(!e||0===e.length)&&(!t||0===t.length)}_unsubscribe(e){this._unsubLogbook&&(this._unsubLogbook.then(e=>e()),this._unsubLogbook=void 0,this._logbookEntries=e?void 0:[],this._pendingStreamMessages=[])}connectedCallback(){super.connectedCallback(),this.hasUpdated&&this._subscribeLogbookPeriod(this._calculateLogbookPeriod())}disconnectedCallback(){super.disconnectedCallback(),this._unsubscribe(!0)}_calculateLogbookPeriod(){const e=new Date;if("range"in this.time)return{now:e,startTime:this.time.range[0],endTime:this.time.range[1],purgeBeforePythonTime:void 0};if("recent"in this.time){const t=g(e,this.time.recent);return{now:e,startTime:new Date(1e3*t),endTime:new Date(e.getTime()+31536e6),purgeBeforePythonTime:g(e,this.time.recent)}}throw new Error("Unexpected time specified")}async _subscribeLogbookPeriod(e){if(!this._unsubLogbook)try{this._logbookSubscriptionId++,this._unsubLogbook=(0,c.Yc)(this.hass,(e,t)=>{t===this._logbookSubscriptionId&&this._processOrQueueStreamMessage(e)},e.startTime.toISOString(),e.endTime.toISOString(),this._logbookSubscriptionId,this.entityIds,this.deviceIds),await this._unsubLogbook}catch(e){this._unsubLogbook=void 0,this._error=e}}async _getLogBookData(){if(this._error=void 0,this._filterAlwaysEmptyResults)return void this._unsubscribe(!1);const e=this._calculateLogbookPeriod();e.startTime>e.now?this._unsubscribe(!1):(this._updateUsers(),this.hass.user?.is_admin&&this._updateTraceContexts(),this._subscribeLogbookPeriod(e))}static get styles(){return[s.iv`:host{display:block}:host([virtualize]){height:100%}.no-entries{text-align:center;padding:16px;color:var(--secondary-text-color)}.progress-wrapper{display:flex;justify-content:center;height:100%;align-items:center}`]}constructor(...e){super(...e),this.narrow=!1,this.virtualize=!1,this.noIcon=!1,this.noName=!1,this.showIndicator=!1,this.relativeTime=!1,this.showMoreLink=!0,this._traceContexts={},this._userIdToName={},this._liveUpdatesEnabled=!0,this._pendingStreamMessages=[],this._throttleGetLogbookEntries=(0,d.P)(()=>this._getLogBookData(),1e3),this._logbookSubscriptionId=0,this._nonExpiredRecords=e=>this._logbookEntries?e?this._logbookEntries.filter(t=>t.when>e):this._logbookEntries:[],this._processOrQueueStreamMessage=e=>{this._liveUpdatesEnabled?this._processStreamMessage(e):this._pendingStreamMessages.push(e)},this._processStreamMessage=e=>{const t="recent"in this.time?g(new Date,this.time.recent):void 0,i=[...e.events].reverse();if(!this._logbookEntries||!this._logbookEntries.length)return void(this._logbookEntries=i);if(!i.length)return;const a=this._nonExpiredRecords(t);a.length?i[i.length-1].when>a[0].when?this._logbookEntries=i.concat(a):a[a.length-1].when>i[0].when?this._logbookEntries=a.concat(i):this._logbookEntries=a.concat(i).sort((e,t)=>t.when-e.when):this._logbookEntries=i},this._updateTraceContexts=(0,d.P)(async()=>{this._traceContexts=await(0,h.U_)(this.hass)},6e4),this._updateUsers=(0,d.P)(async()=>{const e={},t=this.hass.user?.is_admin&&(0,p.uh)(this.hass);for(const t of Object.values(this.hass.states))t.attributes.user_id&&"person"===(0,r.N)(t)&&(e[t.attributes.user_id]=t.attributes.friendly_name);if(t){const i=await t;for(const t of i)t.id in e||(e[t.id]=t.name)}this._userIdToName=e},6e4)}}(0,a.__decorate)([(0,o.Cb)({attribute:!1})],b.prototype,"hass",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],b.prototype,"time",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],b.prototype,"entityIds",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:!1})],b.prototype,"deviceIds",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean})],b.prototype,"narrow",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean,reflect:!0})],b.prototype,"virtualize",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean,attribute:"no-icon"})],b.prototype,"noIcon",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean,attribute:"no-name"})],b.prototype,"noName",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean,attribute:"show-indicator"})],b.prototype,"showIndicator",void 0),(0,a.__decorate)([(0,o.Cb)({type:Boolean,attribute:"relative-time"})],b.prototype,"relativeTime",void 0),(0,a.__decorate)([(0,o.Cb)({attribute:"show-more-link",type:Boolean})],b.prototype,"showMoreLink",void 0),(0,a.__decorate)([(0,o.SB)()],b.prototype,"_logbookEntries",void 0),(0,a.__decorate)([(0,o.SB)()],b.prototype,"_traceContexts",void 0),(0,a.__decorate)([(0,o.SB)()],b.prototype,"_userIdToName",void 0),(0,a.__decorate)([(0,o.SB)()],b.prototype,"_error",void 0),b=(0,a.__decorate)([(0,o.Mo)("ha-logbook")],b),t()}catch(e){t(e)}})},73804:function(e,t,i){i.d(t,{lY:()=>g,AP:()=>m,oU:()=>b,VG:()=>v});i(2394),i(81738),i(94814),i(29981),i(22960),i(6989),i(67886),i(65451),i(46015),i(38334),i(94880),i(75643),i(29761);var a=i(40141),s=i(44272),o=i(6219),n=i(15459);var r=i(55107),d=i(36221),l=i(85993),c=i(96222),h=i(99918),p=i(19331);const u=new Set(["ai_task","automation","configurator","device_tracker","event","geo_location","notify","persistent_notification","script","sun","tag","todo","zone",...a.a5]),_=new Set(["backup","mobile_app"]),g=(e,t)=>({type:"grid",cards:e.map(e=>({type:"tile",entity:e,show_entity_picture:["camera","image","person"].includes((0,s.M)(e))||void 0})),...t}),v=(e,t,i,o=!0)=>{const l=[],c=[],h=i.title?i.title.toLowerCase():void 0,p=[];for(const i of t){const t=e[i],a=(0,s.M)(i);if("alarm_control_panel"===a){const e={type:"alarm-panel",entity:i};l.push(e)}else if("camera"===a){const e={type:"picture-entity",entity:i};l.push(e)}else if("image"===a){const e={type:"picture",image_entity:i};l.push(e)}else if("climate"===a){const t={type:"thermostat",entity:i,features:(e[i]?.attributes?.hvac_modes?.length??0)>1?[{type:"climate-hvac-modes",hvac_modes:e[i]?.attributes?.hvac_modes}]:void 0};l.push(t)}else if("humidifier"===a){const e={type:"humidifier",entity:i,features:[{type:"humidifier-toggle"}]};l.push(e)}else if("media_player"===a){const e={type:"media-control",entity:i};l.push(e)}else if("plant"===a){const e={type:"plant-status",entity:i};l.push(e)}else if("weather"===a){const e={type:"weather-forecast",entity:i,show_forecast:!1};l.push(e)}else if(!o||"scene"!==a&&"script"!==a){let e;const a=h&&t&&(e=(0,r.N)((0,n.C)(t),h))?{entity:i,name:e}:i;c.push(a)}else{const e={entity:i,show_icon:!0,show_name:!0};let a;h&&t&&(a=(0,r.N)((0,n.C)(t),h))&&(e.name=a),p.push(e)}}if(c.sort((t,i)=>{const o="string"==typeof t?t:t.entity,r="string"==typeof i?i:i.entity,l=a.zF.includes((0,s.M)(o))?"sensor":"control";return l!==(a.zF.includes((0,s.M)(r))?"sensor":"control")?"sensor"===l?1:-1:(0,d.$K)("string"==typeof t?e[t]?(0,n.C)(e[t]):"":t.name||"","string"==typeof i?e[i]?(0,n.C)(e[i]):"":i.name||"")}),0===c.length&&p.length>0)return v(e,t,i,!1);if(c.length>0||p.length>0){const e={type:"entities",entities:c,...i};p.length>0&&(e.footer={type:"buttons",entities:p}),l.unshift(e)}return l.length<2?l:[{type:"grid",square:!1,columns:1,cards:l}]},b=(e,t)=>{const i=[];for(const e of t){const t={type:"entity",entity:e};i.push(t)}return i},m=(e,t,i,a,r,g,b,m,y)=>{const f=((e,t)=>{const i={},a=new Set(Object.values(t).filter(e=>e.entity_category||e.platform&&_.has(e.platform)||e.hidden).map(e=>e.entity_id));for(const t of Object.keys(e)){const s=e[t];u.has((0,o.N)(s))||a.has(s.entity_id)||(i[t]=e[t])}return i})(a,i),$={};for(const e of Object.keys(f)){const t=f[e];t.attributes.order&&($[e]=t.attributes.order)}const w=((e,t,i,a)=>{const s={...a},o={},n={};for(const a of Object.values(i)){const i=a.area_id||a.device_id&&t[a.device_id]?.area_id;i&&i in e&&a.entity_id in s?(i in o||(o[i]=[]),o[i].push(s[a.entity_id]),delete s[a.entity_id]):a.device_id&&a.device_id in t&&a.entity_id in s&&(a.device_id in n||(n[a.device_id]=[]),n[a.device_id].push(s[a.entity_id]),delete s[a.entity_id])}for(const[e,t]of Object.entries(n))1===t.length&&(s[t[0].entity_id]=t[0],delete n[e]);return{areasWithEntities:o,devicesWithEntities:n,otherEntities:s}})(e,t,i,f);if(b?.hidden)for(const e of b.hidden)delete w.areasWithEntities[e];m&&(w.devicesWithEntities={},w.otherEntities={});const x=(e=>{const t=[],i={};return Object.keys(e).forEach(a=>{const o=e[a];"group"===(0,s.M)(a)?t.push(o):i[a]=o}),t.forEach(e=>e.attributes.entity_id.forEach(e=>{delete i[e]})),{groups:t,ungrouped:i}})(w.otherEntities);x.groups.sort((e,t)=>$[e.entity_id]-$[t.entity_id]);const k=[];for(const e of x.groups)k.push(...v(a,e.attributes.entity_id,{title:(0,n.C)(e),show_header_toggle:"hidden"!==e.attributes.control}));const C=((e,t,i,a,s)=>{const r={};for(const e of Object.keys(s)){const t=s[e],i=(0,o.N)(t);i in r||(r[i]=[]),r[i].push(t.entity_id)}const l=[];if("person"in r){const e=[];if(1===r.person.length)l.push({type:"entities",entities:r.person});else{let t,i="";for(const a of r.person){const o=s[a];let n=o.attributes.entity_picture;if(!n){if(void 0===t){const e=getComputedStyle(document.body);t=encodeURIComponent(e.getPropertyValue("--light-primary-color").trim()),i=encodeURIComponent((e.getPropertyValue("--text-light-primary-color")||e.getPropertyValue("--primary-text-color")).trim())}n=`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50' width='50' height='50' style='background-color:${t}'%3E%3Cg%3E%3Ctext font-family='roboto' x='50%25' y='50%25' text-anchor='middle' stroke='${i}' font-size='1.3em' dy='.3em'%3E${(0,h.fm)(o.attributes.friendly_name||"")}%3C/text%3E%3C/g%3E%3C/svg%3E`}e.push({type:"picture-entity",entity:a,aspect_ratio:"1",show_name:!1,image:n})}l.push({type:"grid",square:!0,columns:3,cards:e})}delete r.person}const u=[];for(const e of p.y)e in r&&(u.push(...r[e]),delete r[e]);const _={};for(const t of Object.keys(r))_[t]=(0,c.Lh)(e,t);u.length&&(r._helpers=u,_._helpers=e("ui.panel.lovelace.strategy.original-states.helpers")),Object.keys(r).sort((e,t)=>(0,d.$K)(_[e],_[t])).forEach(e=>{l.push(...v(s,r[e].sort((e,t)=>(0,d.$K)((0,n.C)(s[e]),(0,n.C)(s[t]))),{title:_[e]}))});const g={path:t,title:i,cards:l};return a&&(g.icon=a),g})(r,"default_view","Home",undefined,x.ungrouped),z=[],L=Object.keys(w.areasWithEntities).sort((0,l.a)(e,b?.order));for(const t of L){const i=w.areasWithEntities[t],s=e[t];z.push(...v(a,i.map(e=>e.entity_id),{title:s.name}))}const A=[],E=Object.entries(w.devicesWithEntities).sort((e,i)=>{const a=t[e[0]],s=t[i[0]];return(0,d.$K)(a.name_by_user||a.name||"",s.name_by_user||s.name||"")});for(const[e,i]of E){const s=t[e];A.push(...v(a,i.map(e=>e.entity_id),{title:s.name_by_user||s.name||r("ui.panel.config.devices.unnamed_device",{type:r(`ui.panel.config.devices.type.${s.entry_type||"device"}`)})}))}let S;if(g&&!y){const e=g.energy_sources.find(e=>"grid"===e.type);e&&e.flow_from.length>0&&(S={title:r("ui.panel.lovelace.cards.energy.energy_distribution.title_today"),type:"energy-distribution",link_dashboard:!0})}return C.cards.unshift(...z,...k,...S?[S]:[]),C.cards.push(...A),C}},5915:function(e,t,i){i.d(t,{$:()=>d});i(81738),i(94814);var a=i(25151),s=i(70695),o=i(72242),n=i(46987),r=i(89125);const d=async(e,t,i,d,l)=>{t.loadFragmentTranslation("lovelace");const c=await(0,s.j2)(t),h=c.filter(e=>"storage"===e.mode),p=t.panels.lovelace?.config?.mode;if("storage"!==p&&!h.length)return void(0,n.f)(e,{cardConfig:i,entities:l,yaml:!0});let u,_=null;if("storage"===p)try{u=await(0,a.Q2)(t.connection,null,!1)}catch(e){}if(!u&&h.length)for(const e of h)try{u=await(0,a.Q2)(t.connection,e.url_path,!1),_=e.url_path;break}catch(e){}u?h.length||u.views?.length?h.length||1!==u.views.length?(0,r.i)(e,{lovelaceConfig:u,urlPath:_,allowDashboardChange:!0,actionLabel:t.localize("ui.common.next"),dashboards:c,viewSelectedCallback:(s,o,r)=>{(0,n.f)(e,{cardConfig:i,sectionConfig:d,lovelaceConfig:o,saveConfig:async e=>{try{await(0,a.Oh)(t,s,e)}catch{alert(t.localize("ui.panel.lovelace.add_entities.saving_failed"))}},path:[r],entities:l})}}):(0,n.f)(e,{cardConfig:i,sectionConfig:d,lovelaceConfig:u,saveConfig:async e=>{try{await(0,a.Oh)(t,null,e)}catch(e){alert(t.localize("ui.panel.lovelace.add_entities.saving_failed"))}},path:[0],entities:l}):(0,o.showAlertDialog)(e,{text:"You don't have any Lovelace views, first create a view in Lovelace."}):c.length>h.length?(0,n.f)(e,{cardConfig:i,sectionConfig:d,entities:l,yaml:!0}):(0,o.showAlertDialog)(e,{text:"You don't seem to be in control of any dashboard, please take control first."})}},46987:function(e,t,i){i.d(t,{f:()=>o});var a=i(39884);const s=()=>Promise.all([i.e("7850"),i.e("63873"),i.e("55540"),i.e("15139"),i.e("36636"),i.e("21351"),i.e("57530"),i.e("13113"),i.e("49910"),i.e("98023"),i.e("68858"),i.e("67051"),i.e("87267"),i.e("27195"),i.e("61617"),i.e("26112"),i.e("70970"),i.e("67606"),i.e("9158"),i.e("34213"),i.e("27646"),i.e("1502"),i.e("41295")]).then(i.bind(i,85734)),o=(e,t)=>{(0,a.B)(e,"show-dialog",{dialogTag:"hui-dialog-suggest-card",dialogImport:s,dialogParams:t})}},89125:function(e,t,i){i.d(t,{i:()=>s});var a=i(39884);const s=(e,t)=>{(0,a.B)(e,"show-dialog",{dialogTag:"hui-dialog-select-view",dialogImport:()=>Promise.all([i.e("75696"),i.e("86689"),i.e("7850"),i.e("20278"),i.e("56470")]).then(i.bind(i,22980)),dialogParams:t})}},71876:function(e,t,i){i.d(t,{G:()=>o,N:()=>s});var a=i(59719);const s=(e,t="")=>{const i=document.createElement("a");i.target="_blank",i.href=e,i.download=t,i.style.display="none",document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click")),document.body.removeChild(i)},o=e=>!(e=>!!e.auth.external&&a.G)(e)||!!e.auth.external?.config.downloadFileSupported},59719:function(e,t,i){i.d(t,{G:()=>a});const a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}};
//# sourceMappingURL=54872.d11af6726934ebfb.js.map